<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <style>
        :root {
            /* Burp Suite Dark Theme Palette */
            --bg-main: #2b2b2b;
            --bg-sec: #3c3f41;
            --bg-ter: #323232;
            --bg-input: #2b2b2b;
            --border: #4b4e50;
            --text: #e0e0e0;
            --text-dim: #9e9e9e;
            --accent: #ff6633; /* Burp Orange */
            --accent-r: 255;
            --accent-g: 102;
            --accent-b: 51;
            --hover: #4c5052;
            --row-hover: #35383a;
            --selection: #0d293e; /* Dark Blue selection */
            --btn-reject-bg: #d32f2f;

            /* Syntax Highlight (Dark) */
            --sh-method: #569cd6;
            --sh-path: #ce9178;
            --sh-key: #9cdcfe;
            --sh-val: #d4d4d4;
            --sh-str: #ce9178;
            --sh-num: #b5cea8;
            --sh-keyword: #569cd6;
            --sh-comment: #6a9955;
            --btn-radius: 2px; /* Burp-like square corners */
        }

        .light-theme {
            --bg-main: #ffffff;
            --bg-sec: #f2f2f2;
            --bg-ter: #e6e6e6;
            --bg-input: #ffffff;
            --border: #dddddd;
            --text: #333333;
            --text-dim: #666666;
            --accent: #ff6633; /* Burp Orange */
            --hover: #e0e0e0;
            --row-hover: #f5f5f5;
            --selection: #fff0e6; /* Light Orange selection */
            --btn-reject-bg: #d32f2f;

            /* Syntax Highlight (Light) */
            --sh-method: #0000ff;
            --sh-path: #a31515;
            --sh-key: #0451a5;
            --sh-val: #333333;
            --sh-str: #a31515;
            --sh-num: #098658;
            --sh-keyword: #0000ff;
            --sh-comment: #008000;
        }

        /* Loading Spinner Animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Custom Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-main);
        }

        ::-webkit-scrollbar-thumb {
            background-color: var(--bg-sec);
            border-radius: 5px;
            border: 2px solid var(--bg-main);
        }

        ::-webkit-scrollbar-thumb:hover {
            background-color: var(--accent);
        }

        /* Search Bar */
        #search-bar {
            position: fixed;
            top: 40px;
            right: 20px;
            background: var(--bg-sec);
            border: 1px solid var(--border);
            padding: 5px;
            display: none;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            align-items: center;
            gap: 5px;
            border-radius: 4px;
        }

        #search-input {
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 4px 8px;
            outline: none;
            font-size: 12px;
            width: 200px;
        }

        #search-input:focus {
            border-color: var(--accent);
        }

        .search-btn {
            background: transparent;
            border: none;
            color: var(--text);
            cursor: pointer;
            padding: 2px 6px;
            font-size: 14px;
        }

        .search-btn:hover {
            background: var(--hover);
            border-radius: 4px;;
        }

        .search-highlight {
            background-color: #ffeb3b;
            color: #000;
            border-radius: 4px;;
        }

        .search-highlight.current {
            background-color: #ff9800;
        }

        /* New style for table highlight */
        mark.table-highlight {
            background-color: #ffeb3b; /* Yellow highlight */
            color: #000; /* Black text for readability */
            padding: 0 2px;
            border-radius: 4px;;
        }

        .status-filter-btn {
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: var(--text);
            font-size: 11px;
            padding: 6px 12px;
            cursor: pointer;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.2s ease;
            white-space: nowrap;
        }
        .status-filter-btn:hover {
            background: var(--bg-sec);
            border-color: var(--accent);
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status-filter-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        
        /* 1. Modern Table */
        #history-table {
            border-collapse: separate; 
            border-spacing: 0;
        }

        #history-table th {
            background: var(--bg-sec);
            border-bottom: 2px solid var(--bg-main);
            text-transform: uppercase;
            font-size: 10px;
            letter-spacing: 0.5px;
            color: var(--text-dim);
            padding: 8px 10px;
        }

        #history-table td {
            padding: 6px 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 12px;
        }

        /* Row Hover Effect */
        #history-table tr:hover td {
            background-color: rgba(255, 255, 255, 0.03);
        }

        /* Selected Row */
        tr.selected td {
            background-color: rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.15) !important;
            border-left: 2px solid var(--accent);
        }

        /* Multi-selected Row */
        tr.multi-selected td {
            background-color: rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.25) !important;
            border-left: 3px solid var(--accent);
        }
        tr.multi-selected:hover td {
            background-color: rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.35) !important;
        }

        /* 2. Method Badges */
        .badge-method {
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 10px;
            display: inline-block;
            min-width: 40px;
            text-align: center;
        }

        .badge-get { background: rgba(33, 150, 243, 0.2); color: #64b5f6; }
        .badge-post { background: rgba(76, 175, 80, 0.2); color: #81c784; }
        .badge-delete { background: rgba(244, 67, 54, 0.2); color: #e57373; }
        .badge-put { background: rgba(255, 152, 0, 0.2); color: #ffb74d; }
        .badge-patch { background: rgba(156, 39, 176, 0.2); color: #ba68c8; }
        .badge-head { background: rgba(158, 158, 158, 0.2); color: #e0e0e0; }
        .badge-options { background: rgba(96, 125, 139, 0.2); color: #b0bec5; }

        /* 3. Buttons - Burp-like (square, discretos) */
        button {
            border-radius: var(--btn-radius);
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }

        button:active {
            transform: scale(0.98);
        }

        button[style*="var(--accent)"] {
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        button[style*="var(--accent)"]:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            filter: brightness(1.1);
        }
        
        /* Status filter buttons keep their colors when active */
        .status-filter-btn[data-status-group="2xx"].active {
            background: #4caf50;
            border-color: #4caf50;
            color: white;
        }
        .status-filter-btn[data-status-group="3xx"].active {
            background: #ff9800;
            border-color: #ff9800;
            color: white;
        }
        .status-filter-btn[data-status-group="4xx"].active {
            background: #ff5252;
            border-color: #ff5252;
            color: white;
        }
        .status-filter-btn[data-status-group="5xx"].active {
            background: #d32f2f;
            border-color: #d32f2f;
            color: white;
        }

        /* Inspector Styles */
        .inspector-section {
            margin-bottom: 10px;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--bg-main);
        }
        .inspector-title {
            background: var(--bg-sec);
            padding: 6px 10px;
            margin: 0;
            font-size: 12px;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            font-weight: bold;
        }
        .inspector-content {
            padding: 8px;
            display: block; /* Initially shown */
        }
        .inspector-content.hidden {
            display: none;
        }
        .inspector-content td[contenteditable="true"] {
            background: var(--bg-input);
        }
        .inspector-content td[contenteditable="true"]:focus {
            outline: 1px solid var(--accent);
            background: var(--bg-main);
        }
        .btn-inspector-add { margin-top: 5px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 2px 8px; font-size: 11px; cursor: pointer; }
        .btn-inspector-remove { background: transparent; border: none; color: #ff5252; cursor: pointer; font-size: 14px; padding: 0 4px; }
        .btn-icon-delete:hover {
            color: #ff5252 !important;
            background: rgba(255, 82, 82, 0.1) !important;
            border-radius: 3px;
        }

        /* Split View for Editors */
        .editor-split-view {
            flex-direction: row !important;
            flex: 1;
            min-height: 0;
        }
        .editor-split-view .editor-top-controls {
            display: none !important;
        }
        .editor-split-view > .tab-content {
            display: none !important;
        }
        .editor-split-view > .content-req-split,
        .editor-split-view > .content-res-split {
            display: flex !important;
            flex: 1;
            min-width: 0; /* Allow shrinking */
        }
        .editor-split-view > .content-req-split {
            border-right: 1px solid var(--border);
        }
        
        /* Actions buttons should always be at the top, even in split view */
        .editor-split-view .actions {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            z-index: 10 !important;
            margin: 0 !important;
            margin-top: 0 !important;
            width: 100% !important;
            flex-direction: row !important;
            justify-content: flex-start !important;
            flex-shrink: 0 !important;
        }
        .editor-split-view .actions button {
            flex: 0 1 auto !important;
            min-width: auto !important;
        }
        
        /* Add padding to split view content to account for actions bar */
        .editor-split-view > .content-req-split,
        .editor-split-view > .content-res-split {
            padding-top: 1px !important;
        }

        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            font-family: 'Segoe UI', sans-serif;
            background: var(--bg-main);
            color: var(--text);
            overflow: hidden;
        }

        /* Global Top Bar */
        .global-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--bg-sec);
            border-bottom: 1px solid var(--border);
            height: 30px;
            padding: 0 10px;
            flex-shrink: 0;
        }
        .global-bar-title {
            font-weight: bold;
            color: var(--accent);
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .global-bar-title svg {
            transition: opacity 0.2s ease-in-out, transform 0.5s ease-in-out;
        }
        .global-bar-title:hover svg {
            transform: rotate(360deg);
        }

        /* Pane Header (Request/Response Label) */
        .pane-header {
            padding: 6px 12px;
            background: var(--bg-sec);
            border-bottom: 1px solid var(--border);
            font-weight: 600;
            color: var(--accent);
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .pane-header::before {
            content: '';
            width: 3px;
            height: 12px;
            background: var(--accent);
            border-radius: 4px;;
        }

        /* Topbar Navigation */
        .top-nav {
            display: flex;
            flex-wrap: wrap;
            background: var(--bg-ter);
            border-bottom: 1px solid var(--bg-main);
            height: auto;
            min-height: 28px;
            flex-shrink: 0;
            align-items: flex-end;
            padding-left: 5px;
            /* overflow-x: auto; */
            /* scrollbar-width: thin; */
        }

        .nav-tab {
            background: transparent;
            border: 1px solid transparent;
            border-bottom: none;
            color: var(--text-dim);
            padding: 0 10px;
            cursor: pointer;
            font-size: 11px;
            height: 24px;
            line-height: 24px;
            text-transform: uppercase;
            font-weight: 600;
            border-radius: 3px 3px 0 0;
            margin-right: 2px;
            display: flex;
            align-items: center;
            gap: 6px;
            min-width: 80px;
            flex: 0 0 auto;
        }
        /* Responsividade para telas pequenas */
        @media (max-width: 600px) {
            .top-nav {
                flex-wrap: nowrap;
                overflow-x: auto;
                min-height: 28px;
            }
            .nav-tab {
                min-width: 90px;
                font-size: 10px;
                padding: 0 6px;
            }
        }

        .nav-tab:hover {
            color: var(--text);
        }

        .nav-tab.active {
            background: var(--bg-main);
            color: var(--text);
            border-top: 2px solid var(--accent);
            border-left: 1px solid var(--border);
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--bg-main); /* Connect to content */
            margin-bottom: -1px; /* Overlap border */
            z-index: 1;
        }

        .nav-tab svg, .tab svg {
            width: 13px;
            height: 13px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
            opacity: 0.7;
        }
        .nav-tab.active svg, .tab.active svg {
            opacity: 1;
            stroke: var(--accent);
        }

        /* View Containers */
        .view-container {
            display: none;
            flex: 1;
            overflow: hidden;
            width: 100%;
        }

        .view-container.active {
            display: flex;
        }

        /* Layout original lado a lado */
        .view-placeholder {
            padding: 20px;
            color: var(--text-dim);
            font-style: italic;
        }

        .filter-box {
            padding: 10px;
            border-bottom: 1px solid var(--border);
        }

        #filter-input, #issues-filter-input, #ws-filter-input, #event-log-filter {
            width: 100%;
            box-sizing: border-box;
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 6px 12px;
            outline: none;
            border-radius: 4px;
            transition: all 0.2s ease-in-out;
        }

        #filter-input:focus, #issues-filter-input:focus, #ws-filter-input:focus, #event-log-filter:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(var(--accent-r, 255), var(--accent-g, 102), var(--accent-b, 51), 0.2);
        }

        /* History Table Styles */
        .history-table-wrapper {
            flex: 1;
            /* Permite rolagem vertical e horizontal quando necessÃ¡rio */
            overflow-x: auto;
            overflow-y: auto;
            background: var(--bg-main);
            border-bottom: 1px solid var(--border);
            border-radius: 4px;
        }

        #history-details-container {
            display: none;
            flex-direction: column;
            height: 300px;
            border-top: 1px solid var(--border);
            position: relative;
            background: var(--bg-main);
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #history-splitter {
            background: var(--border);
            opacity: 0.4;
            transition: all 0.3s ease;
        }
        #history-splitter:hover {
            background: var(--accent);
            opacity: 1;
            box-shadow: 0 0 8px var(--accent);
        }

        #issue-splitter {
            background: var(--border);
            opacity: 0.4;
            transition: all 0.3s ease;
        }
        #issue-splitter:hover {
            background: var(--accent);
            opacity: 1;
            box-shadow: 0 0 8px var(--accent);
        }

        #intruder-splitter {
            background: var(--border);
            opacity: 0.4;
            transition: all 0.3s ease;
        }
        #intruder-splitter:hover {
            background: var(--accent);
            opacity: 1;
            box-shadow: 0 0 8px var(--accent);
        }

        /* Comparer Splitters */
        #comparer-vertical-splitter {
            background: var(--border);
            opacity: 0.4;
            transition: all 0.3s ease;
        }
        #comparer-vertical-splitter:hover {
            background: var(--accent);
            opacity: 1;
            box-shadow: 0 0 8px var(--accent);
        }

        #comparer-horizontal-splitter {
            background: var(--border);
            opacity: 0.4;
            transition: all 0.3s ease;
        }
        #comparer-horizontal-splitter:hover {
            background: var(--accent);
            opacity: 1;
            box-shadow: 0 0 8px var(--accent);
        }

        /* Flow - Burp Suite Pro style */
        #view-flow .flow-method-btn { border-radius: 4px;; padding: 4px 8px; font-size: 11px; box-shadow: none; }
        #view-flow .flow-method-btn:hover { transform: none; box-shadow: none; border: 1px solid var(--border); }
        #view-flow #flow-zoom-controls,
        #view-flow #flow-legend,
        #view-flow #flow-minimap,
        #view-flow #flow-node-details,
        #view-flow #flow-stats { border-radius: 4px;; box-shadow: none; border: 1px solid var(--border); }
        #view-flow #flow-zoom-controls button { border-radius: 4px;; }
        #view-flow #flow-zoom-controls button:hover { transform: none; background: var(--accent) !important; color: white !important; border-color: var(--accent) !important; }
        #flow-node-details #btn-close-flow-details:hover { background: var(--bg-input) !important; color: var(--accent) !important; }
        #flow-minimap #btn-toggle-minimap:hover { background: var(--bg-input) !important; color: var(--accent) !important; }

        #history-details {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-sizing: border-box;
            background: var(--bg-main);
        }

        /* Empty State Improvements */
        #history-details .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 40px 20px;
            text-align: center;
            color: var(--text-dim);
            animation: fadeIn 0.4s ease-out;
        }

        #history-details .empty-state::before {
            content: "ðŸ“‹";
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        #history-details .empty-state p {
            font-size: 14px;
            margin: 0;
            color: var(--text-dim);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            table-layout: fixed;
        }

        th,
        td {
            padding: 4px 8px;
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: left;
            color: var(--text);
        }

        th {
            background: var(--bg-ter);
            position: sticky;
            top: 0;
            font-weight: 600;
            z-index: 1;
            /* MantÃ©m sticky */
            user-select: none;
            /* Evita seleÃ§Ã£o de texto ao arrastar */
            cursor: pointer;
            /* Indica que Ã© clicÃ¡vel para ordenar */
        }

        /* Column Drag & Drop Styles */
        th[draggable="true"] {
            cursor: move;
        }
        th.dragging {
            opacity: 0.4;
            background: var(--accent);
        }
        th.drag-over {
            border-right: 2px solid var(--accent);
        }

        /* Resizer Handle */
        .resizer {
            position: absolute;
            right: 0;
            top: 0;
            width: 5px;
            height: 100%;
            cursor: col-resize;
            user-select: none;
            touch-action: none;
            z-index: 10;
            /* Garante que o resizer fique acima do conteÃºdo do th */
        }

        .resizer:hover,
        .resizing {
            background: var(--accent);
            /* Highlight ao passar o mouse */
        }

        /* Row Highlights */
        @keyframes pulse-red { 50% { box-shadow: inset 3px 0 0 #ff5252, 0 0 10px rgba(255, 82, 82, 0.4); background: linear-gradient(90deg, rgba(255, 82, 82, 0.35) 0%, transparent 90%); } }
        @keyframes pulse-green { 50% { box-shadow: inset 3px 0 0 #4caf50, 0 0 10px rgba(76, 175, 80, 0.4); background: linear-gradient(90deg, rgba(76, 175, 80, 0.35) 0%, transparent 90%); } }
        @keyframes pulse-blue { 50% { box-shadow: inset 3px 0 0 #2196f3, 0 0 10px rgba(33, 150, 243, 0.4); background: linear-gradient(90deg, rgba(33, 150, 243, 0.35) 0%, transparent 90%); } }
        @keyframes pulse-yellow { 50% { box-shadow: inset 3px 0 0 #ffeb3b, 0 0 10px rgba(255, 235, 59, 0.4); background: linear-gradient(90deg, rgba(255, 235, 59, 0.35) 0%, transparent 90%); } }
        @keyframes pulse-purple { 50% { box-shadow: inset 3px 0 0 #9c27b0, 0 0 10px rgba(156, 39, 176, 0.4); background: linear-gradient(90deg, rgba(156, 39, 176, 0.35) 0%, transparent 90%); } }
        @keyframes pulse-orange { 50% { box-shadow: inset 3px 0 0 #ff9800, 0 0 10px rgba(255, 152, 0, 0.4); background: linear-gradient(90deg, rgba(255, 152, 0, 0.35) 0%, transparent 90%); } }

        tr.req-row.highlight-red {
            background: linear-gradient(90deg, rgba(255, 82, 82, 0.25) 0%, transparent 90%);
            box-shadow: inset 3px 0 0 #ff5252;
            animation: pulse-red 2s infinite ease-in-out;
        }
        tr.req-row.highlight-red td { text-shadow: 0 0 8px rgba(255, 82, 82, 0.5); }

        tr.req-row.highlight-green {
            background: linear-gradient(90deg, rgba(76, 175, 80, 0.25) 0%, transparent 90%);
            box-shadow: inset 3px 0 0 #4caf50;
            animation: pulse-green 2s infinite ease-in-out;
        }
        tr.req-row.highlight-green td { text-shadow: 0 0 8px rgba(76, 175, 80, 0.5); }

        tr.req-row.highlight-blue {
            background: linear-gradient(90deg, rgba(33, 150, 243, 0.25) 0%, transparent 90%);
            box-shadow: inset 3px 0 0 #2196f3;
            animation: pulse-blue 2s infinite ease-in-out;
        }
        tr.req-row.highlight-blue td { text-shadow: 0 0 8px rgba(33, 150, 243, 0.5); }

        tr.req-row.highlight-yellow {
            background: linear-gradient(90deg, rgba(255, 235, 59, 0.25) 0%, transparent 90%);
            box-shadow: inset 3px 0 0 #ffeb3b;
            animation: pulse-yellow 2s infinite ease-in-out;
        }
        tr.req-row.highlight-yellow td { text-shadow: 0 0 8px rgba(255, 235, 59, 0.5); }

        tr.req-row.highlight-purple {
            background: linear-gradient(90deg, rgba(156, 39, 176, 0.25) 0%, transparent 90%);
            box-shadow: inset 3px 0 0 #9c27b0;
            animation: pulse-purple 2s infinite ease-in-out;
        }
        tr.req-row.highlight-purple td { text-shadow: 0 0 8px rgba(156, 39, 176, 0.5); }

        tr.req-row.highlight-orange {
            background: linear-gradient(90deg, rgba(255, 152, 0, 0.25) 0%, transparent 90%);
            box-shadow: inset 3px 0 0 #ff9800;
            animation: pulse-orange 2s infinite ease-in-out;
        }
        tr.req-row.highlight-orange td { text-shadow: 0 0 8px rgba(255, 152, 0, 0.5); }

        tr.req-row:hover {
            background: var(--row-hover);
            cursor: pointer;
        }

        tr.req-row.active {
            background: var(--selection);
            /* Cor de seleÃ§Ã£o estilo Burp */
            color: var(--text);
            border-left: none;
        }

        /* Sort Indicators */
        .sort-asc::after {
            content: ' â–²';
            font-size: 9px;
            margin-left: 4px;
        }

        .sort-desc::after {
            content: ' â–¼';
            font-size: 9px;
            margin-left: 4px;
        }

        .req-method {
            font-weight: bold;
            color: #569cd6;
            margin-right: 5px;
        }

        .req-host {
            color: #ccc;
            display: block;
            margin-bottom: 2px;
            font-weight: 600;
        }

        .req-path {
            color: #9cdcfe;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: block;
            opacity: 0.8;
        }

        .editor-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            box-sizing: border-box;
            position: relative;
            background: var(--bg-main);
            animation: fadeIn 0.3s ease-out;
        }

        /* Editor Top Controls - Better Visual Hierarchy */
        .editor-top-controls {
            background: var(--bg-sec);
            border-bottom: 2px solid var(--border);
            padding: 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Tab Improvements */
        .editor-top-controls .tab {
            transition: all 0.2s ease;
            position: relative;
        }

        .editor-top-controls .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent);
            animation: slideIn 0.2s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: scaleX(0);
            }
            to {
                transform: scaleX(1);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        .editor-top-controls .tab:hover:not(.active) {
            background: var(--bg-ter);
        }

        .header-info {
            margin-bottom: 10px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
        }

        .url-display {
            word-break: break-all;
            font-size: 13px;
            color: #ce9178;
            font-family: 'Consolas', monospace;
            margin-bottom: 5px;
            display: block;
        }

        label {
            font-size: 11px;
            text-transform: uppercase;
            color: var(--text-dim);
            margin-bottom: 5px;
            display: block;
            font-weight: bold;
        }

        /* Editor Wrapper for Line Numbers */
        .editor-wrapper {
            display: flex;
            flex: 1;
            position: relative;
            border: 1px solid var(--border);
            border-bottom: none;
            background: var(--bg-main);
            overflow: hidden; /* Changed from auto to hidden to prevent double scrollbar */
            margin-bottom: 0;
            min-height: 0;
            border-radius: 4px 4px 0 0;
            transition: border-color 0.2s ease;
        }

        .editor-wrapper:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 1px rgba(var(--accent-r), var(--accent-g), var(--accent-b), 0.2);
        }

        .line-numbers {
            background: var(--bg-sec);
            color: var(--text-dim);
            text-align: right;
            padding: 10px 5px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.5;
            border-right: 1px solid var(--border);
            overflow: visible;
            user-select: none;
            white-space: pre;
            /* min-width: 50px; */
            transition: background-color 0.2s ease;
        }

        textarea {
            flex: 1;
            background: var(--bg-main);
            border: 1px solid var(--border);
            color: var(--text);
            font-family: 'Consolas', monospace;
            padding: 10px;
            resize: none;
            outline: none;
            font-size: 13px;
            margin-bottom: 10px;
            white-space: pre-wrap;
            word-break: break-all;
            overflow-y: auto;
            overflow-x: hidden;
            min-height: 0;
            border-radius: 4px;
        }

        textarea:focus {
            border-color: var(--accent);
        }

        /* Editor com Syntax Highlighting */
        .editor-raw {
            flex: 1;
            background: var(--bg-main);
            border: none;
            color: var(--text);
            font-family: 'Consolas', monospace;
            padding: 10px;
            overflow: auto;
            outline: none;
            font-size: 13px;
            margin-bottom: 0;
            white-space: pre-wrap;
            word-break: break-all;
            line-height: 1.5;
            min-height: 0;
            scrollbar-width: thin;
            scrollbar-color: var(--border) transparent;
        }

        .editor-raw::-webkit-scrollbar {
            width: 8px;
        }

        .editor-raw::-webkit-scrollbar-track {
            background: transparent;
        }

        .editor-raw::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        .editor-raw::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        /* CSP-compliant hover and focus effects */
        .csp-hover-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .csp-focus-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(var(--accent-rgb), 0.1);
        }

        .csp-focus-input:not(:focus) {
            border-color: var(--border);
            box-shadow: none;
        }

        .csp-hover-label:hover {
            background: var(--bg-ter);
        }

        .csp-hover-transparent:hover {
            background: var(--hover);
        }

        /* Highlight for decoded Base64 text */
        .decoded-base64-highlight {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            color: #10b981;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
            border: 1px solid rgba(16, 185, 129, 0.3);
            box-shadow: 0 1px 3px rgba(16, 185, 129, 0.2);
            position: relative;
            display: inline-block;
        }

        .decoded-base64-highlight::before {
            content: 'ðŸ”“';
            margin-right: 4px;
            font-size: 0.9em;
            opacity: 0.7;
        }

        /* Highlight for decoded URL text */
        .decoded-url-highlight {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(139, 92, 246, 0.2) 100%);
            color: #3b82f6;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
            border: 1px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 1px 3px rgba(59, 130, 246, 0.2);
            position: relative;
            display: inline-block;
        }

        .decoded-url-highlight::before {
            content: 'ðŸ”—';
            margin-right: 4px;
            font-size: 0.9em;
            opacity: 0.7;
        }

        /* Highlight for encoded URL text */
        .encoded-url-highlight {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            color: #8b5cf6;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
            border: 1px solid rgba(139, 92, 246, 0.3);
            box-shadow: 0 1px 3px rgba(139, 92, 246, 0.2);
            position: relative;
            display: inline-block;
        }

        .encoded-url-highlight::before {
            content: 'ðŸ”’';
            margin-right: 4px;
            font-size: 0.9em;
            opacity: 0.7;
        }

        .editor-raw:focus {
            border-color: var(--accent);
        }

        /* Cores da Sintaxe */
        .h-method {
            color: var(--sh-method);
            font-weight: bold;
        }

        /* Azul */
        .h-path {
            color: var(--sh-path);
        }

        /* Laranja */
        .h-key {
            color: var(--sh-key);
            font-weight: bold;
        }

        /* Azul Claro */
        .h-val {
            color: var(--sh-val);
        }

        /* Branco */
        .j-key {
            color: var(--sh-key);
        }

        .j-str {
            color: var(--sh-str);
        }

        .j-num {
            color: var(--sh-num);
        }

        /* Verde Claro */
        .j-bool {
            color: var(--sh-keyword);
        }

        .j-null {
            color: var(--sh-keyword);
        }

        /* Cookie Highlighting */
        .cookie-key {
            color: var(--sh-key); /* Light Blue */
        }
        .cookie-val {
            color: var(--sh-str); /* Orange/Brown */
        }
        .cookie-sep {
            color: var(--text-dim); /* Dim Gray */
        }

        /* Cookie Highlighting */
        .cookie-key {
            color: var(--sh-key); /* Light Blue */
        }
        .cookie-val {
            color: var(--sh-str); /* Orange/Brown */
        }
        .cookie-sep {
            color: var(--text-dim); /* Dim Gray */
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: auto;
            flex-shrink: 0;
            padding: 10px;
            background: var(--bg-sec);
            border-top: 1px solid var(--border);
            animation: slideUp 0.2s ease-out;
        }

        .actions button {
            flex: 1;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .actions button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .actions button:active {
            transform: translateY(0);
        }
        
        /* When in split view, actions should be at top */
        .editor-container {
            position: relative;
        }

        button {
            padding: 10px;
            border: none;
            border-radius: var(--btn-radius);
            cursor: pointer;
            font-weight: 600;
            color: white;
            transition: opacity 0.2s;
            text-transform: uppercase;
            font-size: 12px;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #444 !important;
        }

        /* Editor Footer Buttons */
        button[id^="btn-footer-search-"]:hover {
            color: var(--accent) !important;
        }

        .btn-approve {
            background: #388e3c;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(46, 125, 50, 0.3);
        }

        .btn-approve:hover {
            background: #2e7d32;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.4);
        }
        .btn-approve:active {
            transform: translateY(0);
        }

        .btn-reject {
            background: var(--btn-reject-bg);
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(211, 47, 47, 0.3);
        }

        .btn-reject:hover {
            background: #b71c1c;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(211, 47, 47, 0.4);
        }
        .btn-reject:active {
            transform: translateY(0);
        }
        
        /* Intercept Status Badge */
        #intercept-status.active {
            background: rgba(46, 125, 50, 0.15);
            color: #4caf50;
            border: 1px solid rgba(46, 125, 50, 0.3);
        }
        #intercept-status.paused {
            background: rgba(255, 152, 0, 0.15);
            color: #ff9800;
            border: 1px solid rgba(255, 152, 0, 0.3);
        }
        
        /* Empty State for Intercept */
        #intercept-main .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            color: var(--text-dim);
        }
        #intercept-main .empty-state p {
            font-size: 15px;
            margin: 0;
            opacity: 0.7;
        }
        #intercept-main .empty-state::before {
            content: 'â¸ï¸';
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .btn-replay {
            background: var(--accent);
        }

        .btn-replay:hover {
            background: #005a9e;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            background: var(--bg-ter);
            margin-bottom: 10px;
            padding-top: 2px;
            padding-left: 5px;
            gap: 2px;
        }

        .tab {
            padding: 4px 12px;
            cursor: pointer;
            font-size: 11px;
            color: var(--text-dim);
            border: 1px solid transparent;
            border-bottom: none;
            border-radius: 3px 3px 0 0;
            background: transparent;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tab:hover {
            color: var(--text);
        }

        .tab.active {
            color: var(--text);
            background: var(--bg-main);
            border-top: 2px solid var(--accent);
            border-left: 1px solid var(--border);
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--bg-main);
            margin-bottom: -1px;
            font-weight: 600;
        }

        .tab-content {
            display: none !important;
            flex: 1;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }

        .tab-content.active {
            display: flex !important;
            animation: fadeIn 0.2s ease-out;
        }

        /* Inner Tabs (Raw/Pretty/etc) specific overrides */
        .tabs.inner-tabs {
            background: var(--bg-sec);
            margin-bottom: 0;
            border-bottom: 1px solid var(--border);
        }

        .tabs.inner-tabs .inner-tab {
            transition: all 0.2s ease;
            position: relative;
        }

        .tabs.inner-tabs .inner-tab.active {
            color: var(--accent);
            font-weight: 600;
        }

        .tabs.inner-tabs .inner-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent);
            animation: slideIn 0.2s ease-out;
        }

        .tabs.inner-tabs .inner-tab:hover:not(.active) {
            background: var(--bg-ter);
            color: var(--text);
        }

        .empty-state {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--text-dim);
            text-align: center;
        }

        /* Repeater Tabs */
        .rep-tab {
            padding: 0 8px;
            height: 100%;
            width: 75px;
            display: flex;
            align-items: center;
            cursor: pointer;
            border: 1px solid transparent;
            border-bottom: none;
            font-size: 11px;
            color: var(--text-dim);
            background: transparent;
            white-space: nowrap;
            border-radius: 3px 3px 0 0;
            margin-right: 1px;
        }

        .rep-tab:hover {
            color: var(--text);
        }

        .rep-tab.active {
            background: var(--bg-main);
            color: var(--text);
            border-top: 2px solid var(--accent);
            border-left: 1px solid var(--border);
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--bg-main);
            margin-bottom: -1px;
        }

        .rep-tab-dup {
            margin-left: 4px;
            font-size: 12px;
            line-height: 1;
            color: var(--text-dim);
        }

        .rep-tab-dup:hover {
            color: var(--accent);
        }

        .rep-tab-close {
            margin-left: 4px;
            font-size: 14px;
            line-height: 1;
            color: var(--text-dim);
        }

        .rep-tab-close:hover {
            color: #ff5555;
        }

        /* Diff View */
        /* Comparer Styles */
        #comparer-left::-webkit-scrollbar,
        #comparer-right::-webkit-scrollbar {
            width: 8px;
        }

        #comparer-left::-webkit-scrollbar-track,
        #comparer-right::-webkit-scrollbar-track {
            background: transparent;
        }

        #comparer-left::-webkit-scrollbar-thumb,
        #comparer-right::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        #comparer-left::-webkit-scrollbar-thumb:hover,
        #comparer-right::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        .comparer-action-btn:hover {
            background: var(--bg-ter) !important;
            color: var(--accent) !important;
        }

        #btn-swap-comparer:hover {
            background: var(--accent) !important;
            color: white !important;
            border-color: var(--accent) !important;
            transform: translate(-50%, -50%) rotate(180deg);
        }

        #btn-toggle-sync-scroll.active {
            background: var(--accent) !important;
            color: white !important;
            border-color: var(--accent) !important;
        }

        /* Comparer - Burp Suite Pro style */
        #view-comparer > div:first-of-type { padding: 8px 12px; border-bottom: 1px solid var(--border); background: var(--bg-ter); }
        #view-comparer #comparer-stats { border-radius: 4px;; padding: 6px 10px; font-size: 11px; }
        #view-comparer #comparer-left-pane > div:first-child,
        #view-comparer #comparer-right-pane > div:first-child { padding: 6px 10px; background: var(--bg-ter); border-bottom: 1px solid var(--border); }
        #view-comparer #comparer-left-stats,
        #view-comparer #comparer-right-stats { border-radius: 4px;; padding: 2px 6px; font-size: 11px; }
        #view-comparer #comparer-results-container > div:first-child { padding: 6px 10px; border-top: 1px solid var(--border); background: var(--bg-ter); }
        #view-comparer #comparer-result { padding: 10px 12px; font-size: 12px; }
        #view-comparer .comparer-action-btn { border-radius: 4px;; padding: 4px 8px; font-size: 11px; }

        /* Diff Styles - Improved */
        .diff-add {
            background-color: rgba(76, 175, 80, 0.15);
            color: #81c784;
            display: block;
            width: 100%;
            white-space: pre-wrap;
            padding: 2px 8px;
            margin: 1px 0;
            border-left: 3px solid #4caf50;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.6;
        }

        .diff-del {
            background-color: rgba(244, 67, 54, 0.15);
            color: #e57373;
            display: block;
            width: 100%;
            white-space: pre-wrap;
            padding: 2px 8px;
            margin: 1px 0;
            border-left: 3px solid #f44336;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.6;
        }

        .diff-same {
            color: var(--text-dim);
            display: block;
            width: 100%;
            white-space: pre-wrap;
            padding: 2px 8px;
            margin: 1px 0;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.6;
            opacity: 0.7;
        }

        .hex-view {
            width: 100%;
            height: 100%;
            background: var(--bg-main);
            color: var(--text);
            font-family: Consolas, monospace;
            font-size: 12px;
            white-space: pre;
            overflow: auto;
            padding: 10px;
            box-sizing: border-box;
        }

        /* Tree View (Sitemap) */
        .tree-view {
            font-family: 'Segoe UI', sans-serif;
            font-size: 12px;
            user-select: none;
        }

        .tree-node {
            margin-left: 14px;
        }

        .tree-content {
            display: flex;
            align-items: center;
            padding: 2px 4px;
            cursor: pointer;
            border-radius: 4px;;
        }

        .tree-content:hover {
            background: var(--hover);
        }

        .tree-toggler {
            width: 14px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: var(--text-dim);
            margin-right: 2px;
            transition: transform 0.15s ease-out;
        }

        .tree-toggler.expanded {
            transform: rotate(90deg);
        }

        .tree-icon {
            margin-right: 5px;
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            color: var(--text-dim);
        }

        /* Sitemap Status Colors */
        .tree-icon.status-2xx { color: #4caf50 !important; } /* Green */
        .tree-icon.status-3xx { color: #ff9800 !important; } /* Orange */
        .tree-icon.status-4xx { color: #ff5252 !important; } /* Red */
        .tree-icon.status-5xx { color: #d32f2f !important; } /* Dark Red */

        .tree-label {
            color: var(--text);
        }
        .tree-children {
            display: none;
            border-left: 1px solid var(--border);
            margin-left: 7px;
        }
        .tree-children.expanded {
            display: block;
        }

        .tree-methods {
            margin-right: 5px;
            font-size: 10px;
            color: var(--text-dim);
        }

        .tree-method-tag {
            padding: 1px 3px;
            border-radius: 4px;;
            margin-right: 2px;
            background: var(--bg-input);
            border: 1px solid var(--border);
        }

        /* Issues Severity */
        .sev-high { 
            color: #ff5252; 
            font-weight: bold; 
        }
        .sev-medium { 
            color: #ff9800; 
            font-weight: bold; 
        }
        .sev-low { 
            color: #ffeb3b; 
            font-weight: bold; 
        }
        .sev-info { 
            color: #2196f3; 
            font-weight: bold; 
        }
        
        /* Severity Badges */
        .severity-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-align: center;
            min-width: 60px;
        }
        .severity-badge.high {
            background: rgba(255, 82, 82, 0.15);
            color: #ff5252;
            border: 1px solid rgba(255, 82, 82, 0.3);
        }
        .severity-badge.medium {
            background: rgba(255, 152, 0, 0.15);
            color: #ff9800;
            border: 1px solid rgba(255, 152, 0, 0.3);
        }
        .severity-badge.low {
            background: rgba(255, 235, 59, 0.15);
            color: #ffc107;
            border: 1px solid rgba(255, 235, 59, 0.3);
        }
        .severity-badge.info {
            background: rgba(33, 150, 243, 0.15);
            color: #2196f3;
            border: 1px solid rgba(33, 150, 243, 0.3);
        }
        .severity-badge.critical {
            background: rgba(211, 47, 47, 0.2);
            color: #d32f2f;
            border: 1px solid rgba(211, 47, 47, 0.4);
            font-weight: 700;
        }
        
        /* Scope and Blacklist Items */
        .scope-item, .blacklist-item {
            padding: 10px 12px;
            margin-bottom: 6px;
            background: var(--bg-main);
            border: 1px solid var(--border);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.2s ease;
        }
        .scope-item:hover, .blacklist-item:hover {
            background: var(--bg-sec);
            border-color: var(--accent);
            transform: translateX(2px);
        }
        
        /* Target - Burp Suite Pro style */
        #view-target > .tabs { border-bottom: 1px solid var(--border); background: var(--bg-ter); padding: 0 8px; }
        #view-target > .tabs .tab { padding: 6px 12px; font-size: 12px; border-radius: 0; }
        #view-target > .tabs .tab.active { border-bottom: 2px solid var(--accent); }
        #view-target #content-target-sitemap { padding: 12px; }
        #view-target #content-target-scope { padding: 12px; }
        #view-target #content-target-scope h3 { font-size: 12px; font-weight: 600; margin-bottom: 12px; padding-bottom: 6px; border-bottom: 1px solid var(--border); }
        #view-target #content-target-scope input[type="text"] { border-radius: 4px;; padding: 6px 10px; font-size: 12px; }
        #view-target #content-target-scope #scope-list,
        #view-target #content-target-scope #blacklist-list { border-radius: 4px;; padding: 10px; box-shadow: none; }
        #view-target #content-target-scope #btn-add-scope,
        #view-target #content-target-scope #btn-add-blacklist { border-radius: 4px;; padding: 6px 14px; height: auto; font-size: 12px; box-shadow: none; }
        #view-target #content-target-issues .filter-box { padding: 8px 10px; }
        #view-target #content-target-issues #issues-filter-input { border-radius: 4px;; padding: 6px 10px; font-size: 12px; }
        #view-target #content-target-issues #btn-generate-report-ai { border-radius: 4px;; padding: 6px 12px; font-size: 12px; box-shadow: none; }
        #view-target #content-target-issues .history-table-wrapper { border: 1px solid var(--border); border-radius: 4px;; }
        #view-target #content-target-issues #issue-details { border-radius: 0 0 2px 2px; font-size: 12px; }
        #view-target .scope-item,
        #view-target .blacklist-item { border-radius: 4px;; padding: 8px 10px; box-shadow: none; transition: background 0.15s, border-color 0.15s; }
        #view-target .scope-item:hover,
        #view-target .blacklist-item:hover { transform: none; border-color: var(--accent); }

        /* Target Tab Improvements */
        #content-target-scope, #content-target-issues {
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Proxy - Burp Suite Pro style */
        #view-proxy > .tabs { border-bottom: 1px solid var(--border); background: var(--bg-ter); padding: 0 8px; }
        #view-proxy > .tabs .tab { padding: 6px 12px; font-size: 12px; border-radius: 0; }
        #view-proxy > .tabs .tab.active { border-bottom: 2px solid var(--accent); }
        #view-proxy .filter-box input,
        #view-proxy .filter-box select,
        #view-proxy .filter-box button { border-radius: 4px;; font-size: 12px; padding: 6px 10px; box-shadow: none; }
        #view-proxy .history-table-wrapper { border: 1px solid var(--border); border-radius: 4px;; }
        #view-proxy .status-filter-btn { border-radius: 4px;; padding: 4px 10px; font-size: 11px; }
        #view-proxy #history-request-count,
        #view-proxy #intercept-status,
        #view-proxy #ws-intercept-status,
        #view-proxy #ws-message-count { border-radius: 4px;; }

        /* Repeater - Burp Suite Pro style */
        #view-repeater #repeater-tabs-bar { background: var(--bg-ter); border-bottom: 1px solid var(--border); height: 26px; padding: 0 6px; }
        #view-repeater #repeater-tabs-bar button { padding: 0 8px; font-size: 12px; }
        #view-repeater .editor-top-controls .tabs .tab,
        #view-repeater .inner-tabs .inner-tab { padding: 6px 10px; font-size: 12px; border-radius: 0; }
        #view-repeater .editor-top-controls .tabs .tab.active,
        #view-repeater .inner-tabs .inner-tab.active { border-bottom: 2px solid var(--accent); }
        #view-repeater #repeater-url,
        #view-repeater #rep-back, #view-repeater #rep-fwd,
        #view-repeater #repeater-send, #view-repeater #repeater-send-intruder { border-radius: 4px;; font-size: 12px; padding: 6px 10px; box-shadow: none; }
        #view-repeater #editor-footer-req-repeater,
        #view-repeater #editor-search-bar-res-repeater,
        #view-repeater #editor-footer-res-repeater { border-radius: 0 0 2px 2px; }
        #view-repeater #editor-search-input-req-repeater,
        #view-repeater #editor-search-input-res-repeater { border-radius: 4px;; padding: 4px 8px; }
        #view-repeater .editor-wrapper { border-radius: 4px;; }
        #view-repeater .pane-header { font-size: 12px; padding: 6px 10px; }

        /* Decoder - Burp Suite Pro style */
        #view-decoder > .tabs { border-bottom: 1px solid var(--border); background: var(--bg-ter); padding: 0 8px; }
        #view-decoder > .tabs .tab { padding: 6px 12px; font-size: 12px; border-radius: 0; }
        #view-decoder > .tabs .tab.active { border-bottom: 2px solid var(--accent); }
        #view-decoder .tab-content input,
        #view-decoder .tab-content select,
        #view-decoder .tab-content textarea,
        #view-decoder .tab-content button { border-radius: 4px;; font-size: 12px; box-shadow: none; }
        #view-decoder .jwt-attack-btn { border-radius: 4px;; padding: 10px 12px; font-size: 11px; }

        /* Search - Burp Suite Pro style */
        #view-search .history-table-wrapper { border-radius: 4px;; box-shadow: none; }
        #view-search #global-search-input,
        #view-search #global-search-controls button,
        #view-search #global-search-results-count { border-radius: 4px;; font-size: 12px; padding: 6px 10px; box-shadow: none; }
        #view-search label[for="global-search-regex"],
        #view-search label[for="global-search-case"] { border-radius: 4px;; padding: 4px 8px; font-size: 11px; }
        #view-search #global-search-results-table thead th { padding: 6px 10px; font-size: 11px; border-bottom: 1px solid var(--border); }

        /* Settings - Burp Suite Pro style */
        #view-settings h3 { font-size: 13px; font-weight: 600; padding-bottom: 8px; margin-top: 16px; margin-bottom: 0; }
        #view-settings h3:first-child { margin-top: 0; }
        #view-settings input:not([type="color"]):not([type="checkbox"]),
        #view-settings select,
        #view-settings button { border-radius: 4px;; font-size: 12px; box-shadow: none; }
        #view-settings input[type="color"] { border-radius: 4px;; }
        #view-settings label { font-size: 12px; }

        /* AI Analysis Content */
        .ai-analysis-content {
            font-family: 'Segoe UI', sans-serif;
            font-size: 13px;
            line-height: 1.6;
        }
        .ai-analysis-content h3 {
            color: var(--accent);
            border-bottom: 1px solid var(--border);
            padding-bottom: 5px;
            margin-top: 15px;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        .ai-analysis-content h4 {
            color: var(--sh-key);
            margin-top: 12px;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        .tab-ai {
            color: var(--accent);
            font-weight: bold;
        }
        .ai-analysis-content h5 {
            color: var(--text-dim);
            margin-top: 10px;
            margin-bottom: 5px;
            font-size: 1em;
            text-transform: uppercase;
        }
        .ai-analysis-content p { margin: 0 0 10px 0; }
        .ai-analysis-content ul, .ai-analysis-content ol { padding-left: 25px; margin: 0 0 10px 0; }
        .ai-analysis-content li { margin-bottom: 5px; }
        .ai-analysis-content hr { border: none; border-top: 1px solid var(--border); margin: 20px 0; }
        .ai-analysis-content pre {
            background: var(--bg-sec);
            border: 1px solid var(--border);
            padding: 10px;
            border-radius: 4px;
            white-space: pre-wrap;
            word-break: break-all;
            margin-bottom: 10px;
            font-size: 12px;
        }
        .ai-analysis-content code { font-family: 'Consolas', monospace; color: var(--sh-str); }
        .ai-analysis-content .ai-inline-code { background: var(--bg-input); padding: 2px 5px; border-radius: 3px; font-size: 12px; }

        /* Dashboard Styles */
        .dash-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        .dash-card {
            background: var(--bg-sec);
            border: 1px solid var(--border);
            padding: 20px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        .dash-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--accent);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        .dash-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
            border-color: var(--accent);
        }
        .dash-card:hover::before {
            transform: scaleX(1);
        }
        .dash-card.card-high::before { background: #ff5252; }
        .dash-card.card-med::before { background: #ff9800; }
        .dash-card.card-low::before { background: #ffeb3b; }
        .dash-card.card-info::before { background: #2196f3; }
        
        .dash-card-icon {
            font-size: 32px;
            margin-bottom: 10px;
            opacity: 0.8;
            transition: transform 0.3s ease;
        }
        .dash-card:hover .dash-card-icon {
            transform: scale(1.1);
        }
        
        .dash-card h4 { 
            margin: 0 0 8px 0; 
            color: var(--text-dim); 
            font-size: 11px; 
            text-transform: uppercase; 
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        .dash-card-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--text);
            transition: transform 0.3s ease;
            display: flex;
            align-items: baseline;
            gap: 4px;
        }
        .dash-card:hover .dash-card-value {
            transform: scale(1.05);
        }
        .dash-card.card-high .dash-card-value { color: #ff5252; }
        .dash-card.card-med .dash-card-value { color: #ff9800; }
        .dash-card.card-low .dash-card-value { color: #ffeb3b; }
        .dash-card.card-info .dash-card-value { color: #2196f3; }
        
        .dash-card-trend {
            font-size: 11px;
            color: var(--text-dim);
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .dash-card-trend.up { color: #4caf50; }
        .dash-card-trend.down { color: #ff5252; }
        
        /* Animated number counter */
        @keyframes numberPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .dash-card-value.updating {
            animation: numberPulse 0.3s ease;
        }
        
        /* Quick Actions Buttons */
        #btn-dash-clear, #btn-dash-save {
            transition: all 0.2s ease;
        }
        #btn-dash-clear:hover {
            background: var(--bg-sec) !important;
            border-color: var(--accent) !important;
        }
        #btn-dash-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15) !important;
        }

        .log-table-wrapper {
            flex: 1;
            overflow: auto;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-main);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        #event-log-table th {
            position: relative;
            cursor: pointer;
            user-select: none;
        }

        /* Dashboard - Burp Suite Pro style */
        #view-dashboard { padding: 12px; }
        #view-dashboard h3 { font-size: 12px; font-weight: 600; margin: 0 0 8px 0; padding-bottom: 6px; border-bottom: 1px solid var(--border); color: var(--text); }
        #view-dashboard .dash-stats { gap: 8px; margin-bottom: 16px; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); }
        #view-dashboard .dash-card { padding: 12px; border-radius: 4px;; box-shadow: none; }
        #view-dashboard .dash-card:hover { transform: none; box-shadow: none; border-color: var(--accent); }
        #view-dashboard .dash-card::before { height: 2px; }
        #view-dashboard .dash-card-icon { display: none; }
        #view-dashboard .dash-card { border-left: 3px solid var(--accent); }
        #view-dashboard .dash-card.card-high { border-left-color: #ff5252; }
        #view-dashboard .dash-card.card-med { border-left-color: #ff9800; }
        #view-dashboard .dash-card.card-low { border-left-color: #ffeb3b; }
        #view-dashboard .dash-card h4 { font-size: 10px; margin-bottom: 4px; }
        #view-dashboard .dash-card-value { font-size: 24px; }
        #view-dashboard .log-table-wrapper { border-radius: 4px;; box-shadow: none; }
        #view-dashboard .quick-filter-btn { border-radius: 4px;; padding: 4px 8px; font-size: 10px; }
        #view-dashboard #event-log-filter { border-radius: 4px;; font-size: 11px; }
        #view-dashboard #btn-dash-clear, #view-dashboard #btn-dash-save { padding: 6px 12px; border-radius: 4px;; font-size: 12px; }
        #view-dashboard #btn-dash-save { box-shadow: none; }
        #view-dashboard #btn-dash-save:hover { transform: none; box-shadow: none; }
        .log-row { 
            font-family: 'Consolas', monospace; 
            font-size: 11px; 
            transition: background-color 0.2s ease;
        }
        .log-row:hover {
            background-color: var(--bg-sec);
        }
        .log-row.new-log {
            animation: logFadeIn 0.5s ease;
        }
        @keyframes logFadeIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        .log-date { 
            color: var(--text-dim); 
            width: 90px; 
            font-size: 10px;
        }
        .log-time { 
            color: var(--text-dim); 
            width: 90px; 
            font-size: 10px;
            font-family: 'Consolas', monospace;
        }
        .log-type { 
            font-weight: bold; 
            width: 100px; 
            text-transform: uppercase;
            font-size: 10px;
            letter-spacing: 0.5px;
        }
        .log-type-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 9px;
            font-weight: 600;
        }
        .log-type-badge.INFO {
            background: rgba(33, 150, 243, 0.2);
            color: #2196f3;
        }
        .log-type-badge.SUCCESS {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }
        .log-type-badge.ERROR {
            background: rgba(255, 82, 82, 0.2);
            color: #ff5252;
        }
        .log-type-badge.SCAN {
            background: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }
        .log-msg { 
            color: var(--text); 
            word-break: break-word;
        }

        /* Unified Context Menu */
        #context-menu {
            display: none;
            position: absolute;
            background: var(--bg-sec);
            border: 1px solid var(--border);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            z-index: 10000;
            border-radius: 8px;
            padding: 6px;
            min-width: 200px;
            animation: menuFadeIn 0.1s ease-out;
        }

        @keyframes menuFadeIn {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }

        .ctx-item {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 13px;
            color: var(--text);
            white-space: nowrap;
            border-radius: 4px;
            margin-bottom: 2px;
            transition: all 0.1s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .ctx-item svg {
            width: 14px;
            height: 14px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
            opacity: 0.8;
        }
        .ctx-item:hover { 
            background: var(--accent); 
            color: #fff;
        }
        .ctx-item:hover .ctx-color-box { border-color: #fff; }
        .ctx-item:hover .submenu-arrow { color: #fff; opacity: 1; }

        .ctx-separator {
            border-top: 1px solid var(--border);
            margin: 6px 0;
            opacity: 0.5;
        }
        .ctx-color-box {
            width: 16px; height: 16px; cursor: pointer;
            border: 1px solid var(--border); border-radius: 4px;;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; color: var(--text);
        }
        .ctx-color-box:hover { border-color: var(--accent); }

        /* JWT Attack Buttons */
        .jwt-attack-btn {
            transition: all 0.2s ease;
        }
        .jwt-attack-btn:hover {
            background: var(--bg-sec) !important;
            border-color: var(--accent) !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .jwt-attack-btn:active {
            transform: translateY(0);
        }

        /* Submenu styles */
        .ctx-item-with-submenu {
            position: relative;
        }
        .submenu-arrow {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 10px; 
            color: var(--text-dim);
            transition: color 0.1s;
        }
        .ctx-submenu {
            display: none;
            position: absolute;
            left: 100%;
            top: -6px;
            margin-left: 2px;
            background: var(--bg-sec);
            border: 1px solid var(--border);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            z-index: 10001;
            border-radius: 8px;
            padding: 6px;
            min-width: 180px;
            animation: menuFadeIn 0.1s ease-out;
        }
        .ctx-item-with-submenu:hover > .ctx-submenu {
            display: block;
        }
        .ctx-submenu:hover {
            display: block;
        }
        /* Create a bridge area between parent and submenu to prevent closing */
        .ctx-item-with-submenu::after {
            content: '';
            position: absolute;
            left: 100%;
            top: 0;
            width: 10px;
            height: 100%;
            background: transparent;
        }

        /* JWT Token Highlight */
        .jwt-token {
            color: #ff6633; /* Purple, like the payload in the decoder */
            background-color: var(--bg-sec);
            padding: 2px 4px;
            border-radius: 3px;
            word-break: break-all; /* Ensure wrapping */
            display: inline-block; /* To respect padding */
        }

        /* Toggle Switch CSS */
        .switch-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 34px;
            height: 20px;
            flex-shrink: 0;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #555;
            transition: .2s;
            border-radius: 20px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .2s;
            border-radius: 50%;
        }
        input:checked + .slider { 
            background-color: var(--accent); 
            animation: pulse-accent 2s infinite;
        }
        input:focus + .slider { box-shadow: 0 0 1px var(--accent); }
        input:checked + .slider:before { transform: translateX(14px); }

        /* Custom colors for the debugger toggle */
        #btn-toggle-debug + .slider {
            background-color: #d32f2f; /* Red for off */
        }
        #btn-toggle-debug:checked + .slider {
            background-color: #388e3c; /* Green for on */
            animation: pulse-green 2s infinite;
        }

        @keyframes pulse-green {
            0% {
                box-shadow: 0 0 0 0 rgba(56, 142, 60, 0.7);
            }
            70% {
                box-shadow: 0 0 0 8px rgba(56, 142, 60, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(56, 142, 60, 0);
            }
        }

        @keyframes pulse-accent {
            0% {
                box-shadow: 0 0 0 0 rgba(var(--accent-r, 255), var(--accent-g, 102), var(--accent-b, 51), 0.7);
            }
            70% {
                box-shadow: 0 0 0 8px rgba(var(--accent-r, 255), var(--accent-g, 102), var(--accent-b, 51), 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(var(--accent-r, 255), var(--accent-g, 102), var(--accent-b, 51), 0);
            }
        }

        /* Bottom Bar */
        .bottom-bar {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            background: var(--bg-ter);
            border-top: 1px solid var(--border);
            height: 15px;
            flex-shrink: 0;
            padding: 0 15px;
            font-size: 11px;
            color: var(--text-dim);
        }
        #memory-usage {
            display: flex;
            gap: 5px;
            align-items: center;
        }
        #memory-value {
            font-weight: bold;
            color: var(--text);
            /* min-width: 50px; */
            text-align: right;
        }

        /* Shake Animation for Easter Egg */
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .shake {
            animation: shake 0.5s;
            animation-iteration-count: 1;
        }

        /* Retro Terminal Scanlines */
        body.retro-theme::after {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(0deg, rgba(0, 0, 0, 0.15), rgba(0, 0, 0, 0.15) 1px, transparent 1px, transparent 2px);
            pointer-events: none;
            z-index: 2147483647;
            animation: scanline 6s linear infinite;
        }

        /* Retro Terminal Text Glow & Glitch */
        body.retro-theme {
            text-shadow: 0 0 3px var(--text-dim);
            animation: crt-flicker 0.15s infinite, glitch-skew 8s infinite;
        }

        /* Glitch Scan Bar */
        body.retro-theme::before {
            content: "";
            position: fixed;
            top: -10%;
            left: 0;
            width: 100%;
            height: 5px;
            background: rgba(51, 255, 51, 0.3);
            box-shadow: 0 0 10px rgba(51, 255, 51, 0.5);
            z-index: 2147483646;
            pointer-events: none;
            animation: glitch-bar 5s linear infinite;
        }

        @keyframes scanline {
            0% { background-position: 0 0; }
            100% { background-position: 0 100%; }
        }

        @keyframes crt-flicker {
            0% { opacity: 0.97; }
            50% { opacity: 1; }
            100% { opacity: 0.98; }
        }

        @keyframes glitch-bar {
            0% { top: -10%; opacity: 0; }
            20% { opacity: 0.5; }
            100% { top: 110%; opacity: 0; }
        }

        @keyframes glitch-skew {
            0% { transform: skew(0deg); }
            96% { transform: skew(0deg); }
            97% { transform: skew(0.5deg); filter: hue-rotate(90deg); }
            98% { transform: skew(-0.5deg); }
            99% { transform: skew(0deg); filter: none; }
            100% { transform: skew(0deg); }
        }

        /* Red Team Tactical Overlay */
        body.red-team-theme {
            /* Grid Pattern */
            background-image: 
                linear-gradient(rgba(255, 0, 0, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 0, 0, 0.05) 1px, transparent 1px);
            background-size: 30px 30px;
            /* Pulsing Vignette */
            animation: red-alert-pulse 4s infinite ease-in-out;
        }

        @keyframes red-alert-pulse {
            0% { box-shadow: inset 0 0 80px rgba(255, 0, 0, 0.1); }
            50% { box-shadow: inset 0 0 150px rgba(255, 0, 0, 0.25); }
            100% { box-shadow: inset 0 0 80px rgba(255, 0, 0, 0.1); }
        }

        /* Cyberpunk Neon Glow */
        body.cyberpunk-theme {
            text-shadow: 0 0 2px var(--text-dim), 0 0 5px var(--accent);
        }

        /* High Contrast (Black & White) */
        body.high-contrast-theme {
            --row-hover: #000000;
        }
        body.high-contrast-theme * {
            text-shadow: none !important;
            box-shadow: none !important;
        }
        body.high-contrast-theme button,
        body.high-contrast-theme input,
        body.high-contrast-theme select,
        body.high-contrast-theme textarea,
        body.high-contrast-theme .dash-card,
        body.high-contrast-theme .inspector-section,
        body.high-contrast-theme .log-table-wrapper,
        body.high-contrast-theme .history-table-wrapper,
        body.high-contrast-theme .ctx-submenu {
            border: 2px solid #ffffff !important;
        }
        body.high-contrast-theme .nav-tab.active {
            border: 2px solid #ffffff !important;
            border-bottom: 2px solid #000000 !important;
        }
        body.high-contrast-theme tr.req-row:hover,
        body.high-contrast-theme .ctx-item:hover,
        body.high-contrast-theme .nav-tab:hover,
        body.high-contrast-theme .tree-content:hover {
            background-color: #ffffff !important;
            color: #000000 !important;
        }
        body.high-contrast-theme tr.req-row:hover td,
        body.high-contrast-theme .ctx-item:hover *,
        body.high-contrast-theme .tree-content:hover * {
            color: #000000 !important;
        }
        body.high-contrast-theme ::-webkit-scrollbar-thumb {
            background-color: #ffffff;
            border: 2px solid #000000;
        }
        body.high-contrast-theme .btn-approve,
        body.high-contrast-theme .btn-reject,
        body.high-contrast-theme .btn-replay,
        body.high-contrast-theme button {
            background-color: #000000 !important;
            color: #ffffff !important;
        }
        body.high-contrast-theme .btn-approve:hover,
        body.high-contrast-theme .btn-reject:hover,
        body.high-contrast-theme .btn-replay:hover,
        body.high-contrast-theme button:hover {
            background-color: #ffffff !important;
            color: #000000 !important;
        }

        /* Windows 2000 Theme */
        body.win2k-theme {
            font-family: 'Tahoma', sans-serif;
            font-size: 11px;
        }
        body.win2k-theme button,
        body.win2k-theme .btn,
        body.win2k-theme .rep-tab,
        body.win2k-theme .nav-tab,
        body.win2k-theme .quick-filter-btn {
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            background-color: #d4d0c8;
            color: #000000;
            box-shadow: none;
        }
        body.win2k-theme button:active,
        body.win2k-theme .nav-tab.active,
        body.win2k-theme .quick-filter-btn.active {
            border-color: #808080 #ffffff #ffffff #808080;
            background-color: #d4d0c8;
        }
        body.win2k-theme input,
        body.win2k-theme textarea,
        body.win2k-theme select,
        body.win2k-theme .editor-raw,
        body.win2k-theme .history-table-wrapper,
        body.win2k-theme .log-table-wrapper,
        body.win2k-theme .inspector-section,
        body.win2k-theme .dash-card {
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            background-color: #ffffff;
            color: #000000;
        }
        body.win2k-theme .global-bar,
        body.win2k-theme .pane-header,
        body.win2k-theme .inspector-title {
            background: linear-gradient(90deg, #0a246a, #a6caf0);
            color: white;
            font-weight: bold;
            text-shadow: none;
        }
        body.win2k-theme .global-bar-title {
            color: white;
        }
        body.win2k-theme .nav-tab.active {
            background: #d4d0c8;
            border-bottom: none;
            position: relative;
            top: 1px;
        }
        body.win2k-theme ::-webkit-scrollbar {
            background: #d4d0c8;
        }
        body.win2k-theme ::-webkit-scrollbar-thumb {
            background: #d4d0c8;
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
        }
        body.win2k-theme tr.req-row:hover,
        body.win2k-theme .tree-content:hover {
            background-color: #0a246a;
            color: white;
        }
        body.win2k-theme tr.req-row:hover td {
            color: white;
        }
        body.win2k-theme .btn-approve,
        body.win2k-theme .btn-reject,
        body.win2k-theme .btn-replay {
            background-color: #d4d0c8 !important;
            color: black !important;
        }

        /* macOS Tahoe Theme */
        body.macos-tahoe-theme {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
        body.macos-tahoe-theme .global-bar,
        body.macos-tahoe-theme .pane-header,
        body.macos-tahoe-theme .inspector-title,
        body.macos-tahoe-theme .bottom-bar {
            background: rgba(30, 30, 30, 0.85); /* Dark Glass */
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        body.macos-tahoe-theme button,
        body.macos-tahoe-theme .btn,
        body.macos-tahoe-theme .quick-filter-btn {
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
            font-weight: 500;
        }
        body.macos-tahoe-theme .nav-tab.active {
            background: var(--bg-main);
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            border: 1px solid var(--border);
            border-bottom: none;
        }
        body.macos-tahoe-theme input,
        body.macos-tahoe-theme textarea,
        body.macos-tahoe-theme select {
            border: 1px solid var(--border);
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.2);
        }
        body.macos-tahoe-theme ::-webkit-scrollbar-thumb {
            background-color: #c1c1c1;
            border-radius: 10px;
            border: 3px solid transparent;
            background-clip: content-box;
        }

        /* Kali Linux Dark Theme */
        body.kali-dark-theme {
            font-family: 'Roboto', 'Segoe UI', sans-serif;
        }
        body.kali-dark-theme .global-bar,
        body.kali-dark-theme .pane-header {
            background: linear-gradient(90deg, #1f2229 0%, #282c34 100%);
            border-bottom: 1px solid var(--accent);
        }
        body.kali-dark-theme .nav-tab.active {
            border-top: 2px solid var(--accent);
        }

        /* Fallout Pip-Boy Theme */
        body.fallout-theme {
            font-family: 'Consolas', 'Courier New', monospace;
            text-shadow: 0 0 4px var(--text); /* Phosphor Glow */
        }
        /* Scanline Overlay */
        body.fallout-theme::before {
            content: " ";
            display: block;
            position: fixed;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 9999;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* Toast Notifications */
        #toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }

        .toast {
            background: var(--bg-sec);
            color: var(--text);
            border: 1px solid var(--border);
            border-left: 4px solid var(--accent);
            padding: 12px 20px;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease-out forwards;
            min-width: 200px;
            pointer-events: auto;
        }

        .toast.success { border-left-color: #4caf50; }
        .toast.error { border-left-color: #ff5252; }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* Intruder - Burp Suite Pro style */
        #view-intruder #intruder-main-tabs { border-bottom: 1px solid var(--border); background: var(--bg-ter); padding: 0; min-height: 28px; }
        #view-intruder #intruder-main-tabs .tab { padding: 6px 14px; font-size: 12px; font-weight: 500; border-radius: 0; border: none; color: var(--text-dim); background: transparent; }
        #view-intruder #intruder-main-tabs .tab.active { color: var(--text); background: var(--bg-sec); border-bottom: 2px solid var(--accent); }
        #view-intruder #intruder-attack-controls { padding: 6px 10px; border-bottom: 1px solid var(--border); background: var(--bg-ter); border-radius: 0; }
        #view-intruder #intruder-editor-container .tabs.inner-tabs { border-bottom: 1px solid var(--border); background: var(--bg-ter); padding: 0 8px; border-radius: 0; }
        #view-intruder #intruder-editor-container .tabs.inner-tabs .tab { padding: 5px 12px; font-size: 12px; border-radius: 0; }
        #view-intruder #intruder-editor-container .tabs.inner-tabs .tab.active { border-bottom: 2px solid var(--accent); }
        #view-intruder #content-intruder-config .intruder-config-content { padding: 12px; }
        #view-intruder #intruder-positions .editor-wrapper { border-radius: 4px;; border: 1px solid var(--border); }
        #view-intruder #intruder-positions [id^="intruder-markers"], #view-intruder #intruder-positions #btn-intruder-clear-markers { border-radius: 4px;; padding: 6px 12px; font-size: 12px; box-shadow: none; }
        #view-intruder #intruder-payloads-config select, #view-intruder #intruder-payloads-config textarea, #view-intruder #intruder-payloads-config input { border-radius: 4px;; }
        #view-intruder #intruder-settings input[type="text"], #view-intruder #intruder-settings input[type="number"] { border-radius: 4px;; }
        #view-intruder #content-intruder-results .history-table-wrapper { border: 1px solid var(--border); border-radius: 4px;; }
        #view-intruder #btn-start-intruder, #view-intruder #btn-pause-intruder { border-radius: 4px;; padding: 6px 12px; font-size: 12px; font-weight: 600; }
        #view-intruder #intruder-tabs-bar { min-height: 26px; border-bottom: 1px solid var(--border); }

        /* About Page Styles */
        #view-about a[href*="github.com"]:hover,
        #about-version-display:hover {
            background: var(--hover) !important;
            border-color: var(--accent) !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        #view-about a[href*="github.com"]:active,
        #about-version-display:active {
            transform: translateY(0);
        }
    </style>
    <!-- Note: Syntax highlighting is handled by custom CSS variables in themes (--sh-*) -->
</head>

<body>
    <!-- Global Settings Bar -->
    <div class="global-bar">
        <div style="display: flex; align-items: center; gap: 15px;">
            <div class="global-bar-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
                WebSentinel
            </div>
            <div style="position: relative;">
                <button id="btn-project-menu" style="background: transparent; border: none; color: var(--text); cursor: pointer; font-size: 12px; font-weight: 600; display: flex; align-items: center; gap: 4px; padding: 0;">
                    Project <span style="font-size: 10px;">â–¼</span>
                </button>
                <div id="project-menu-dropdown" style="display: none; position: absolute; top: 100%; left: 0; background: var(--bg-sec); border: 1px solid var(--border); min-width: 150px; z-index: 2001; border-radius: 4px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); margin-top: 5px;">
                    <div class="ctx-item" id="menu-new-project">New Project</div>
                    <div class="ctx-separator"></div>
                    <div class="ctx-item" id="menu-save-project" data-i18n="settings_save_project">Save Project</div>
                    <div class="ctx-item" id="menu-load-project" data-i18n="settings_load_project">Load Project</div>
                    <div class="ctx-separator"></div>
                    <div class="ctx-item" id="menu-reset-session" style="color: #ff5252;">Reset Session</div>
                </div>
            </div>
        </div>
        <div style="display: flex; align-items: center; gap: 10px;">
            <div class="switch-container">
                <label for="btn-toggle-debug" style="cursor: pointer; font-size: 11px; color: var(--text); margin-bottom: 0;">Debugger</label>
                <label class="switch" style="transform: scale(0.85);">
                    <input type="checkbox" id="btn-toggle-debug">
                    <span class="slider"></span>
                </label>
            </div>
            <select id="theme-selector" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 2px 5px; font-size: 11px; outline: none; border-radius: 4px;">
                <option value="websentinel" style="background: var(--bg-sec); color: var(--text);">WebSentinel (Default)</option>
                <option value="red-team" style="background: var(--bg-sec); color: var(--text);">Red Team</option>
                <option value="classic-dark" style="background: var(--bg-sec); color: var(--text);">Classic Dark</option>
                <option value="classic-light" style="background: var(--bg-sec); color: var(--text);">Classic Light</option>
                <option value="hacker" style="background: var(--bg-sec); color: var(--text);">Hacker Theme</option>
                <option value="solarized-dark" style="background: var(--bg-sec); color: var(--text);">Solarized Dark</option>
                <option value="solarized-light" style="background: var(--bg-sec); color: var(--text);">Solarized Light</option>
                <option value="retro-terminal" style="background: var(--bg-sec); color: var(--text);">Retro Terminal</option>
                <option value="cyberpunk" style="background: var(--bg-sec); color: var(--text);">Cyberpunk Neon</option>
                <option value="dracula" style="background: var(--bg-sec); color: var(--text);">Dracula</option>
                <option value="nord" style="background: var(--bg-sec); color: var(--text);">Nord</option>
                <option value="monokai" style="background: var(--bg-sec); color: var(--text);">Monokai</option>
                <option value="high-contrast" style="background: var(--bg-sec); color: var(--text);">High Contrast (B&W)</option>
                <option value="win2k" style="background: var(--bg-sec); color: var(--text);">Windows 2000</option>
                <option value="macos-tahoe" style="background: var(--bg-sec); color: var(--text);">macOS Tahoe</option>
                <option value="kali-dark" style="background: var(--bg-sec); color: var(--text);">Kali Linux Dark</option>
                <option value="fallout" style="background: var(--bg-sec); color: var(--text);">Fallout (Pip-Boy)</option>
            </select>
            <button id="btn-fullscreen" style="background: transparent; border: none; cursor: pointer; color: var(--text-dim); padding: 0; display: flex; align-items: center;" title="Toggle Fullscreen">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
                </svg>
            </button>
            <button id="btn-detach" style="background: transparent; border: none; cursor: pointer; color: var(--text-dim); padding: 0; display: flex; align-items: center;" title="Detach to new window">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                    <polyline points="15 3 21 3 21 9"></polyline>
                    <line x1="10" y1="14" x2="21" y2="3"></line>
                </svg>
            </button>
        </div>
    </div>

    <!-- Topbar -->
    <div class="top-nav">
        <button class="nav-tab active" data-target="view-dashboard">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
            <span data-i18n="nav_dashboard">Dashboard</span>
        </button>
        <button class="nav-tab" data-target="view-target">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg>
            <span data-i18n="nav_target">Target</span>
        </button>
        <button class="nav-tab" data-target="view-proxy">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 18 15.3 15.3 0 0 1-8 0 15.3 15.3 0 0 1 4-18z"></path></svg>
            <span data-i18n="nav_proxy">Proxy</span>
        </button>
        <button class="nav-tab" data-target="view-intruder">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
            <span data-i18n="nav_intruder">Intruder</span>
        </button>
        <button class="nav-tab" data-target="view-decoder">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
            <span data-i18n="nav_decoder">Decoder</span>
        </button>
        <button class="nav-tab" data-target="view-comparer">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3v18"></path><rect x="4" y="6" width="16" height="12" rx="2"></rect></svg>
            <span data-i18n="nav_comparer">Comparer</span>
        </button>
        <button class="nav-tab" data-target="view-repeater">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="17 1 21 5 17 9"></polyline><path d="M3 11V9a4 4 0 0 1 4-4h14"></path><polyline points="7 23 3 19 7 15"></polyline><path d="M21 13v2a4 4 0 0 1-4 4H3"></path></svg>
            <span data-i18n="nav_repeater">Repeater</span>
        </button>
        <button class="nav-tab" data-target="view-notes">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
            <span data-i18n="nav_notes">Notes</span>
        </button>
        <button class="nav-tab" data-target="view-flow">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
            <span data-i18n="nav_flow">Flow</span>
        </button>
        <button class="nav-tab" data-target="view-search">
            <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            <span>Search</span>
        </button>
        <button class="nav-tab" data-target="view-extensions">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="9" rx="1"></rect><rect x="14" y="3" width="7" height="5" rx="1"></rect><rect x="14" y="12" width="7" height="9" rx="1"></rect><rect x="3" y="16" width="7" height="5" rx="1"></rect></svg>
            <span data-i18n="nav_extensions">Extensions</span>
        </button>
        <button class="nav-tab" data-target="view-settings">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
            <span data-i18n="nav_settings">Settings</span>
        </button>
        <button class="nav-tab" data-target="view-about">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
            <span data-i18n="nav_about">About</span>
        </button>
    </div>

    <!-- Aba Dashboard (Burp Suite Pro style) -->
    <div id="view-dashboard" class="view-container active" style="flex-direction: column; padding: 12px; box-sizing: border-box; overflow-y: auto;">
        <h3 style="margin: 0 0 8px 0; border-bottom: 1px solid var(--border); padding-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Dashboard</h3>

        <div class="dash-stats">
            <div class="dash-card" id="dash-card-requests" title="Click to view History">
                <div class="dash-card-icon"> </div>
                <h4>Total requests</h4>
                <div class="dash-card-value" id="dash-stat-reqs">0</div>
            </div>
            <div class="dash-card card-high" id="dash-card-high" title="Click to view High severity issues">
                <div class="dash-card-icon"> </div>
                <h4>High</h4>
                <div class="dash-card-value" id="dash-stat-high">0</div>
            </div>
            <div class="dash-card card-med" id="dash-card-med" title="Click to view Medium severity issues">
                <div class="dash-card-icon"> </div>
                <h4>Medium</h4>
                <div class="dash-card-value" id="dash-stat-med">0</div>
            </div>
            <div class="dash-card card-low" id="dash-card-low" title="Click to view Low severity issues">
                <div class="dash-card-icon"> </div>
                <h4>Low</h4>
                <div class="dash-card-value" id="dash-stat-low">0</div>
            </div>
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 12px; border-bottom: 1px solid var(--border); padding-bottom: 6px;">
            <h3 style="margin: 0; padding: 0; font-size: 12px; font-weight: 600; color: var(--text);">Event log</h3>
            <input type="text" id="event-log-filter" placeholder="Filter logs..." style="width: 200px; padding: 5px 8px; border: 1px solid var(--border); border-radius: 4px;; background: var(--bg-input); color: var(--text); font-size: 11px;">
        </div>
        <div id="event-log-quick-filters" style="display: flex; gap: 4px; padding: 4px 0 8px 0;">
            <button class="quick-filter-btn" data-filter="INFO" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); font-size: 10px; padding: 4px 8px; cursor: pointer; border-radius: 4px;;">INFO</button>
            <button class="quick-filter-btn" data-filter="SUCCESS" style="background: var(--bg-input); border: 1px solid var(--border); color: #4caf50; font-size: 10px; padding: 4px 8px; cursor: pointer; border-radius: 4px;;">SUCCESS</button>
            <button class="quick-filter-btn" data-filter="SCAN" style="background: var(--bg-input); border: 1px solid var(--border); color: #ff9800; font-size: 10px; padding: 4px 8px; cursor: pointer; border-radius: 4px;;">SCAN</button>
            <button class="quick-filter-btn" data-filter="ERROR" style="background: var(--bg-input); border: 1px solid var(--border); color: #ff5252; font-size: 10px; padding: 4px 8px; cursor: pointer; border-radius: 4px;;">ERROR</button>
        </div>
        <div class="log-table-wrapper" style="height: 180px; min-height: 180px; margin-bottom: 12px;">
            <table id="event-log-table">
                <thead>
                    <tr>
                        <th data-column-id="date" data-type="date" style="width: 72px;">Date <div class="resizer"></div></th>
                        <th data-column-id="time" data-type="string" style="width: 72px;">Time <div class="resizer"></div></th>
                        <th data-column-id="type" data-type="string" style="width: 90px;">Type <div class="resizer"></div></th>
                        <th data-column-id="message" data-type="string">Message <div class="resizer"></div></th>
                    </tr>
                </thead>
                <tbody id="event-log-body"></tbody>
            </table>
        </div>

        <h3 style="margin: 0 0 8px 0; border-bottom: 1px solid var(--border); padding-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Quick actions</h3>
        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <button id="btn-dash-clear" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; cursor: pointer; font-size: 12px;">Clear all data</button>
            <button id="btn-dash-save" style="background: var(--accent); border: none; color: white; padding: 6px 12px; border-radius: 4px;; cursor: pointer; font-weight: 600; font-size: 12px;">Save project</button>
        </div>

        <h3 style="margin: 16px 0 8px 0; border-bottom: 1px solid var(--border); padding-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">OAST scanner</h3>
        <div style="padding: 16px; text-align: center; color: var(--text-dim); border: 1px dashed var(--border); border-radius: 4px;; background: var(--bg-ter);">
            <div style="font-weight: 500; margin-bottom: 4px; color: var(--text); font-size: 12px;">Coming soon</div>
            <div style="font-size: 11px;">This feature is under development.</div>
        </div>
    </div>

    <!-- Aba Target (Burp Suite Pro style) -->
    <div id="view-target" class="view-container" style="flex-direction: column;">
        <div class="tabs">
            <div class="tab active" id="tab-target-sitemap">Site map</div>
            <div class="tab" id="tab-target-scope">Scope</div>
            <div class="tab" id="tab-target-issues">Issues</div>
        </div>

        <div id="content-target-sitemap" class="tab-content active" style="overflow: auto; padding: 12px;">
            <h3 style="margin: 0 0 8px 0; padding-bottom: 6px; border-bottom: 1px solid var(--border); font-size: 12px; font-weight: 600; color: var(--text);">Site map</h3>
            <div id="sitemap-container" style="color: var(--text);"></div>
        </div>

        <div id="content-target-scope" class="tab-content" style="padding: 12px; box-sizing: border-box; overflow-y: auto;">
            <h3 style="margin: 0 0 12px 0; padding-bottom: 6px; border-bottom: 1px solid var(--border); font-size: 12px; font-weight: 600; color: var(--text);">Scope</h3>
            <div class="switch-container" style="justify-content: flex-start; gap: 10px; margin-bottom: 12px; align-items: center;">
                <label for="chk-enable-scope" style="cursor: pointer; font-size: 12px; color: var(--text); font-weight: 500;">Use only in-scope items</label>
                <label class="switch">
                    <input type="checkbox" id="chk-enable-scope">
                    <span class="slider"></span>
                </label>
            </div>
            <div style="display: flex; gap: 8px; margin-bottom: 10px; align-items: center;">
                <input type="text" id="scope-input" placeholder="e.g. *://api.example.com/*" class="csp-focus-input" style="flex: 1; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; color: var(--text); outline: none; font-size: 12px;">
                <button id="btn-add-scope" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 6px 14px; border-radius: 4px;; font-size: 12px; font-weight: 600; cursor: pointer;">Add</button>
            </div>
            <div id="scope-list" style="flex: 1; border: 1px solid var(--border); background: var(--bg-ter); overflow-y: auto; border-radius: 4px;; padding: 10px; min-height: 180px;">
                <!-- Scope items -->
            </div>
            <p style="color: var(--text-dim); font-size: 11px; margin-top: 6px; margin-bottom: 0;">Use <b>*</b> as a wildcard. Example: <b>*example.com*</b></p>

            <h3 style="margin: 20px 0 12px 0; padding-bottom: 6px; border-bottom: 1px solid var(--border); font-size: 12px; font-weight: 600; color: var(--text);">Exclude from scope</h3>
            <div class="switch-container" style="justify-content: space-between; width: 100%; margin-bottom: 10px;">
                <label for="chk-enable-blacklist" style="cursor: pointer; font-size: 12px; color: var(--text);">Enable blacklist</label>
                <label class="switch">
                    <input type="checkbox" id="chk-enable-blacklist">
                    <span class="slider"></span>
                </label>
            </div>
            <div style="display: flex; gap: 8px; margin-bottom: 10px; align-items: center;">
                <input type="text" id="blacklist-input" placeholder="e.g. *google-analytics.com*" class="csp-focus-input" style="flex: 1; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; color: var(--text); outline: none; font-size: 12px;">
                <button id="btn-add-blacklist" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 6px 14px; border-radius: 4px;; font-size: 12px; font-weight: 600; cursor: pointer;">Add</button>
            </div>
            <div id="blacklist-list" style="flex: 1; border: 1px solid var(--border); background: var(--bg-ter); overflow-y: auto; border-radius: 4px;; padding: 10px; min-height: 120px;"></div>
        </div>

        <div id="content-target-issues" class="tab-content" style="flex-direction: column; overflow: auto;">
            <div class="filter-box" style="background: var(--bg-ter); padding: 8px 10px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 8px;">
                <input type="text" id="issues-filter-input" placeholder="Filter by URL or type..." class="csp-focus-input" style="flex: 1; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; color: var(--text); outline: none; font-size: 12px;">
            </div>
            <div class="history-table-wrapper" style="border: 1px solid var(--border); border-radius: 4px;; flex: 1; min-height: 200px;">
                <table id="issues-table">
                    <thead>
                        <tr>
                            <th data-column-id="severity" style="width: 72px;">Severity <div class="resizer"></div></th>
                            <th data-column-id="issue" style="width: 25%;">Issue <div class="resizer"></div></th>
                            <th data-column-id="host" style="width: 25%;">Host <div class="resizer"></div></th>
                            <th data-column-id="path">Path <div class="resizer"></div></th>
                            <th data-column-id="time" data-type="date" style="width: 72px;">Time <div class="resizer"></div></th>
                            <th data-column-id="date" data-type="date" style="width: 72px;">Date <div class="resizer"></div></th>
                        </tr>
                    </thead>
                    <tbody id="issues-list-body"></tbody>
                </table>
            </div>
            <div style="display: flex; justify-content: flex-end; padding: 8px 10px; border-top: 1px solid var(--border); background: var(--bg-ter); gap: 8px;">
                <button id="btn-generate-report-ai" class="csp-hover-button" style="padding: 6px 12px; font-size: 12px; font-weight: 600; background: var(--accent); border: none; color: white; border-radius: 4px;; cursor: pointer;">Generate report with AI</button>
                <button id="btn-export-report" class="csp-hover-button" style="padding: 6px 12px; font-size: 12px; font-weight: 600; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; cursor: pointer;" disabled>
                    <svg style="width: 14px; height: 14px; vertical-align: middle; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                    Export report
                </button>
            </div>
            <div id="issue-splitter" style="height: 4px; cursor: ns-resize; position: relative;">
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 2px; background: var(--text-dim); opacity: 0.3; border-radius: 2px;"></div>
            </div>
            <div id="issue-details" style="height: 200px; border-top: 1px solid var(--border); padding: 8px 10px; overflow: auto; background: var(--bg-main); color: var(--text); font-size: 12px;">
                <div class="empty-state" style="height: 100%; display: flex; align-items: center; justify-content: center; color: var(--text-dim); font-style: italic;">
                    Click on an issue to view details
                </div>
            </div>
        </div>
    </div>

    <!-- Aba Proxy (Burp Suite Pro style) -->
    <div id="view-proxy" class="view-container" style="flex-direction: column;">
        <div class="tabs">
            <div class="tab active" id="tab-proxy-intercept">Intercept</div>
            <div class="tab" id="tab-proxy-history">History</div>
            <div class="tab" id="tab-proxy-websockets">WebSockets</div>
            <div class="tab" id="tab-proxy-match-replace">Match & Replace</div>
        </div>
 
        <!-- Intercept Content -->
        <div id="content-proxy-intercept" class="tab-content active" style="flex-direction: column; overflow-y: auto;">
            <div style="padding: 8px 12px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; background: var(--bg-ter); flex-shrink: 0;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div class="switch-container">
                        <label for="chk-intercept" style="cursor: pointer; font-size: 12px; color: var(--text); font-weight: 500; display: flex; align-items: center; gap: 6px;">
                            <span>Intercept is on/off</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="chk-intercept">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div id="intercept-status" style="padding: 4px 10px; border-radius: 4px;; font-size: 11px; font-weight: 600; background: var(--bg-input); color: var(--text-dim); display: none; border: 1px solid var(--border);">
                        <span id="intercept-status-text">0 paused</span>
                    </div>
                </div>
            </div>
            
            <!-- Intercept Splash Screen -->
            <div id="intercept-splash-screen" style="display: none; flex: 1; align-items: center; justify-content: center; padding: 24px; text-align: center; background: var(--bg-main); animation: fadeIn 0.3s ease;">
                <div style="max-width: 520px;">
                    <h2 style="color: var(--text); margin: 0 0 8px 0; font-size: 18px; font-weight: 600;">Intercept</h2>
                    <p style="color: var(--text-dim); margin: 0 0 20px 0; font-size: 13px; line-height: 1.5;">
                        Pause, inspect, and modify HTTP/HTTPS requests and responses in real-time before they are sent or returned.
                    </p>
                    <div style="background: var(--bg-sec); border: 1px solid var(--border); border-radius: 4px;; padding: 16px; text-align: left; margin-bottom: 20px;">
                        <h3 style="color: var(--text); margin: 0 0 10px 0; font-size: 13px; font-weight: 600;">How it works</h3>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <div style="display: flex; align-items: start; gap: 10px;">
                                <div style="width: 20px; height: 20px; border-radius: 4px;; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; flex-shrink: 0;">1</div>
                                <div>
                                    <div style="color: var(--text); font-weight: 500; margin-bottom: 2px; font-size: 12px;">Enable Intercept</div>
                                    <div style="color: var(--text-dim); font-size: 12px; line-height: 1.5;">Toggle the switch above to start capturing requests</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: start; gap: 10px;">
                                <div style="width: 20px; height: 20px; border-radius: 4px;; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; flex-shrink: 0;">2</div>
                                <div>
                                    <div style="color: var(--text); font-weight: 500; margin-bottom: 2px; font-size: 12px;">Browse the web</div>
                                    <div style="color: var(--text-dim); font-size: 12px; line-height: 1.5;">Requests will be paused here for inspection</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: start; gap: 10px;">
                                <div style="width: 20px; height: 20px; border-radius: 4px;; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; flex-shrink: 0;">3</div>
                                <div>
                                    <div style="color: var(--text); font-weight: 500; margin-bottom: 2px; font-size: 12px;">Modify and forward</div>
                                    <div style="color: var(--text-dim); font-size: 12px; line-height: 1.5;">Edit as needed, then click Forward to continue</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="background: var(--bg-sec); border: 1px solid var(--border); border-left: 3px solid var(--accent); border-radius: 4px;; padding: 12px 14px; text-align: left; margin-bottom: 20px;">
                        <div style="color: var(--text); font-weight: 600; font-size: 12px; margin-bottom: 4px;">Tip</div>
                        <div style="color: var(--text-dim); font-size: 12px; line-height: 1.5;">
                            Use Match & Replace to configure which requests are intercepted (e.g. by URL or file extension).
                        </div>
                    </div>
                    <button id="btn-enable-intercept" 
                        class="csp-hover-button"
                        style="background: var(--accent); border: none; color: white; padding: 8px 20px; cursor: pointer; font-weight: 600; border-radius: 4px;; font-size: 12px; box-shadow: none;">
                        Enable Intercept
                    </button>
                </div>
            </div>
            
            <div id="intercept-main" style="flex: 1; display: flex; flex-direction: column; position: relative; overflow: hidden; min-height: 0;">
                <div class="empty-state" style="padding: 12px 16px; font-size: 12px;">
                    <p>No paused requests</p>
                </div>
            </div>
        </div>

        <!-- History Content -->
        <div id="content-proxy-history" class="tab-content" style="flex-direction: column;">
            <div class="filter-box" style="display: flex; flex-direction: column; gap: 8px; background: var(--bg-ter); padding: 8px 10px; border-bottom: 1px solid var(--border);">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <input type="text" id="filter-input" placeholder="Filter by URL..." class="csp-focus-input"
                        style="flex: 1; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; color: var(--text); outline: none; font-size: 12px;">
                    <button id="btn-clear-history" class="csp-hover-button"
                        style="width: auto; padding: 6px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;; font-size: 12px; font-weight: 500;"
                        title="Clear History">Clear</button>
                    <button id="btn-export-har" class="csp-hover-button"
                        style="width: auto; padding: 6px 12px; background: var(--accent); border: none; color: white; cursor: pointer; border-radius: 4px;; font-size: 12px; font-weight: 600; box-shadow: none;"
                        title="Export HAR">Export</button>
                    <button id="btn-import-har" class="csp-hover-button"
                        style="width: auto; padding: 6px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;; font-size: 12px; font-weight: 500;"
                        title="Import HAR">Import</button>
                </div>
                <div id="history-checkbox-filters" style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
                    <div class="switch-container" style="gap: 6px;">
                        <label for="chk-show-scoped" style="cursor: pointer; font-size: 12px; color: var(--text); font-weight: 500; display: flex; align-items: center; gap: 6px;">
                            <span>Only scoped items</span>
                        </label>
                        <label class="switch"><input type="checkbox" id="chk-show-scoped"><span class="slider"></span></label>
                    </div>
                    <div class="switch-container" style="gap: 6px;">
                        <label for="chk-show-highlighted" style="cursor: pointer; font-size: 12px; color: var(--text); font-weight: 500; display: flex; align-items: center; gap: 6px;">
                            <span>Only highlighted items</span>
                        </label>
                        <label class="switch"><input type="checkbox" id="chk-show-highlighted"><span class="slider"></span></label>
                    </div>
                    <div class="switch-container" style="gap: 6px;">
                        <label for="chk-hide-static" style="cursor: pointer; font-size: 12px; color: var(--text); font-weight: 500; display: flex; align-items: center; gap: 6px;" data-i18n="filter_hide_static">
                            <span>Hide static files</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="chk-hide-static">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div id="history-request-count" style="margin-left: auto; padding: 4px 10px; border-radius: 4px;; font-size: 11px; font-weight: 600; background: var(--bg-input); color: var(--text-dim); border: 1px solid var(--border);">
                        <span id="history-count-text">0 requests</span>
                    </div>
                </div>
                <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap; padding-top: 6px; border-top: 1px solid var(--border);">
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <span style="font-size: 11px; color: var(--text-dim); font-weight: 600;">Method:</span>
                        <div id="history-method-filters" style="display: flex; gap: 4px;">
                            <button class="status-filter-btn" data-method="GET" title="Filter GET requests" style="padding: 4px 10px; font-size: 11px; font-weight: 600;">GET</button>
                            <button class="status-filter-btn" data-method="POST" title="Filter POST requests" style="padding: 6px 12px; font-size: 11px; font-weight: 600;">POST</button>
                            <button class="status-filter-btn" data-method="PUT" title="Filter PUT requests" style="padding: 6px 12px; font-size: 11px; font-weight: 600;">PUT</button>
                            <button class="status-filter-btn" data-method="DELETE" title="Filter DELETE requests" style="padding: 6px 12px; font-size: 11px; font-weight: 600;">DELETE</button>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px; border-left: 1px solid var(--border); padding-left: 12px;">
                        <span style="font-size: 12px; color: var(--text-dim); font-weight: 600;">Type:</span>
                        <div id="history-type-filters" style="display: flex; gap: 6px;">
                            <button class="status-filter-btn" data-type="XHR" title="Filter XHR/Fetch requests" style="padding: 6px 12px; font-size: 11px; font-weight: 600;">XHR</button>
                            <button class="status-filter-btn" data-type="JS" title="Filter JavaScript files" style="padding: 6px 12px; font-size: 11px; font-weight: 600;">JS</button>
                            <button class="status-filter-btn" data-type="CSS" title="Filter CSS files" style="padding: 6px 12px; font-size: 11px; font-weight: 600;">CSS</button>
                            <button class="status-filter-btn" data-type="Doc" title="Filter Documents" style="padding: 6px 12px; font-size: 11px; font-weight: 600;">Doc</button>
                            <button class="status-filter-btn" data-type="Img" title="Filter Images" style="padding: 6px 12px; font-size: 11px; font-weight: 600;">Img</button>
                            <button class="status-filter-btn" data-type="Other" title="Filter Other resources" style="padding: 6px 12px; font-size: 11px; font-weight: 600;">Other</button>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px; border-left: 1px solid var(--border); padding-left: 12px;">
                        <span style="font-size: 12px; color: var(--text-dim); font-weight: 600;">Status:</span>
                        <div id="history-status-filters" style="display: flex; gap: 6px;">
                            <button class="status-filter-btn" data-status-group="2xx" title="Filter 2xx (Success) responses" style="padding: 6px 12px; font-size: 11px; font-weight: 600; color: #4caf50;">2xx</button>
                            <button class="status-filter-btn" data-status-group="3xx" title="Filter 3xx (Redirection) responses" style="padding: 6px 12px; font-size: 11px; font-weight: 600; color: #ff9800;">3xx</button>
                            <button class="status-filter-btn" data-status-group="4xx" title="Filter 4xx (Client Error) responses" style="padding: 6px 12px; font-size: 11px; font-weight: 600; color: #ff5252;">4xx</button>
                            <button class="status-filter-btn" data-status-group="5xx" title="Filter 5xx (Server Error) responses" style="padding: 6px 12px; font-size: 11px; font-weight: 600; color: #d32f2f;">5xx</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Multi-selection toolbar for History -->
            <div id="history-multi-select-toolbar" style="display: none; padding: 8px 12px; background: var(--bg-sec); border-bottom: 1px solid var(--border); gap: 8px; align-items: center; flex-wrap: wrap;">
                <span id="history-selection-count" style="font-size: 12px; color: var(--text); font-weight: 600;">0 selected</span>
            </div>
            <div class="history-table-wrapper">
                <table id="history-table">
                    <thead>
                        <tr>
                            <th data-column-id="id" data-type="number"># <div class="resizer"></div></th>
                            <th data-column-id="host" data-type="string">Host <div class="resizer"></div></th>
                            <th data-column-id="method" data-type="string">Method <div class="resizer"></div></th>
                            <th data-column-id="type" data-type="string">Type <div class="resizer"></div></th>
                            <th data-column-id="url" data-type="string">URL <div class="resizer"></div></th>
                            <th data-column-id="params" data-type="string">Params <div class="resizer"></div></th>
                            <th data-column-id="edited" data-type="string">Edited <div class="resizer"></div></th>
                            <th data-column-id="status" data-type="number">Status <div class="resizer"></div></th>
                            <th data-column-id="length" data-type="number">Length <div class="resizer"></div></th>
                            <th data-column-id="mime" data-type="string">MIME type <div class="resizer"></div></th>
                            <th data-column-id="extension" data-type="string">Extension <div class="resizer"></div></th>
                            <th data-column-id="title" data-type="string">Title <div class="resizer"></div></th>
                            <th data-column-id="comment" data-type="string">Comment <div class="resizer"></div></th>
                            <th data-column-id="tls" data-type="string">TLS <div class="resizer"></div></th>
                            <th data-column-id="ip" data-type="ip">IP Address <div class="resizer"></div></th>
                            <th data-column-id="cookie" data-type="string">Cookie <div class="resizer"></div></th>
                            <th data-column-id="time" data-type="date">Time <div class="resizer"></div></th>
                            <th data-column-id="date" data-type="date">Date <div class="resizer"></div></th>
                        </tr>
                    </thead>
                    <tbody id="req-list-body">
                        <!-- Rows injected here -->
                    </tbody>
                </table>
            </div>

            <div id="history-splitter" style="height: 2px; cursor: ns-resize; display: none; align-items: center; justify-content: center; font-size: 16px; line-height: 0; color: white; font-weight: bold; text-shadow: 0 0 2px rgba(0,0,0,0.5);">...</div>

            <div id="history-details-container">
                <input type="file" id="file-load-har" accept=".har" style="display: none;">
                <div id="history-details">
                    <div class="empty-state"><p>No request selected</p></div>
                </div>
            </div>
        </div>

        <!-- WebSockets Content -->
        <div id="content-proxy-websockets" class="tab-content" style="flex-direction: column;">
            <div style="padding: 8px 12px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; background: var(--bg-ter); flex-shrink: 0;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div class="switch-container">
                        <label for="chk-ws-intercept" style="cursor: pointer; font-size: 12px; color: var(--text); font-weight: 500; display: flex; align-items: center; gap: 6px;">
                            <span>Intercept messages</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="chk-ws-intercept">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div id="ws-intercept-status" style="padding: 4px 10px; border-radius: 4px;; font-size: 11px; font-weight: 600; background: var(--bg-input); color: var(--text-dim); display: none; border: 1px solid var(--border);">
                        <span id="ws-intercept-status-text">Inactive</span>
                    </div>
                </div>
                <div id="ws-intercept-controls" style="display: none; gap: 8px; align-items: center;">
                    <button id="btn-ws-forward" class="btn-approve csp-hover-button" style="flex: 0; padding: 6px 12px; border-radius: 4px;; font-weight: 600; font-size: 12px;">Forward</button>
                    <button id="btn-ws-drop" class="btn-reject csp-hover-button" style="flex: 0; padding: 6px 12px; border-radius: 4px;; font-weight: 600; font-size: 12px;">Drop</button>
                </div>
            </div>
            <div class="filter-box" style="display: flex; flex-direction: column; gap: 8px; background: var(--bg-ter); padding: 8px 10px; border-bottom: 1px solid var(--border);">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <input type="text" id="ws-filter-input" placeholder="Filter payload..." class="csp-focus-input"
                        style="flex: 1; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; color: var(--text); outline: none; font-size: 12px;">
                    <select id="ws-filter-direction" class="csp-focus-input"
                        style="background: var(--bg-input); color: var(--text); border: 1px solid var(--border); padding: 6px 10px; border-radius: 4px;; outline: none; font-size: 12px; cursor: pointer; min-width: 160px;">
                        <option value="all">All directions</option>
                        <option value="client">Client â†’ Server</option>
                        <option value="server">Server â†’ Client</option>
                    </select>
                    <button id="btn-clear-ws" class="csp-hover-button"
                        style="width: auto; padding: 6px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;; font-size: 12px; font-weight: 500;"
                        title="Clear WebSocket Messages">Clear</button>
                </div>
                <div style="display: flex; align-items: center; gap: 8px; padding-top: 6px; border-top: 1px solid var(--border);">
                    <div id="ws-message-count" style="padding: 4px 10px; border-radius: 4px;; font-size: 11px; font-weight: 600; background: var(--bg-input); color: var(--text-dim); border: 1px solid var(--border);">
                        <span id="ws-count-text">0 messages</span>
                    </div>
                </div>
            </div>
            <div class="history-table-wrapper">
                <table id="ws-table">
                    <thead>
                        <tr>
                            <th data-column-id="id" data-type="number" style="width: 50px;"># <div class="resizer"></div></th>
                            <th data-column-id="time" data-type="string" style="width: 80px;">Time <div class="resizer"></div></th>
                            <th data-column-id="direction" data-type="string" style="width: 120px;">Direction <div class="resizer"></div></th>
                            <th data-column-id="length" data-type="number" style="width: 70px;">Length <div class="resizer"></div></th>
                            <th data-column-id="payload" data-type="string">Payload (Preview) <div class="resizer"></div></th>
                            <th data-column-id="url" data-type="string" style="width: 100px;">URL <div class="resizer"></div></th>
                        </tr>
                    </thead>
                    <tbody id="ws-list-body">
                        <!-- Rows injected here -->
                    </tbody>
                </table>
            </div>
            <div id="ws-details"
                style="height: 150px; border-top: 1px solid var(--border); padding: 8px 10px; overflow: auto; font-family: 'Consolas', monospace; font-size: 12px; background: var(--bg-main); color: var(--text); position: relative; border-radius: 0 0 2px 0;">
                <div style="margin-bottom: 6px; padding-bottom: 6px; border-bottom: 1px solid var(--border); font-size: 12px; font-weight: 600; color: var(--text-dim);">Message payload</div>
                <textarea id="ws-message-editor" placeholder="Select a frame to view or edit payload..." class="csp-focus-input"
                    style="width: 100%; height: calc(100% - 32px); box-sizing: border-box; background: var(--bg-input); color: var(--text); border: 1px solid var(--border); border-radius: 4px;; resize: none; outline: none; font-family: 'Consolas', monospace; padding: 8px; font-size: 12px;"></textarea>
                <div id="ws-details-placeholder" class="empty-state" style="display: block; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none; opacity: 0.5;"></div>
            </div>
            <div id="ws-actions-bar" style="display: none; justify-content: flex-end; padding: 8px 10px; border-top: 1px solid var(--border); background: var(--bg-ter); gap: 8px;">
                <button id="btn-ws-send-repeater" class="btn-replay csp-hover-button"
                    style="flex: 0; padding: 6px 12px; border-radius: 4px;; font-weight: 600; font-size: 12px; background: var(--accent); color: white; border: none; cursor: pointer; box-shadow: none;">Send to Repeater</button>
            </div>
        </div>

        <!-- Match and Replace Content -->
        <div id="content-proxy-match-replace" class="tab-content" style="flex-direction: column; padding: 12px; box-sizing: border-box; overflow-y: auto;">
            <div style="padding: 8px 0; border-bottom: 1px solid var(--border); margin-bottom: 12px;">
                <h3 style="margin: 0; font-size: 13px; font-weight: 600; color: var(--text);">Match and Replace</h3>
            </div>
            
            <div style="background: var(--bg-ter); padding: 12px; border: 1px solid var(--border); border-radius: 4px;; margin-bottom: 12px;">
                <p style="margin: 0 0 8px 0; color: var(--text); font-size: 12px; line-height: 1.5;">
                    Automatically modify requests before they are sent. Use regex to match and replace headers or body.
                </p>
                <div style="background: var(--bg-main); border: 1px solid var(--border); border-left: 3px solid var(--accent); border-radius: 4px;; padding: 10px 12px; margin-top: 10px;">
                    <div style="color: var(--text); font-weight: 600; font-size: 12px; margin-bottom: 6px;">Examples</div>
                    <ul style="margin: 0; padding-left: 18px; font-size: 11px; color: var(--text-dim); line-height: 1.6;">
                        <li><strong>Match:</strong> <code style="background: var(--bg-input); padding: 2px 4px; border-radius: 4px;; font-family: 'Consolas', monospace;">User-Agent: .*</code> | <strong>Replace:</strong> <code style="background: var(--bg-input); padding: 2px 4px; border-radius: 4px;; font-family: 'Consolas', monospace;">User-Agent: CustomBot/1.0</code></li>
                        <li><strong>Match:</strong> <code style="background: var(--bg-input); padding: 2px 4px; border-radius: 4px;; font-family: 'Consolas', monospace;">admin</code> | <strong>Replace:</strong> <code style="background: var(--bg-input); padding: 2px 4px; border-radius: 4px;; font-family: 'Consolas', monospace;">hacker</code></li>
                    </ul>
                </div>
            </div>

            <div style="background: var(--bg-ter); padding: 12px; border: 1px solid var(--border); border-radius: 4px;; margin-bottom: 12px;">
                <h4 style="margin: 0 0 10px 0; color: var(--text); font-size: 12px; font-weight: 600;">Add rule</h4>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <div>
                        <label style="display: block; margin-bottom: 4px; font-size: 11px; color: var(--text); font-weight: 500;">Rule type</label>
                        <select id="mr-type" class="csp-focus-input"
                            style="width: 100%; background: var(--bg-input); color: var(--text); border: 1px solid var(--border); padding: 6px 10px; border-radius: 4px;; outline: none; font-size: 12px; cursor: pointer;">
                            <option value="req-header">Request header</option>
                            <option value="req-body">Request body</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 4px; font-size: 11px; color: var(--text); font-weight: 500;">Match pattern (regex)</label>
                        <input type="text" id="mr-match" placeholder="e.g. User-Agent: .* or admin" class="csp-focus-input"
                            style="width: 100%; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; box-sizing: border-box; border-radius: 4px;; outline: none; font-size: 12px; font-family: 'Consolas', monospace;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 4px; font-size: 11px; color: var(--text); font-weight: 500;">Replace with</label>
                        <input type="text" id="mr-replace" placeholder="e.g. User-Agent: CustomBot/1.0 or hacker" class="csp-focus-input"
                            style="width: 100%; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; box-sizing: border-box; border-radius: 4px;; outline: none; font-size: 12px; font-family: 'Consolas', monospace;">
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button id="btn-add-mr" class="csp-hover-button"
                            style="flex: 1; background: var(--accent); border: none; padding: 6px 12px; color: white; border-radius: 4px;; cursor: pointer; font-weight: 600; font-size: 12px; box-shadow: none;">Add rule</button>
                        <button id="btn-test-mr" class="csp-hover-button"
                            style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; cursor: pointer; font-weight: 500; font-size: 12px;">Test regex</button>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; padding: 8px 10px; background: var(--bg-ter); border-radius: 4px;; border: 1px solid var(--border);">
                <h4 style="margin: 0; color: var(--text); font-size: 12px; font-weight: 600;">Active rules</h4>
                <span id="mr-count" style="padding: 4px 10px; border-radius: 4px;; font-size: 11px; font-weight: 600; background: var(--bg-input); color: var(--text-dim); border: 1px solid var(--border);">0 rules</span>
            </div>
            
            <div id="mr-list" style="flex: 1; overflow-y: auto; border: 1px solid var(--border); border-radius: 4px;; background: var(--bg-main); min-height: 200px; padding: 10px; display: flex; flex-direction: column; gap: 8px;">
                <div class="empty-state" style="padding: 24px 16px; text-align: center; color: var(--text-dim); font-size: 12px;">No rules configured. Add a rule above to get started.</div>
            </div>
        </div>
    </div>

    <!-- Aba Search (Burp Suite Pro style) -->
    <div id="view-search" class="view-container" style="flex-direction: column; padding: 12px; box-sizing: border-box; gap: 10px; overflow-y: auto;">
        <div style="margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px solid var(--border);">
            <h3 style="margin: 0; font-size: 13px; font-weight: 600; color: var(--text);">Search</h3>
        </div>
        
        <div style="background: var(--bg-ter); padding: 10px; border-radius: 4px;; border: 1px solid var(--border);">
            <div id="global-search-controls" style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 180px; display: flex; flex-direction: column; gap: 4px;">
                    <label style="font-size: 11px; font-weight: 600; color: var(--text);">Search term</label>
                    <input type="text" id="global-search-input" placeholder="Enter search term or regex..." class="csp-focus-input"
                        style="width: 100%; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; font-size: 12px; box-sizing: border-box;">
                </div>
                <div style="display: flex; gap: 8px; align-items: center;">
                    <label style="display: flex; align-items: center; gap: 4px; font-size: 11px; color: var(--text); cursor: pointer; padding: 4px 8px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;;" for="global-search-regex">
                        <input type="checkbox" id="global-search-regex" style="cursor: pointer;">
                        <span>.*</span>
                        <span style="color: var(--text-dim);">Regex</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 4px; font-size: 11px; color: var(--text); cursor: pointer; padding: 4px 8px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;;" for="global-search-case">
                        <input type="checkbox" id="global-search-case" style="cursor: pointer;">
                        <span>Aa</span>
                        <span style="color: var(--text-dim);">Case</span>
                    </label>
                </div>
                <div style="display: flex; gap: 6px; align-items: center;">
                    <button id="btn-global-search" class="csp-hover-button"
                        style="background: var(--accent); color: white; padding: 6px 12px; border: none; cursor: pointer; font-weight: 600; font-size: 12px; border-radius: 4px;; box-shadow: none;">Search</button>
                    <button id="btn-global-search-prev" class="csp-hover-button" title="Previous result"
                        style="background: var(--bg-input); color: var(--text); border: 1px solid var(--border); padding: 6px 10px; cursor: pointer; border-radius: 4px;; font-size: 12px; font-weight: 600;">â†‘</button>
                    <button id="btn-global-search-next" class="csp-hover-button" title="Next result"
                        style="background: var(--bg-input); color: var(--text); border: 1px solid var(--border); padding: 6px 10px; cursor: pointer; border-radius: 4px;; font-size: 12px; font-weight: 600;">â†“</button>
                </div>
            </div>
            <div id="global-search-results-count" style="display: none; margin-top: 8px; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; font-size: 11px; color: var(--text); text-align: center;">
                <span style="font-weight: 600; color: var(--accent);">0</span> results found
            </div>
        </div>
        <div class="history-table-wrapper" style="border: 1px solid var(--border); border-radius: 4px;; flex: 1; min-height: 0; background: var(--bg-ter); overflow: hidden;">
            <div id="global-search-table-wrapper" style="overflow: auto; max-height: calc(100vh - 320px); width: 100%; position: relative;">
                <table id="global-search-results-table" style="min-width: 700px; border-collapse: separate; border-spacing: 0; width: 100%;">
                    <thead style="position: sticky; top: 0; z-index: 2; background: var(--bg-ter);">
                        <tr>
                            <th class="sticky-th" style="width: 70px; position: sticky; top: 0; background: var(--bg-ter); z-index: 2; padding: 6px 10px; font-size: 11px; font-weight: 600; color: var(--text); text-align: left; border-bottom: 1px solid var(--border);">Tool<span class="resizer"></span></th>
                            <th class="sticky-th" style="width: 40px; position: sticky; top: 0; background: var(--bg-ter); z-index: 2; padding: 6px 10px; font-size: 11px; font-weight: 600; color: var(--text); text-align: left; border-bottom: 1px solid var(--border);">ID<span class="resizer"></span></th>
                            <th class="sticky-th" style="width: 70px; position: sticky; top: 0; background: var(--bg-ter); z-index: 2; padding: 6px 10px; font-size: 11px; font-weight: 600; color: var(--text); text-align: left; border-bottom: 1px solid var(--border);">Method<span class="resizer"></span></th>
                            <th class="sticky-th" style="position: sticky; top: 0; background: var(--bg-ter); z-index: 2; padding: 6px 10px; font-size: 11px; font-weight: 600; color: var(--text); text-align: left; border-bottom: 1px solid var(--border);">URL<span class="resizer"></span></th>
                            <th class="sticky-th" style="width: 100px; position: sticky; top: 0; background: var(--bg-ter); z-index: 2; padding: 6px 10px; font-size: 11px; font-weight: 600; color: var(--text); text-align: left; border-bottom: 1px solid var(--border);">Location<span class="resizer"></span></th>
                            <th class="sticky-th" style="width: 30%; position: sticky; top: 0; background: var(--bg-ter); z-index: 2; padding: 6px 10px; font-size: 11px; font-weight: 600; color: var(--text); text-align: left; border-bottom: 1px solid var(--border);">Match snippet<span class="resizer"></span></th>
                        </tr>
                    </thead>
                    <tbody id="global-search-results-body">
                        <!-- Results will be injected here -->
                    </tbody>
                </table>
            </div>
            <div id="global-search-spinner" style="display:none; justify-content:center; align-items:center; position:absolute; left:0; top:0; width:100%; height:100%; background:rgba(43,43,43,0.7); z-index:10; border-radius: 4px;;">
                <div style="border: 4px solid #f3f3f3; border-top: 4px solid var(--accent); border-radius: 50%; width: 32px; height: 32px; animation: spin 1s linear infinite;"></div>
            </div>
        </div>
    </div>
    <style>
    #global-search-table-wrapper {
        overflow: auto;
        max-height: calc(100vh - 350px);
        width: 100%;
        position: relative;
    }
    #global-search-results-table thead th, #global-search-results-table thead {
        position: sticky;
        top: 0;
        background: var(--bg-ter);
        z-index: 2;
    }
    #global-search-results-table {
        border-collapse: separate;
        border-spacing: 0;
    }
    #global-search-results-table tbody tr {
        transition: background-color 0.2s ease;
    }
    #global-search-results-table tbody tr:hover {
        background-color: var(--bg-input);
    }
    #global-search-results-table tbody tr.current {
        background-color: rgba(var(--accent-rgb), 0.1);
        border-left: 3px solid var(--accent);
    }
    #global-search-results-table tbody td {
        padding: 6px 10px;
        font-size: 11px;
        color: var(--text);
        border-bottom: 1px solid var(--border);
    }
    .sticky-th {
        position: sticky !important;
        top: 0;
        background: var(--bg-ter);
        z-index: 2;
    }
    #global-search-input:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 2px rgba(var(--accent-rgb), 0.15);
    }
    #btn-global-search:hover {
        opacity: 0.9;
    }
    #btn-global-search-prev:hover, #btn-global-search-next:hover {
        background: var(--accent);
        color: white;
        border-color: var(--accent);
    }
    label[for="global-search-regex"]:hover, label[for="global-search-case"]:hover {
        background: var(--bg-sec);
        border-color: var(--accent);
    }
    label[for="global-search-regex"] input:checked + span,
    label[for="global-search-case"] input:checked + span {
        color: var(--accent);
        font-weight: 600;
    }
    @media (max-width: 900px) {
        #global-search-table-wrapper { overflow-x: auto; }
        #global-search-results-table { min-width: 600px; font-size: 10px; }
        #global-search-controls { flex-wrap: wrap; gap: 5px; }
        #global-search-input { min-width: 80px; }
    }
    @media (max-width: 600px) {
        #global-search-table-wrapper { overflow-x: auto; }
        #global-search-results-table { min-width: 400px; font-size: 9px; }
        #global-search-controls { flex-direction: column; align-items: stretch; }
        #global-search-input { width: 100%; }
    }
    .resizer {
        position: absolute;
        right: 0; top: 0; width: 5px; height: 100%;
        cursor: col-resize; user-select: none; z-index: 2;
    }
    .resizer:hover { background: var(--accent); opacity: 0.5; }
    </style>

    <!-- Aba Intruder -->
    <div id="view-intruder" class="view-container" style="flex-direction: column;">
        <!-- Barra de Abas do Intruder -->
        <div id="intruder-tabs-bar"
            style="display: flex; background: var(--bg-sec); border-bottom: 1px solid var(--border); overflow-x: auto; height: 28px; align-items: center; flex-shrink: 0;">
            <button id="btn-add-intruder-tab"
                style="background: transparent; border: none; color: var(--text); cursor: pointer; padding: 0 10px; font-weight: bold; font-size: 16px; height: 100%;">+</button>
        </div>

        <!-- Intruder Splash Screen -->
        <div id="intruder-splash-screen" style="display: none; flex: 1; align-items: center; justify-content: center; padding: 40px; text-align: center; background: var(--bg-main);">
            <div style="max-width: 600px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 20px; opacity: 0.8;">
                    <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                </svg>
                <h2 style="color: var(--text); margin: 0 0 12px 0; font-size: 24px; font-weight: 600;">Welcome to Intruder</h2>
                <p style="color: var(--text-dim); margin: 0 0 30px 0; font-size: 14px; line-height: 1.6;">
                    The Intruder allows you to automate customized attacks against web applications, 
                    systematically varying inputs to identify vulnerabilities and test application behavior.
                </p>
                <div style="background: var(--bg-sec); border: 1px solid var(--border); border-radius: 8px; padding: 20px; text-align: left; margin-bottom: 30px;">
                    <h3 style="color: var(--text); margin: 0 0 15px 0; font-size: 16px; font-weight: 600;">Getting Started:</h3>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <div style="display: flex; align-items: start; gap: 12px;">
                            <div style="width: 24px; height: 24px; border-radius: 50%; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; flex-shrink: 0;">1</div>
                            <div>
                                <div style="color: var(--text); font-weight: 500; margin-bottom: 4px;">Send a request from History, Repeater, or Sitemap</div>
                                <div style="color: var(--text-dim); font-size: 13px;">Right-click any request and select "Send to Intruder"</div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 12px;">
                            <div style="width: 24px; height: 24px; border-radius: 50%; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; flex-shrink: 0;">2</div>
                            <div>
                                <div style="color: var(--text); font-weight: 500; margin-bottom: 4px;">Mark payload positions with Â§</div>
                                <div style="color: var(--text-dim); font-size: 13px;">Select text in the request template and click "Add Â§" to mark where payloads should be injected</div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 12px;">
                            <div style="width: 24px; height: 24px; border-radius: 50%; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; flex-shrink: 0;">3</div>
                            <div>
                                <div style="color: var(--text); font-weight: 500; margin-bottom: 4px;">Configure payloads and start the attack</div>
                                <div style="color: var(--text-dim); font-size: 13px;">Choose payload type, define your payloads, and click "Start Attack" to begin fuzzing</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                    <button id="btn-create-first-intruder-tab" style="background: var(--accent); border: none; color: white; padding: 10px 24px; cursor: pointer; font-weight: 600; border-radius: 4px; font-size: 14px;">
                        Create New Tab
                    </button>
                    <button id="btn-go-history-from-intruder" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 10px 24px; cursor: pointer; font-weight: 500; border-radius: 4px; font-size: 14px;">
                        Go to History
                    </button>
                </div>
            </div>
        </div>

        <div class="tabs" id="intruder-main-tabs" style="display: none;">
            <div class="tab active" id="tab-intruder-config">Configuration</div>
            <div class="tab" id="tab-intruder-results">Results</div>
        </div>

        <!-- Attack controls (Burp-style): always visible when Intruder has content -->
        <div id="intruder-attack-controls" style="padding: 6px 10px; display: flex; align-items: center; flex-shrink: 0; gap: 8px; border-bottom: 1px solid var(--border); background: var(--bg-ter);">
            <button id="btn-start-intruder" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 6px 12px; border-radius: 4px;; cursor: pointer; font-weight: 600; font-size: 12px;">Start attack</button>
            <button id="btn-pause-intruder" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; cursor: pointer; font-size: 12px; display: none;">Pause</button>
        </div>

        <div id="intruder-editor-container" style="display: none; flex-direction: column; flex: 1; min-height: 0;">
        <div id="content-intruder-config" class="tab-content active" style="flex-direction: column; padding: 0; box-sizing: border-box; overflow: hidden;">
            <!-- Inner tabs: Burp-style Positions | Payloads | Options -->
            <div class="tabs inner-tabs" style="flex-shrink: 0; border-bottom: 1px solid var(--border); background: var(--bg-ter); padding: 0 8px;">
                <div class="tab inner-tab active" data-intruder-tab="positions">Positions</div>
                <div class="tab inner-tab" data-intruder-tab="payloads">Payloads</div>
                <div class="tab inner-tab" data-intruder-tab="settings">Options</div>
            </div>

            <div style="flex: 1; min-height: 0; position: relative;">
                <!-- Content for Positions -->
                <div id="intruder-positions" class="intruder-config-content active" style="padding: 12px; height: 100%; box-sizing: border-box; display: flex; flex-direction: column; position: absolute; width: 100%;">
                    <div style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                        <p style="margin: 0 0 8px 0; font-size: 12px; color: var(--text-dim);">Payload positions are marked with Â§. Click <strong>Add Â§</strong> to place markers; <strong>Clear Â§</strong> to remove all.</p>
                        <div class="editor-wrapper" style="flex: 1; margin-bottom: 8px; border: 1px solid var(--border); border-radius: 4px;; overflow: hidden;">
                            <div id="gutter-intruder" class="line-numbers">1</div>
                            <div id="editor-intruder" class="editor-raw" contenteditable="true" spellcheck="false"></div>
                        </div>
                        <div style="display: flex; gap: 6px; flex-shrink: 0; padding: 8px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;;">
                            <div id="intruder-markers-sniper" style="display: flex; gap: 6px;">
                                <button id="btn-intruder-mark" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 6px 12px; border-radius: 4px;; cursor: pointer; font-size: 12px; font-weight: 600;">Add Â§</button>
                            </div>
                            <div id="intruder-markers-cluster" style="display: none; gap: 6px;">
                                <button id="btn-intruder-mark-1" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 6px 12px; border-radius: 4px;; cursor: pointer; font-size: 12px; font-weight: 600;">Add Â§1</button>
                                <button id="btn-intruder-mark-2" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 6px 12px; border-radius: 4px;; cursor: pointer; font-size: 12px; font-weight: 600;">Add Â§2</button>
                            </div>
                            <button id="btn-intruder-clear-markers" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; cursor: pointer; font-size: 12px; margin-left: auto;" data-hover-special="true">Clear Â§</button>
                        </div>
                    </div>
                </div>

                <!-- Content for Payloads (Burp-style) -->
                <div id="intruder-payloads-config" class="intruder-config-content" style="padding: 12px; height: 100%; box-sizing: border-box; display: none; flex-direction: column; position: absolute; width: 100%;">
                    <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Payload type</label>
                    <select id="intruder-payload-type" class="csp-focus-input" style="background: var(--bg-input); color: var(--text); border: 1px solid var(--border); padding: 6px 10px; margin-bottom: 12px; outline: none; border-radius: 4px;; font-size: 12px; max-width: 280px;">
                        <option value="list">Simple list</option>
                        <option value="clusterbomb">Cluster bomb</option>
                        <option value="pitchfork">Pitchfork</option>
                        <option value="numbers">Numbers</option>
                        <option value="bruteforce">Character substitution</option>
                        <option value="ai">AI-generated</option>
                    </select>

                    <div style="flex: 1; min-height: 0; display: flex; flex-direction: column; overflow-y: auto; gap: 16px;">
                        <div id="config-simple-list" style="display: flex; flex-direction: column; flex: 1; min-height: 0; background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
                            <label style="margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Payload list [Simple list]</label>
                            <textarea id="intruder-payloads" style="flex: 1; white-space: pre; overflow: auto; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; resize: none; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px;" class="csp-focus-input" placeholder="admin&#10;password&#10;123456"></textarea>
                        </div>
                        <div id="config-numbers" style="display: none; flex-direction: column; gap: 8px; background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
                            <div><label style="display: block; margin-bottom: 4px; font-size: 12px; font-weight: 600; color: var(--text);">From</label><input type="number" id="payload-num-from" value="0" class="csp-focus-input" style="width: 120px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px;"></div>
                            <div><label style="display: block; margin-bottom: 4px; font-size: 12px; font-weight: 600; color: var(--text);">To</label><input type="number" id="payload-num-to" value="10" class="csp-focus-input" style="width: 120px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px;"></div>
                            <div><label style="display: block; margin-bottom: 4px; font-size: 12px; font-weight: 600; color: var(--text);">Step</label><input type="number" id="payload-num-step" value="1" class="csp-focus-input" style="width: 120px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px;"></div>
                        </div>
                        <div id="config-bruteforce" style="display: none; flex-direction: column; gap: 8px; background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
                            <div><label style="display: block; margin-bottom: 4px; font-size: 12px; font-weight: 600; color: var(--text);">Character set</label><input type="text" id="payload-bf-chars" value="abcdefghijklmnopqrstuvwxyz0123456789" class="csp-focus-input" style="width: 100%; max-width: 320px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px;"></div>
                            <div><label style="display: block; margin-bottom: 4px; font-size: 12px; font-weight: 600; color: var(--text);">Min length</label><input type="number" id="payload-bf-min" value="1" class="csp-focus-input" style="width: 80px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px;"></div>
                            <div><label style="display: block; margin-bottom: 4px; font-size: 12px; font-weight: 600; color: var(--text);">Max length</label><input type="number" id="payload-bf-max" value="2" class="csp-focus-input" style="width: 80px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px;"></div>
                        </div>
                        <div id="config-ai" style="display: none; flex-direction: column; gap: 8px; background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
                            <div><label style="display: block; margin-bottom: 4px; font-size: 12px; font-weight: 600; color: var(--text);">Attack context</label><textarea id="payload-ai-context" class="csp-focus-input" style="width: 100%; height: 80px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px; resize: vertical;" placeholder="e.g. Generate XSS payloads..."></textarea></div>
                            <div><label style="display: block; margin-bottom: 4px; font-size: 12px; font-weight: 600; color: var(--text);">Number of payloads</label><input type="number" id="payload-ai-count" value="20" class="csp-focus-input" style="width: 80px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px;"></div>
                        </div>
                        <div id="config-cluster-bomb" style="display: none; flex-direction: column; flex: 1; gap: 8px; min-height: 0;">
                            <div style="flex: 1; display: flex; flex-direction: column; background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
                                <label style="margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Payload set 1 (Â§1)</label>
                                <textarea id="intruder-payloads-1" class="csp-focus-input" style="flex: 1; white-space: pre; overflow: auto; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; resize: none; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px; min-height: 120px;"></textarea>
                            </div>
                            <div style="flex: 1; display: flex; flex-direction: column; background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
                                <label style="margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Payload set 2 (Â§2)</label>
                                <textarea id="intruder-payloads-2" class="csp-focus-input" style="flex: 1; white-space: pre; overflow: auto; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; resize: none; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px; min-height: 120px;"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content for Options (Burp-style) -->
                <div id="intruder-settings" class="intruder-config-content" style="padding: 12px; height: 100%; box-sizing: border-box; display: none; flex-direction: column; gap: 12px; position: absolute; width: 100%; overflow-y: auto;">
                    <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
                        <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Grep - Match</label>
                        <input type="text" id="intruder-grep" placeholder="String or regex to flag responses" class="csp-focus-input" style="width: 100%; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; box-sizing: border-box; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px;">
                        <p style="margin: 4px 0 0 0; font-size: 11px; color: var(--text-dim);">Responses containing this are highlighted in the results table.</p>
                    </div>
                    <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
                        <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Grep - Extract</label>
                        <input type="text" id="intruder-extract" placeholder="Regex with capture group, e.g. token=([a-z0-9]+)" class="csp-focus-input" style="width: 100%; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; box-sizing: border-box; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px;">
                        <p style="margin: 4px 0 0 0; font-size: 11px; color: var(--text-dim);">Extract values from response body into the Extract column.</p>
                    </div>
                    <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
                        <label for="intruder-delay" style="display: block; margin-bottom: 4px; font-size: 12px; font-weight: 600; color: var(--text);">Request delay (ms)</label>
                        <input type="number" id="intruder-delay" value="50" class="csp-focus-input" style="width: 100px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px;">
                        <p style="margin: 4px 0 0 0; font-size: 11px; color: var(--text-dim);">Throttle: delay between each request.</p>
                        <label style="display: inline-flex; align-items: center; gap: 6px; font-size: 12px; color: var(--text); cursor: pointer; user-select: none; margin-top: 8px;">
                            <input type="checkbox" id="intruder-encode-url" style="margin: 0;">
                            <span>URL-encode payloads</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div id="content-intruder-results" class="tab-content" style="flex-direction: column;">
            <div style="padding: 6px 10px; border-bottom: 1px solid var(--border); background: var(--bg-ter); flex-shrink: 0; display: flex; flex-direction: column; gap: 6px;">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <div id="intruder-status" style="padding: 4px 8px; border-radius: 4px;; font-size: 11px; font-weight: 600; background: var(--bg-input); color: var(--text-dim); border: 1px solid var(--border); display: inline-flex; align-items: center; gap: 4px; white-space: nowrap;">Ready</div>
                    <button id="btn-intruder-analyze-ai" class="csp-hover-button" style="padding: 5px 10px; font-size: 11px; background: var(--accent); border: none; color: white; border-radius: 4px;; cursor: pointer; font-weight: 600;">Analyze with AI</button>
                </div>
                <div id="intruder-progress-container" style="width: 100%; height: 6px; background: var(--bg-input); border-radius: 4px;; overflow: hidden; border: 1px solid var(--border); display: none;">
                    <div id="intruder-progress-bar" style="height: 100%; background: var(--accent); width: 0%; transition: width 0.2s ease; border-radius: 4px;; min-width: 2px;"></div>
                </div>
            </div>
            <!-- Multi-selection toolbar for Intruder Results -->
            <div id="intruder-multi-select-toolbar" style="display: none; padding: 8px 12px; background: var(--bg-sec); border-bottom: 1px solid var(--border); gap: 8px; align-items: center; flex-wrap: wrap;">
                <span id="intruder-selection-count" style="font-size: 12px; color: var(--text); font-weight: 600;">0 selected</span>
            </div>
            <div class="history-table-wrapper" style="flex: 1; border: none;">
                <table id="intruder-results-table">
                    <thead>
                        <tr>
                            <th data-column-id="id" data-type="number"># <div class="resizer"></div></th>
                            <th data-column-id="payload" data-type="string">Payload <div class="resizer"></div></th>
                            <th data-column-id="status" data-type="number">Status <div class="resizer"></div></th>
                            <th data-column-id="length" data-type="number">Length <div class="resizer"></div></th>
                            <th data-column-id="match" data-type="string">Match <div class="resizer"></div></th>
                            <th data-column-id="extract" data-type="string">Extract <div class="resizer"></div></th>
                            <th data-column-id="time" data-type="string">Time <div class="resizer"></div></th>
                        </tr>
                    </thead>
                    <tbody id="intruder-results-body">
                    </tbody>
                </table>
            </div>

            <div id="intruder-splitter" style="height: 5px; cursor: ns-resize; display: none;"></div>
            <div id="intruder-details-container"
                style="display: none; flex-direction: column; height: 300px; border-top: 1px solid var(--border); position: relative;">
                <button id="btn-close-intruder-details"
                    style="position: absolute; right: 5px; top: 5px; z-index: 100; background: transparent; border: none; color: var(--text); font-size: 14px; cursor: pointer; padding: 5px;"
                    title="Fechar Detalhes">âœ•</button>
                <div id="intruder-details"
                    style="flex: 1; display: flex; flex-direction: column; overflow: hidden;"></div>
                <div id="intruder-ai-analysis-container"
                    style="display: none; flex-direction: column; flex: 1; min-height: 0; border-top: 1px solid var(--border); margin-top: 10px; padding-top: 10px; overflow: hidden;">
                    <h4 style="margin-top: 0; margin-bottom: 10px; color: var(--accent); flex-shrink: 0;">AI Anomaly Analysis</h4>
                    <div id="intruder-ai-analysis-content" class="ai-analysis-content" style="flex: 1; min-height: 0; overflow-y: auto; overflow-x: hidden; padding: 10px; background: var(--bg-main); border: 1px solid var(--border); border-radius: 4px; max-height: 100%;">
                        <div class="empty-state" style="position:relative; top:auto; left:auto; transform:none;">Clique em "Analyze Results with AI"</div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>

    <!-- Aba Comparer (Burp Suite Pro style) -->
    <div id="view-comparer" class="view-container" style="flex-direction: column; padding: 0; box-sizing: border-box; overflow: hidden; position: relative;">
        <div style="padding: 8px 12px; border-bottom: 1px solid var(--border); background: var(--bg-ter); flex-shrink: 0; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px;">
            <span style="font-size: 12px; font-weight: 600; color: var(--text);">Comparer</span>
            <div style="display: flex; gap: 6px; align-items: center;">
                <button id="btn-compare" style="background: var(--accent); border: none; color: white; padding: 6px 12px; cursor: pointer; font-weight: 600; font-size: 12px; border-radius: 4px;;">Compare</button>
                <button id="btn-clear-comparer" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; cursor: pointer; font-size: 12px; border-radius: 4px;;">Clear all</button>
            </div>
            <div id="comparer-stats" style="display: none; padding: 6px 10px; background: var(--bg-main); border-radius: 4px;; font-size: 11px; color: var(--text-dim); border: 1px solid var(--border);">
                <span id="comparer-stats-text"></span>
            </div>
        </div>

        <!-- Comparison Panes Container (with vertical splitter) -->
        <div id="comparer-panes-container" style="display: flex; gap: 0; flex: 1; min-height: 0; overflow: hidden; position: relative;">
            <!-- Left Pane -->
            <div id="comparer-left-pane" style="flex: 1; display: flex; flex-direction: column; background: var(--bg-main); position: relative; min-width: 150px; max-width: calc(100% - 10px);">
                <div style="padding: 6px 10px; background: var(--bg-ter); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; flex-shrink: 0;">
                    <label style="font-weight: 600; color: var(--text); font-size: 12px; margin: 0;">Request / Response 1</label>
                    <div style="display: flex; gap: 4px; align-items: center;">
                        <span id="comparer-left-stats" style="font-size: 11px; color: var(--text-dim); padding: 2px 6px; background: var(--bg-input); border-radius: 4px;;">0 chars</span>
                        <button id="btn-clear-left" class="comparer-action-btn" title="Clear" style="background: transparent; border: none; color: var(--text-dim); cursor: pointer; padding: 4px 8px; font-size: 11px; border-radius: 4px;;">Clear</button>
                        <button id="btn-copy-left" class="comparer-action-btn" title="Copy" style="background: transparent; border: none; color: var(--text-dim); cursor: pointer; padding: 4px 8px; font-size: 11px; border-radius: 4px;;">Copy</button>
                    </div>
                </div>
                <textarea id="comparer-left" style="flex: 1; white-space: pre; font-family: Consolas, monospace; font-size: 12px; padding: 10px 12px; background: var(--bg-main); color: var(--text); border: none; outline: none; resize: none; line-height: 1.5; tab-size: 4; overflow: auto; scrollbar-width: thin; scrollbar-color: var(--border) transparent;"></textarea>
            </div>

            <!-- Vertical Splitter -->
            <div id="comparer-vertical-splitter" style="width: 4px; background: var(--border); cursor: col-resize; flex-shrink: 0; position: relative;">
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--bg-ter); padding: 6px; border-radius: 4px;; border: 1px solid var(--border); color: var(--text-dim); font-size: 14px; cursor: pointer; pointer-events: auto;" id="btn-swap-comparer" title="Swap sides">â‡„</div>
            </div>

            <!-- Right Pane -->
            <div id="comparer-right-pane" style="flex: 1; display: flex; flex-direction: column; background: var(--bg-main); position: relative; min-width: 150px; max-width: calc(100% - 10px);">
                <div style="padding: 6px 10px; background: var(--bg-ter); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; flex-shrink: 0;">
                    <label style="font-weight: 600; color: var(--text); font-size: 12px; margin: 0;">Request / Response 2</label>
                    <div style="display: flex; gap: 4px; align-items: center;">
                        <span id="comparer-right-stats" style="font-size: 11px; color: var(--text-dim); padding: 2px 6px; background: var(--bg-input); border-radius: 4px;;">0 chars</span>
                        <button id="btn-clear-right" class="comparer-action-btn" title="Clear" style="background: transparent; border: none; color: var(--text-dim); cursor: pointer; padding: 4px 8px; font-size: 11px; border-radius: 4px;;">Clear</button>
                        <button id="btn-copy-right" class="comparer-action-btn" title="Copy" style="background: transparent; border: none; color: var(--text-dim); cursor: pointer; padding: 4px 8px; font-size: 11px; border-radius: 4px;;">Copy</button>
                    </div>
                </div>
                <textarea id="comparer-right" style="flex: 1; white-space: pre; font-family: Consolas, monospace; font-size: 12px; padding: 10px 12px; background: var(--bg-main); color: var(--text); border: none; outline: none; resize: none; line-height: 1.5; tab-size: 4; overflow: auto; scrollbar-width: thin; scrollbar-color: var(--border) transparent;"></textarea>
            </div>
        </div>

        <!-- Horizontal Splitter -->
        <div id="comparer-horizontal-splitter" style="height: 4px; cursor: ns-resize; background: var(--border); flex-shrink: 0;"></div>

        <!-- Comparison results -->
        <div id="comparer-results-container" style="display: flex; flex-direction: column; flex: 1; min-height: 0; overflow: hidden;">
            <div style="border-top: 1px solid var(--border); background: var(--bg-ter); flex-shrink: 0; padding: 6px 10px; display: flex; align-items: center; justify-content: space-between;">
                <span style="font-weight: 600; color: var(--text); font-size: 12px;">Comparison</span>
                <button id="btn-toggle-sync-scroll" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 4px 8px; cursor: pointer; font-size: 11px; border-radius: 4px;;" title="Synchronized scrolling">Sync scroll</button>
            </div>
            <div id="comparer-result" style="flex: 1; background: var(--bg-main); overflow: auto; padding: 10px 12px; font-family: Consolas, monospace; font-size: 12px; line-height: 1.5; min-height: 0;">
                <div class="empty-state" style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 24px; text-align: center; color: var(--text-dim);">
                    <p style="font-size: 12px; margin: 0; color: var(--text-dim);">Load data into both panels and click <strong style="color: var(--accent);">Compare</strong> to see differences.</p>
                    <p style="font-size: 11px; margin: 6px 0 0 0; color: var(--text-dim); opacity: 0.8;">Right-click a request in Proxy history and choose Send to Comparer (Left/Right).</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Aba Decoder (Burp Suite Pro style) -->
    <div id="view-decoder" class="view-container" style="flex-direction: column;">
        <div class="tabs">
            <div class="tab active" id="tab-dec-jwt">JWT</div>
            <div class="tab" id="tab-dec-base64">Base64</div>
            <div class="tab" id="tab-dec-url">URL</div>
            <div class="tab" id="tab-dec-smart">Smart</div>
        </div>

        <!-- JWT Sub-tab -->
        <div id="content-dec-jwt" class="tab-content active" style="padding: 12px; box-sizing: border-box; overflow-y: auto;">
            <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid var(--border);">
                <h3 style="margin: 0; font-size: 13px; font-weight: 600; color: var(--text);">JWT</h3>
            </div>

            <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); margin-bottom: 12px;">
                <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Encoded token</label>
                <textarea id="jwt-input" class="csp-focus-input"
                    style="width: 100%; height: 80px; margin-bottom: 8px; font-family: Consolas, monospace; font-size: 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; border-radius: 4px;; resize: vertical; box-sizing: border-box;"
                    placeholder="Paste JWT here (header.payload.signature)"></textarea>
                <div style="display: flex; gap: 8px;">
                    <button id="btn-jwt-decode" class="csp-hover-button" style="flex: 1; background: var(--accent); border: none; color: white; padding: 6px 12px; cursor: pointer; font-weight: 600; font-size: 12px; border-radius: 4px;; box-shadow: none;">Decode</button>
                    <button id="btn-jwt-encode" class="csp-hover-button" style="flex: 1; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; cursor: pointer; font-weight: 500; font-size: 12px; border-radius: 4px;;">Encode</button>
                    <button id="btn-jwt-copy" class="csp-hover-button" style="flex: 1; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; cursor: pointer; font-weight: 500; font-size: 12px; border-radius: 4px;;">Copy</button>
                </div>
            </div>

            <div id="jwt-analysis" style="display: none; padding: 10px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; margin-bottom: 12px;">
                <h4 style="margin: 0 0 8px 0; color: var(--text); font-size: 12px; font-weight: 600;">Token analysis</h4>
                <div id="jwt-analysis-content" style="font-size: 11px; color: var(--text); line-height: 1.5;"></div>
            </div>

            <div style="display: flex; gap: 10px; flex: 1; min-height: 200px; margin-bottom: 12px;">
                <div style="flex: 1; display: flex; flex-direction: column; background: var(--bg-ter); padding: 10px; border-radius: 4px;; border: 1px solid var(--border);">
                    <label style="color: #fb015b; font-weight: 600; margin-bottom: 6px; font-size: 12px;">Header</label>
                    <textarea id="jwt-header" class="csp-focus-input"
                        style="flex: 1; color: #fb015b; font-family: Consolas, monospace; font-size: 11px; background: var(--bg-input); border: 1px solid var(--border); padding: 8px; border-radius: 4px;; resize: none;"></textarea>
                </div>
                <div style="flex: 1; display: flex; flex-direction: column; background: var(--bg-ter); padding: 10px; border-radius: 4px;; border: 1px solid var(--border);">
                    <label style="color: #ff6633; font-weight: 600; margin-bottom: 6px; font-size: 12px;">Payload</label>
                    <textarea id="jwt-payload" class="csp-focus-input"
                        style="flex: 1; color: #ff6633; font-family: Consolas, monospace; font-size: 11px; background: var(--bg-input); border: 1px solid var(--border); padding: 8px; border-radius: 4px;; resize: none;"></textarea>
                </div>
            </div>

            <div style="background: var(--bg-ter); padding: 10px; border-radius: 4px;; border: 1px solid var(--border); margin-bottom: 12px;">
                <label style="color: #00b9f1; font-weight: 600; margin-bottom: 6px; font-size: 12px; display: block;">Signature (Hex/Base64)</label>
                <input type="text" id="jwt-signature" readonly class="csp-focus-input"
                    style="width: 100%; box-sizing: border-box; background: var(--bg-input); border: 1px solid var(--border); color: #00b9f1; padding: 6px 8px; font-family: Consolas, monospace; font-size: 11px; border-radius: 4px;;">
            </div>

            <!-- JWT Attacks Section -->
            <div style="background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; padding: 12px; margin-bottom: 12px;">
                <h4 style="margin: 0 0 10px 0; color: var(--text); font-size: 12px; font-weight: 600;">Attack vectors</h4>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                    <button id="btn-jwt-none-attack" class="jwt-attack-btn csp-hover-button" style="padding: 10px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;; text-align: left; font-size: 11px;">
                        <div style="font-weight: 600; margin-bottom: 4px; color: var(--accent);">None algorithm</div>
                        <div style="font-size: 10px; color: var(--text-dim);">Remove signature, set alg="none"</div>
                    </button>
                    <button id="btn-jwt-blank-password" class="jwt-attack-btn csp-hover-button" style="padding: 10px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;; text-align: left; font-size: 11px;">
                        <div style="font-weight: 600; margin-bottom: 4px; color: var(--accent);">Blank password</div>
                        <div style="font-size: 10px; color: var(--text-dim);">Sign with empty secret</div>
                    </button>
                    <button id="btn-jwt-weak-keys" class="jwt-attack-btn csp-hover-button" style="padding: 10px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;; text-align: left; font-size: 11px;">
                        <div style="font-weight: 600; margin-bottom: 4px; color: var(--accent);">Weak secret keys</div>
                        <div style="font-size: 10px; color: var(--text-dim);">Brute force common secrets</div>
                    </button>
                    <button id="btn-jwt-key-confusion" class="jwt-attack-btn csp-hover-button" style="padding: 10px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;; text-align: left; font-size: 11px;">
                        <div style="font-weight: 600; margin-bottom: 4px; color: var(--accent);">Key confusion (RS256â†’HS256)</div>
                        <div style="font-size: 10px; color: var(--text-dim);">Algorithm confusion</div>
                    </button>
                    <button id="btn-jwt-kid-injection" class="jwt-attack-btn csp-hover-button" style="padding: 10px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;; text-align: left; font-size: 11px;">
                        <div style="font-weight: 600; margin-bottom: 4px; color: var(--accent);">KID injection</div>
                        <div style="font-size: 10px; color: var(--text-dim);">SQL/Path in kid header</div>
                    </button>
                    <button id="btn-jwt-jku-injection" class="jwt-attack-btn csp-hover-button" style="padding: 10px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;; text-align: left; font-size: 11px;">
                        <div style="font-weight: 600; margin-bottom: 4px; color: var(--accent);">JKU/X5U injection</div>
                        <div style="font-size: 10px; color: var(--text-dim);">Point to attacker key</div>
                    </button>
                </div>
                <div id="jwt-attack-results" style="display: none; margin-top: 10px; padding: 8px 10px; background: var(--bg-main); border: 1px solid var(--border); border-radius: 4px;;">
                    <h5 style="margin: 0 0 6px 0; color: var(--text); font-size: 11px;">Attack results</h5>
                    <div id="jwt-attack-results-content" style="font-size: 10px; font-family: monospace; color: var(--text-dim); max-height: 160px; overflow-y: auto;"></div>
                </div>
            </div>

            <!-- JWT Signing Section -->
            <div style="background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; padding: 12px; margin-bottom: 12px;">
                <h4 style="margin: 0 0 10px 0; color: var(--text); font-size: 12px; font-weight: 600;">Sign JWT</h4>
                <label style="font-size: 11px; font-weight: 600; color: var(--text); display: block; margin-bottom: 4px;">Algorithm</label>
                <select id="jwt-sign-algorithm" class="csp-focus-input"
                    style="width: 100%; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); margin-bottom: 8px; border-radius: 4px;; font-size: 12px; cursor: pointer;">
                    <option value="HS256">HMAC SHA-256 (HS256)</option>
                    <option value="HS384">HMAC SHA-384 (HS384)</option>
                    <option value="HS512">HMAC SHA-512 (HS512)</option>
                    <option value="none">None (No Signature)</option>
                </select>
                <label style="font-size: 11px; font-weight: 600; color: var(--text); display: block; margin-bottom: 4px;">Secret key</label>
                <input type="text" id="jwt-sign-secret" placeholder="Enter secret key" class="csp-focus-input"
                    style="width: 100%; box-sizing: border-box; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); margin-bottom: 8px; font-family: Consolas, monospace; border-radius: 4px;; font-size: 12px;">
                <button id="btn-jwt-sign" class="csp-hover-button"
                    style="width: 100%; background: var(--accent); border: none; color: white; padding: 6px 12px; cursor: pointer; font-weight: 600; font-size: 12px; border-radius: 4px;; box-shadow: none;">Sign & generate token</button>
            </div>

            <div style="font-size: 11px; color: var(--text-dim); padding: 8px 10px; background: var(--bg-ter); border-radius: 4px;; border-left: 3px solid var(--accent); line-height: 1.5;">
                Editing Header or Payload updates the encoded token. Use Sign to re-sign with a secret key.
            </div>
        </div>

        <!-- Base64 Sub-tab -->
        <div id="content-dec-base64" class="tab-content" style="padding: 12px; box-sizing: border-box;">
            <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid var(--border);">
                <h3 style="margin: 0; font-size: 13px; font-weight: 600; color: var(--text);">Base64</h3>
            </div>
            <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); margin-bottom: 12px;">
                <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Input</label>
                <textarea id="b64-input" class="csp-focus-input"
                    style="width: 100%; height: 100px; margin-bottom: 8px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px; resize: vertical; box-sizing: border-box;"></textarea>
                <div style="display: flex; gap: 8px;">
                    <button id="btn-enc-base64" class="csp-hover-button" style="flex: 1; background: var(--accent); border: none; color: white; padding: 6px 12px; cursor: pointer; font-weight: 600; font-size: 12px; border-radius: 4px;; box-shadow: none;">Encode</button>
                    <button id="btn-dec-base64" class="csp-hover-button" style="flex: 1; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; cursor: pointer; font-weight: 500; font-size: 12px; border-radius: 4px;;">Decode</button>
                </div>
            </div>
            <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); flex: 1; display: flex; flex-direction: column; min-height: 0;">
                <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Output</label>
                <textarea id="b64-output" class="csp-focus-input"
                    style="flex: 1; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px; resize: none; min-height: 80px;"></textarea>
            </div>
        </div>

        <!-- URL Sub-tab -->
        <div id="content-dec-url" class="tab-content" style="padding: 12px; box-sizing: border-box;">
            <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid var(--border);">
                <h3 style="margin: 0; font-size: 13px; font-weight: 600; color: var(--text);">URL</h3>
            </div>
            <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Input</label>
            <textarea id="url-input" class="csp-focus-input" style="width: 100%; height: 80px; margin-bottom: 8px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; border-radius: 4px;; font-size: 12px; box-sizing: border-box;"></textarea>
            <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                <button id="btn-enc-url" class="csp-hover-button" style="flex: 1; background: var(--accent); border: none; color: white; padding: 6px 12px; font-size: 12px; font-weight: 600; border-radius: 4px;; cursor: pointer;">Encode</button>
                <button id="btn-dec-url" class="csp-hover-button" style="flex: 1; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; font-size: 12px; border-radius: 4px;; cursor: pointer;">Decode</button>
            </div>
            <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Output</label>
            <textarea id="url-output" class="csp-focus-input" style="width: 100%; height: 80px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; border-radius: 4px;; font-size: 12px; box-sizing: border-box;"></textarea>
        </div>

        <!-- Smart Sub-tab -->
        <div id="content-dec-smart" class="tab-content" style="padding: 12px; box-sizing: border-box;">
            <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid var(--border);">
                <h3 style="margin: 0; font-size: 13px; font-weight: 600; color: var(--text);">Smart decoder</h3>
            </div>
            <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); margin-bottom: 12px;">
                <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Input</label>
                <textarea id="smart-input" class="csp-focus-input"
                    style="width: 100%; height: 100px; margin-bottom: 8px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px; resize: vertical; box-sizing: border-box;"></textarea>
                <button id="btn-smart-decode" class="csp-hover-button"
                    style="width: 100%; background: var(--accent); border: none; color: white; padding: 6px 12px; cursor: pointer; font-weight: 600; font-size: 12px; border-radius: 4px;; box-shadow: none;">Smart decode (recursive)</button>
            </div>
            <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); flex: 1; display: flex; flex-direction: column; min-height: 0; margin-bottom: 10px;">
                <label style="display: block; margin-bottom: 6px; font-size: 12px; font-weight: 600; color: var(--text);">Output</label>
                <textarea id="smart-output" class="csp-focus-input"
                    style="flex: 1; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px; border-radius: 4px;; font-family: Consolas, monospace; font-size: 12px; resize: none; min-height: 160px;"></textarea>
            </div>
            <div id="smart-steps" style="font-size: 11px; color: var(--text-dim); padding: 8px 10px; background: var(--bg-ter); border-radius: 4px;; border: 1px solid var(--border); line-height: 1.5;"></div>
        </div>
    </div>

    <!-- Aba Repeater (Burp Suite Pro style) -->
    <div id="view-repeater" class="view-container" style="flex-direction: column;">
        <div id="repeater-tabs-bar"
            style="display: flex; background: var(--bg-ter); border-bottom: 1px solid var(--border); overflow-x: auto; height: 26px; align-items: center; flex-shrink: 0; padding: 0 6px;">
            <button id="btn-add-rep-tab"
                style="background: transparent; border: none; color: var(--text); cursor: pointer; padding: 0 8px; font-weight: 600; font-size: 14px; height: 100%;">+</button>
        </div>
        <div style="padding: 6px 10px; border-bottom: 1px solid var(--border); display: flex; gap: 8px; align-items: center; background: var(--bg-ter); flex-wrap: wrap;">
            <button id="rep-back" class="csp-hover-button" style="width: 28px; height: 24px; padding: 0; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; color: var(--text); cursor: pointer; font-size: 12px;" disabled>&lt;</button>
            <span id="rep-count" style="display: flex; align-items: center; font-size: 11px; color: var(--text-dim); min-width: 28px; justify-content: center;">0/0</span>
            <button id="rep-fwd" class="csp-hover-button" style="width: 28px; height: 24px; padding: 0; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; color: var(--text); cursor: pointer; font-size: 12px;" disabled>&gt;</button>
            <div style="width: 1px; background: var(--border); margin: 0 4px; align-self: stretch;"></div>
            <div class="switch-container" title="Follow Redirects">
                <label for="rep-follow-redirects" style="cursor: pointer; font-size: 11px; color: var(--text); white-space: nowrap;">Follow</label>
                <label class="switch"><input type="checkbox" id="rep-follow-redirects" checked><span class="slider"></span></label>
            </div>
            <div class="switch-container" title="Ignore SSL Certificate Errors">
                <label for="rep-ignore-ssl" style="cursor: pointer; font-size: 11px; color: var(--text); white-space: nowrap;">SSL</label>
                <label class="switch"><input type="checkbox" id="rep-ignore-ssl"><span class="slider"></span></label>
            </div>
            <div class="switch-container" title="Disable Cache">
                <label for="rep-disable-cache" style="cursor: pointer; font-size: 11px; color: var(--text); white-space: nowrap;">Cache</label>
                <label class="switch"><input type="checkbox" id="rep-disable-cache"><span class="slider"></span></label>
            </div>
            <div class="switch-container" title="Capture Request Timing">
                <label for="rep-capture-timing" style="cursor: pointer; font-size: 11px; color: var(--text); white-space: nowrap;">Timing</label>
                <label class="switch"><input type="checkbox" id="rep-capture-timing" checked><span class="slider"></span></label>
            </div>
            <button id="repeater-send" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 6px 16px; cursor: pointer; font-weight: 600; font-size: 12px; border-radius: 4px;; box-shadow: none;">Send</button>
            <button id="repeater-send-intruder" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; cursor: pointer; font-size: 12px; border-radius: 4px;;" title="Send this request to Intruder">Intruder</button>
            <div class="switch-container" title="Toggle HTTP/HTTPS" style="margin-left: auto;">
                <span style="font-size: 11px; color: var(--text-dim);">HTTP</span>
                <label class="switch"><input type="checkbox" id="rep-protocol-toggle" checked><span class="slider"></span></label>
                <span style="font-size: 11px; color: var(--text-dim);">HTTPS</span>
            </div>
        </div>
        <div style="padding: 4px 10px; background: var(--bg-ter); border-bottom: 1px solid var(--border);">
            <input id="repeater-url" type="text" placeholder="URL" class="csp-focus-input"
                style="width: 100%; box-sizing: border-box; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; color: var(--text); padding: 6px 10px; font-size: 12px; font-family: Consolas, monospace;">
        </div>
        
        <!-- Repeater Splash Screen -->
        <div id="repeater-splash-screen" style="display: none; flex: 1; align-items: center; justify-content: center; padding: 24px; text-align: center; background: var(--bg-main);">
            <div style="max-width: 520px;">
                <h2 style="color: var(--text); margin: 0 0 8px 0; font-size: 18px; font-weight: 600;">Repeater</h2>
                <p style="color: var(--text-dim); margin: 0 0 20px 0; font-size: 13px; line-height: 1.5;">
                    Manually modify and resend HTTP requests to test how the server responds.
                </p>
                <div style="background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; padding: 16px; text-align: left; margin-bottom: 20px;">
                    <h3 style="color: var(--text); margin: 0 0 10px 0; font-size: 13px; font-weight: 600;">How it works</h3>
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <div style="width: 20px; height: 20px; border-radius: 4px;; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; flex-shrink: 0;">1</div>
                            <div>
                                <div style="color: var(--text); font-weight: 500; margin-bottom: 2px; font-size: 12px;">Send a request from History or Sitemap</div>
                                <div style="color: var(--text-dim); font-size: 12px;">Right-click any request and select Send to Repeater</div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <div style="width: 20px; height: 20px; border-radius: 4px;; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; flex-shrink: 0;">2</div>
                            <div>
                                <div style="color: var(--text); font-weight: 500; margin-bottom: 2px; font-size: 12px;">Modify the request</div>
                                <div style="color: var(--text-dim); font-size: 12px;">Edit headers, parameters, or body</div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <div style="width: 20px; height: 20px; border-radius: 4px;; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; flex-shrink: 0;">3</div>
                            <div>
                                <div style="color: var(--text); font-weight: 500; margin-bottom: 2px; font-size: 12px;">Click Send to see the response</div>
                                <div style="color: var(--text-dim); font-size: 12px;">Analyze and iterate on your tests</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="display: flex; gap: 8px; justify-content: center; flex-wrap: wrap;">
                    <button id="btn-create-first-tab" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 8px 20px; cursor: pointer; font-weight: 600; border-radius: 4px;; font-size: 12px; box-shadow: none;">Create new tab</button>
                    <button id="btn-go-history-from-repeater" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 8px 20px; cursor: pointer; font-weight: 500; border-radius: 4px;; font-size: 12px;">Go to History</button>
                </div>
            </div>
        </div>
        
<div id="repeater-editor-container" class="editor-container" style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
    <div class="editor-top-controls" style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); background: var(--bg-ter); padding: 0 8px;">
        <div class="tabs" style="display: flex; border: none;">
            <div class="tab active" id="tab-rep-req">Request</div>
            <div class="tab" id="tab-rep-inspector">Inspector</div>
            <div class="tab" id="tab-rep-res">Response</div>
            <div class="tab" id="tab-rep-diff">Diff</div>
        </div>
    </div>
    <div id="content-rep-inspector" class="tab-content" style="overflow-y: auto; padding: 5px;">
        <!-- Inspector content will be injected here -->
    </div>
    <div id="content-rep-req" class="tab-content content-req-split active" style="padding: 0;">
        <div style="display: flex; flex-direction: column; height: 100%;">
            <div class="pane-header">Request</div>
            <div class="inner-content-wrapper inner-content-req-raw active" style="flex-grow: 1; min-height: 0; display: flex; flex-direction: column;">
                <div class="tabs inner-tabs" style="flex-shrink: 0; border-bottom: 1px solid var(--border); background: var(--bg-ter); display: flex; align-items: center; padding: 0 8px;">
                    <div class="tab inner-tab active" data-pane="req" data-view="raw">Raw</div>
                    <div class="tab inner-tab" data-pane="req" data-view="pretty">Pretty</div>
                    <div class="inner-editor-buttons" style="margin-left: auto; display: flex; gap: 4px;">
                        <button id="btn-split-view-repeater" class="csp-hover-button" style="width: auto; padding: 4px 8px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 4px;; color: var(--text); cursor: pointer; font-size: 11px;" title="Toggle Split View">Split</button>
                    </div>
                </div>
                <div class="editor-wrapper" style="border: none; margin-bottom: 0;">
                    <div id="gutter-rep-req" class="line-numbers">1</div>
                    <div id="repeater-request" class="editor-raw" contenteditable="true" spellcheck="false" style="background: var(--bg-main); color: var(--text);"></div>
                </div>
                <div id="editor-footer-req-repeater" style="display: flex; flex-direction: column; background: var(--bg-ter); border: 1px solid var(--border); border-top: none; font-size: 11px; flex-shrink: 0; border-radius: 0 0 2px 2px;">
                    <div id="editor-search-bar-req-repeater" style="display: flex; align-items: center; justify-content: flex-end; gap: 4px; padding: 4px 8px; background: var(--bg-ter); border-bottom: 1px solid var(--border);">
                        <input type="text" id="editor-search-input-req-repeater" placeholder="Find..." class="csp-focus-input" style="flex: 1; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 4px 8px; outline: none; border-radius: 4px;; font-size: 11px;">
                        <label style="display: flex; align-items: center; gap: 3px; cursor: pointer; user-select: none; color: var(--text-dim);"><input type="checkbox" id="editor-search-regex-req-repeater"> .*</label>
                        <label style="display: flex; align-items: center; gap: 3px; cursor: pointer; user-select: none; color: var(--text-dim);"><input type="checkbox" id="editor-search-case-req-repeater"> Aa</label>
                        <span id="editor-search-count-req-repeater" style="color: var(--text-dim); min-width: 40px; text-align: center;">0/0</span>
                        <button id="btn-editor-search-up-req-repeater" style="background: transparent; border: none; color: var(--text); cursor: pointer; padding: 0 4px; display: flex; align-items: center;" title="Previous">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
                        </button>
                        <button id="btn-editor-search-down-req-repeater" style="background: transparent; border: none; color: var(--text); cursor: pointer; padding: 0 4px; display: flex; align-items: center;" title="Next">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                        </button>
                        <button id="btn-editor-search-close-req-repeater" style="background: transparent; border: none; color: var(--text); cursor: pointer; padding: 0 4px; display: flex; align-items: center;" title="Close">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        </button>
                        <button id="btn-footer-search-req-repeater" class="csp-hover-transparent" style="background: transparent; border: none; color: var(--text-dim); cursor: pointer; padding: 3px 8px; font-size: 11px; border-radius: 4px;;" title="Find">Find</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="content-rep-res" class="tab-content content-res-split" style="padding: 0;">
        <div style="display: flex; flex-direction: column; height: 100%;">
            <div class="pane-header">Response</div>
            
            <!-- Raw/Pretty View -->
            <div class="inner-content-wrapper inner-content-res-raw active" style="flex-grow: 1; min-height: 0; display: flex; flex-direction: column;">
                <div class="tabs inner-tabs" style="flex-shrink: 0; border-bottom: 1px solid var(--border); background: var(--bg-ter); display: flex; align-items: center; padding: 0 8px;">
                    <div class="tab inner-tab active" data-pane="res" data-view="raw">Raw</div>
                    <div class="tab inner-tab" data-pane="res" data-view="pretty">Pretty</div>
                    <div class="tab inner-tab" data-pane="res" data-view="hex">Hex</div>
                    <div class="tab inner-tab" data-pane="res" data-view="render">Render</div>
                    <div class="tab inner-tab" data-pane="res" data-view="ai">AI Analysis</div>
                    <div class="inner-editor-buttons" style="margin-left: auto;"></div>
                </div>
                <div class="editor-wrapper" style="border: none; margin-bottom: 0;">
                    <div id="gutter-rep-res" class="line-numbers">1</div>
                    <div id="repeater-response" class="editor-raw" contenteditable="false" spellcheck="false" style="background: var(--bg-main); color: var(--text);"></div>
                </div>
                <div id="editor-search-bar-res-repeater" style="display: none; align-items: center; gap: 4px; padding: 4px 8px; background: var(--bg-ter); border: 1px solid var(--border); border-top: none; font-size: 11px; flex-shrink: 0; border-radius: 0 0 2px 2px;">
                    <input type="text" id="editor-search-input-res-repeater" placeholder="Find..." class="csp-focus-input" style="flex: 1; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 4px 8px; outline: none; border-radius: 4px;; font-size: 11px;">
                    <label style="display: flex; align-items: center; gap: 3px; cursor: pointer; user-select: none; color: var(--text-dim);"><input type="checkbox" id="editor-search-regex-res-repeater"> .*</label>
                    <label style="display: flex; align-items: center; gap: 3px; cursor: pointer; user-select: none; color: var(--text-dim);"><input type="checkbox" id="editor-search-case-res-repeater"> Aa</label>
                    <span id="editor-search-count-res-repeater" style="color: var(--text-dim); min-width: 40px; text-align: center;">0/0</span>
                    <button id="btn-editor-search-up-res-repeater" style="background: transparent; border: none; color: var(--text); cursor: pointer; padding: 0 4px; display: flex; align-items: center;" title="Previous">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
                    </button>
                    <button id="btn-editor-search-down-res-repeater" style="background: transparent; border: none; color: var(--text); cursor: pointer; padding: 0 4px; display: flex; align-items: center;" title="Next">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                    </button>
                    <button id="btn-editor-search-close-res-repeater" style="background: transparent; border: none; color: var(--text); cursor: pointer; padding: 0 4px; display: flex; align-items: center;" title="Close">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="editor-footer-res-repeater" style="display: flex; align-items: center; justify-content: space-between; padding: 4px 8px; background: var(--bg-ter); border: 1px solid var(--border); border-top: none; font-size: 11px; flex-shrink: 0; border-radius: 0 0 2px 2px;">
                    <span id="timing-info-repeater" style="color: var(--text-dim); font-size: 11px;"></span>
                    <div style="display: flex; align-items: center; margin-left: auto;">
                        <button id="btn-footer-search-res-repeater" class="csp-hover-transparent" style="background: transparent; border: none; color: var(--text-dim); cursor: pointer; padding: 3px 8px; font-size: 11px; border-radius: 4px;;" title="Find">Find</button>
                    </div>
                </div>
            </div>

            <!-- Hex View -->
            <div class="inner-content-wrapper inner-content-res-hex" style="flex-grow: 1; min-height: 0; display: none; flex-direction: column;">
                <div class="tabs inner-tabs" style="flex-shrink: 0; border-bottom: 1px solid var(--border); display: flex; align-items: center; padding: 0 5px;">
                    <div class="tab inner-tab" data-pane="res" data-view="raw">Raw</div>
                    <div class="tab inner-tab" data-pane="res" data-view="pretty">Pretty</div>
                    <div class="tab inner-tab active" data-pane="res" data-view="hex">Hex</div>
                    <div class="tab inner-tab" data-pane="res" data-view="render">Render</div>
                    <div class="tab inner-tab" data-pane="res" data-view="ai">AI Analysis</div>
                </div>
                <div id="repeater-hex-view" style="flex: 1; overflow: auto; padding: 10px; font-family: Consolas, monospace; font-size: 12px; white-space: pre; box-sizing: border-box;"></div>
            </div>

            <!-- Render View -->
            <div class="inner-content-wrapper inner-content-res-render" style="flex-grow: 1; min-height: 0; display: none; flex-direction: column;">
                <div class="tabs inner-tabs" style="flex-shrink: 0; border-bottom: 1px solid var(--border); display: flex; align-items: center; padding: 0 5px;">
                    <div class="tab inner-tab" data-pane="res" data-view="raw">Raw</div>
                    <div class="tab inner-tab" data-pane="res" data-view="pretty">Pretty</div>
                    <div class="tab inner-tab" data-pane="res" data-view="hex">Hex</div>
                    <div class="tab inner-tab active" data-pane="res" data-view="render">Render</div>
                    <div class="tab inner-tab" data-pane="res" data-view="ai">AI Analysis</div>
                </div>
                <iframe id="repeater-render-frame" sandbox="allow-scripts allow-same-origin" style="width:100%; height:100%; border:none; background: white;"></iframe>
            </div>

            <!-- AI View -->
            <div class="inner-content-wrapper inner-content-res-ai" style="flex-grow: 1; min-height: 0; display: none; flex-direction: column;">
                 <div class="tabs inner-tabs" style="flex-shrink: 0; border-bottom: 1px solid var(--border); display: flex; align-items: center; padding: 0 5px;">
                    <div class="tab inner-tab" data-pane="res" data-view="raw">Raw</div>
                    <div class="tab inner-tab" data-pane="res" data-view="pretty">Pretty</div>
                    <div class="tab inner-tab" data-pane="res" data-view="hex">Hex</div>
                    <div class="tab inner-tab" data-pane="res" data-view="render">Render</div>
                    <div class="tab inner-tab active" data-pane="res" data-view="ai">AI Analysis</div>
                </div>
                 <div style="display: flex; gap: 4px; padding: 6px 8px; border-bottom: 1px solid var(--border); background: var(--bg-ter); flex-wrap: wrap; align-items: center;">
                    <div style="display: flex; gap: 4px; flex: 1; flex-wrap: wrap;">
                        <button id="btn-analyze-rep-ai" class="csp-hover-button" style="padding: 6px 10px; font-size: 11px; background: var(--accent); border: none; color: white; border-radius: 4px;; cursor: pointer; font-weight: 500;">Full analysis</button>
                        <button id="btn-explain-request" class="csp-hover-button" style="padding: 6px 10px; font-size: 11px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; cursor: pointer;">Explain request</button>
                        <button id="btn-explain-response" class="csp-hover-button" style="padding: 6px 10px; font-size: 11px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; cursor: pointer;">Explain response</button>
                        <button id="btn-suggest-attacks" class="csp-hover-button" style="padding: 6px 10px; font-size: 11px; background: var(--bg-input); border: 1px solid var(--accent); color: var(--accent); border-radius: 4px;; cursor: pointer;">Attack ideas</button>
                        <button id="btn-suggest-next-test" class="csp-hover-button" style="padding: 6px 10px; font-size: 11px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; cursor: pointer;">Next test</button>
                    </div>
                    <div style="display: flex; gap: 4px; border-left: 1px solid var(--border); padding-left: 8px;">
                        <button id="btn-export-rep-ai-md" class="csp-hover-button" style="padding: 6px 10px; font-size: 11px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; cursor: pointer;">Export MD</button>
                        <button id="btn-export-rep-ai-html" class="csp-hover-button" style="padding: 6px 10px; font-size: 11px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; cursor: pointer;">Export HTML</button>
                    </div>
                </div>
                <div class="editor-wrapper" style="flex-grow: 1; min-height: 0; display: block; overflow-y: auto; border-top: none; border-top-left-radius: 0; border-top-right-radius: 0;">
                    <div id="rep-ai-content" class="ai-analysis-content" style="padding: 15px;">
                        <div class="empty-state" style="position:relative; top:auto; left:auto; transform:none; padding: 20px;">Clique em "Analyze Request" para iniciar a anÃ¡lise com Gemini AI</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="content-rep-diff" class="tab-content" style="padding: 0;">
        <div id="repeater-diff"
            style="flex: 1; background: var(--bg-main); color: var(--text); font-family: 'Consolas', monospace; padding: 10px; overflow-y: auto; overflow-x: hidden; font-size: 12px; white-space: pre-wrap; word-break: break-all; line-height: 1.5;">
                </div>
            </div>
        </div>
    </div>

    <!-- Aba Notes -->
    <div id="view-notes" class="view-container" style="flex-direction: column;">
        <!-- Barra de Abas de Notas -->
        <div id="notes-tabs-bar"
            style="display: flex; background: var(--bg-sec); border-bottom: 1px solid var(--border); overflow-x: auto; height: 28px; align-items: center; flex-shrink: 0;">
            <button id="btn-add-note-tab"
                style="background: transparent; border: none; color: var(--text); cursor: pointer; padding: 0 10px; font-weight: bold; font-size: 16px; height: 100%;">+</button>
            <!-- Note tabs will be injected here -->
        </div>
        <div id="notes-content-area" style="flex: 1; display: flex; flex-direction: column; position: relative; min-height: 0;">
             <!-- Sub-tabs for Write/Preview -->
             <div class="tabs" style="margin-bottom: 0; border-bottom: 1px solid var(--border); flex-shrink: 0;">
                <div class="tab active" id="note-tab-write">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                    Write
                </div>
                <div class="tab" id="note-tab-preview">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                    Preview
                </div>
             </div>
             <textarea id="notes-content"
                style="flex: 1; background: var(--bg-main); border: none; color: var(--text); padding: 10px; resize: none; outline: none; font-family: 'Segoe UI', sans-serif; font-size: 13px; margin: 0; border-radius: 0; display: block; box-sizing: border-box;"
                placeholder="Write your notes here..."></textarea>
             <div id="notes-preview" class="ai-analysis-content" style="flex: 1; padding: 15px; overflow-y: auto; display: none; box-sizing: border-box; min-height: 0;">
                <!-- Rendered markdown will go here -->
             </div>
        </div>
        <div style="display: flex; justify-content: flex-end; gap: 10px; padding: 5px; background: var(--bg-sec); border-top: 1px solid var(--border);">
            <button id="btn-clear-note" style="width: auto; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; font-size: 11px;">Clear</button>
            <button id="btn-save-notes" style="width: auto; background: var(--accent); border: none; padding: 6px 12px; font-size: 11px;" data-i18n="btn_save">Save</button>
        </div>
    </div>

    <!-- Aba Settings (Burp Suite Pro style) -->
    <div id="view-settings" class="view-container" style="flex-direction: column; padding: 12px; box-sizing: border-box; overflow-y: auto;">
        <h3 style="margin-top: 0; border-bottom: 1px solid var(--border); padding-bottom: 8px; font-size: 13px; font-weight: 600;" data-i18n="settings_language">Language</h3>
        <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); margin-bottom: 12px;">
            <select id="language-selector" class="csp-focus-input" style="width: 100%; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px; box-sizing: border-box;">
                <option value="en">English</option>
                <option value="pt">PortuguÃªs</option>
            </select>
        </div>

        <h3 style="margin-top: 16px; border-bottom: 1px solid var(--border); padding-bottom: 8px; font-size: 13px; font-weight: 600;" data-i18n="settings_project">Project</h3>
        <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); margin-bottom: 12px;">
            <label style="display: block; margin-bottom: 6px; font-size: 12px; color: var(--text);" data-i18n="settings_gemini_key">Gemini API Key (AI Assistant)</label>
            <input type="password" id="gemini-api-key" placeholder="Paste your Google Gemini API Key here" class="csp-focus-input" style="width: 100%; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 4px;; font-size: 12px; box-sizing: border-box; margin-bottom: 8px;">
            <div style="margin-top: 10px; padding: 10px; background: var(--bg-main); border: 1px solid var(--border); border-radius: 4px;;">
                <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 12px; color: var(--text);">
                    <input type="checkbox" id="repeater-auto-analyze" style="cursor: pointer;">
                    <span>Auto-analyze vulnerabilities in Repeater</span>
                </label>
                <p style="margin: 6px 0 0 0; font-size: 11px; color: var(--text-dim);">Automatically perform vulnerability analysis when a response is received in the Repeater tab.</p>
            </div>
            <button id="btn-save-ai-key" class="csp-hover-button" style="width: auto; background: var(--accent); border: none; color: white; padding: 6px 12px; border-radius: 4px;; font-size: 12px; cursor: pointer; margin-top: 8px;" data-i18n="settings_save_key">Save key</button>
            <div class="switch-container" style="justify-content: space-between; width: 100%; margin-top: 12px;">
                <label for="chk-passive-ai-scan" style="cursor: pointer; font-size: 12px; color: var(--text);" data-i18n="settings_enable_passive_scan">Enable Continuous Passive AI Scan (Beta)</label>
                <label class="switch">
                    <input type="checkbox" id="chk-passive-ai-scan">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <input type="file" id="file-load-project" accept=".json" style="display: none;">

        <h3 style="margin-top: 16px; border-bottom: 1px solid var(--border); padding-bottom: 8px; font-size: 13px; font-weight: 600;">Auto-Save to File</h3>
        <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px; border: 1px solid var(--border); margin-bottom: 12px;">
            <p style="margin: 0 0 10px 0; color: var(--text-dim); font-size: 11px;">Automatically save project to a local file (like Burp Suite Pro). Changes are saved every 5 seconds.</p>
            <div style="padding: 8px; background: #2a2d3a; border-left: 3px solid #f59e0b; margin-bottom: 10px; font-size: 11px; color: var(--text-dim);">
                <strong style="color: #f59e0b;">Note:</strong> This feature requires Chrome 119+ and may not work in side panels due to browser restrictions. If the directory picker doesn't appear, check the console (F12) for errors or use manual Export/Import instead.
            </div>
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <button id="btn-setup-autosave-dir" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;">
                    <svg style="width: 14px; height: 14px; vertical-align: middle; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" /></svg>
                    Select Project Directory
                </button>
                <button id="btn-load-autosave-file" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;" disabled>
                    <svg style="width: 14px; height: 14px; vertical-align: middle; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" /></svg>
                    Load from Auto-Save File
                </button>
                <button id="btn-disable-autosave" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;" disabled>
                    <svg style="width: 14px; height: 14px; vertical-align: middle; margin-right: 4px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    Disable Auto-Save to File
                </button>
                <div id="autosave-status" style="padding: 8px; background: var(--bg-main); border: 1px solid var(--border); border-radius: 4px; font-size: 11px; color: var(--text-dim); display: none;">
                    <strong>Status:</strong> <span id="autosave-status-text">Not configured</span><br>
                    <strong>File:</strong> <span id="autosave-filename">-</span>
                </div>
            </div>
        </div>

        <h3 style="margin-top: 16px; border-bottom: 1px solid var(--border); padding-bottom: 8px; font-size: 13px; font-weight: 600;" data-i18n="settings_appearance">Appearance</h3>
        <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); margin-bottom: 12px;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 10px;">
                <label style="cursor: pointer; font-size: 12px; color: var(--text);">Main background <input type="color" id="cp-bg-main" style="width: 100%; height: 28px; border: 1px solid var(--border); border-radius: 4px;; padding: 0; cursor: pointer;"></label>
                <label style="cursor: pointer; font-size: 12px; color: var(--text);">Secondary background <input type="color" id="cp-bg-sec" style="width: 100%; height: 28px; border: 1px solid var(--border); border-radius: 4px;; padding: 0; cursor: pointer;"></label>
                <label style="cursor: pointer; font-size: 12px; color: var(--text);">Accent color <input type="color" id="cp-accent" style="width: 100%; height: 28px; border: 1px solid var(--border); border-radius: 4px;; padding: 0; cursor: pointer;"></label>
                <label style="cursor: pointer; font-size: 12px; color: var(--text);">Text color <input type="color" id="cp-text" style="width: 100%; height: 28px; border: 1px solid var(--border); border-radius: 4px;; padding: 0; cursor: pointer;"></label>
            </div>
            <div style="display: flex; gap: 8px;">
                <button id="btn-reset-theme" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; font-size: 12px; cursor: pointer;">Restore theme defaults</button>
                <button id="btn-reset-columns" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; font-size: 12px; cursor: pointer;">Reset column layout</button>
            </div>
        </div>

        <h3 style="margin-top: 16px; border-bottom: 1px solid var(--border); padding-bottom: 8px; font-size: 13px; font-weight: 600;" data-i18n="settings_font_options">Font options</h3>
        <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); margin-bottom: 12px;">
            <div style="margin-bottom: 10px;">
                <label for="app-font-family" style="display: block; margin-bottom: 4px; font-size: 12px; color: var(--text);" data-i18n="settings_font_family">Font family</label>
                <select id="app-font-family" class="csp-focus-input" style="width: 100%; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; font-size: 12px;">
                    <option value="'Segoe UI', sans-serif">Segoe UI (Default)</option>
                    <option value="'Consolas', monospace">Consolas</option>
                    <option value="'Courier New', monospace">Courier New</option>
                    <option value="'Roboto', sans-serif">Roboto</option>
                    <option value="'Arial', sans-serif">Arial</option>
                    <option value="'Verdana', sans-serif">Verdana</option>
                    <option value="'Times New Roman', serif">Times New Roman</option>
                </select>
            </div>
            <div style="margin-bottom: 10px;">
                <label for="app-font-size" style="display: block; margin-bottom: 4px; font-size: 12px; color: var(--text);" data-i18n="settings_font_size">Base font size (px)</label>
                <input type="number" id="app-font-size" value="13" min="10" max="24" class="csp-focus-input" style="width: 100%; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; font-size: 12px;">
            </div>
            <div style="display: flex; gap: 8px;">
                <button id="btn-apply-font" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 6px 12px; border-radius: 4px;; font-size: 12px; cursor: pointer;">Apply</button>
                <button id="btn-reset-font" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; font-size: 12px;" data-i18n="btn_reset_font">Reset to default</button>
            </div>
        </div>

        <h3 style="margin-top: 16px; border-bottom: 1px solid var(--border); padding-bottom: 8px; font-size: 13px; font-weight: 600;">History table columns</h3>
        <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border); margin-bottom: 12px;">
            <p style="margin: 0 0 10px 0; color: var(--text-dim); font-size: 11px;">Select which columns to keep visible in the History table (unchecked columns will be hidden):</p>
            <div id="column-visibility-controls" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 6px; max-height: 260px; overflow-y: auto; padding: 8px; background: var(--bg-main); border: 1px solid var(--border); border-radius: 4px;;">
                <!-- Checkboxes will be injected here by JavaScript -->
            </div>
            <div style="display: flex; gap: 8px; margin-top: 10px;">
                <button id="btn-show-all-columns" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; font-size: 12px; cursor: pointer;">Show all columns</button>
                <button id="btn-hide-all-columns" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; font-size: 12px; cursor: pointer;">Hide all columns</button>
                <button id="btn-reset-column-visibility" class="csp-hover-button" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px; border-radius: 4px;; font-size: 12px; cursor: pointer;">Reset to default</button>
            </div>
        </div>

        <h3 style="margin-top: 16px; border-bottom: 1px solid var(--border); padding-bottom: 8px; font-size: 13px; font-weight: 600;">Network options</h3>
        <div style="background: var(--bg-ter); padding: 12px; border-radius: 4px;; border: 1px solid var(--border);">
            <div class="switch-container" style="margin-bottom: 8px;">
                <label for="chk-global-ua" style="cursor: pointer; font-size: 12px; color: var(--text);">Override User-Agent (Repeater/Intruder)</label>
                <label class="switch">
                    <input type="checkbox" id="chk-global-ua">
                    <span class="slider"></span>
                </label>
            </div>
            <input type="text" id="global-ua-string" placeholder="Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)..." class="csp-focus-input" style="width: 100%; padding: 6px 10px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; font-size: 12px; box-sizing: border-box;" disabled>
        </div>
    </div>

    <!-- Aba Flow (Burp Suite Pro style) -->
    <div id="view-flow" class="view-container" style="flex-direction: column; padding: 0; box-sizing: border-box; overflow: hidden;">
        <div style="padding: 8px 12px; border-bottom: 1px solid var(--border); background: var(--bg-ter); display: flex; justify-content: space-between; align-items: center; gap: 8px; flex-shrink: 0;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <h3 style="margin: 0; color: var(--text); font-size: 13px; font-weight: 600;" data-i18n="flow_title">Request flow</h3>
                <div id="flow-loading" style="display: none; align-items: center; gap: 6px; padding: 4px 10px; background: var(--bg-main); border-radius: 4px;; border: 1px solid var(--border);">
                    <div style="width: 14px; height: 14px; border: 2px solid var(--accent); border-top-color: transparent; border-radius: 50%; animation: spin 0.8s linear infinite;"></div>
                    <span style="font-size: 11px; color: var(--accent); font-weight: 500;">Analyzing...</span>
                </div>
            </div>
            <div style="display: flex; gap: 6px;">
                <button id="btn-flow-analyze" class="csp-hover-button" style="padding: 6px 12px; background: var(--accent); border: none; color: white; cursor: pointer; font-weight: 600; border-radius: 4px;; font-size: 12px; min-width: 90px; justify-content: center; box-shadow: none;" data-i18n="flow_analyze">Analyze</button>
                <button id="btn-flow-clear" class="csp-hover-button" style="padding: 6px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; font-weight: 500; border-radius: 4px;; font-size: 12px; min-width: 90px; justify-content: center;" data-i18n="flow_clear">Clear</button>
                <button id="btn-flow-export" class="csp-hover-button" style="padding: 6px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; font-weight: 500; border-radius: 4px;; font-size: 12px; min-width: 90px; justify-content: center;" data-i18n="flow_export">Export SVG</button>
            </div>
        </div>

        <div style="padding: 8px 10px; border-bottom: 1px solid var(--border); background: var(--bg-ter); flex-shrink: 0;">
            <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap; margin-bottom: 8px;">
                <label style="font-size: 11px; color: var(--text); display: flex; align-items: center; gap: 6px; margin: 0; cursor: pointer;">
                    <span data-i18n="flow_filter_domain">Domain:</span>
                    <select id="flow-domain-filter" class="csp-focus-input" style="padding: 4px 8px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; font-size: 11px; cursor: pointer; min-width: 140px;">
                        <option value="all" data-i18n="flow_all_domains">All domains</option>
                    </select>
                </label>
                <label style="font-size: 11px; color: var(--text); display: flex; align-items: center; gap: 6px; margin: 0; cursor: pointer;">
                    <span data-i18n="flow_filter_time">Time:</span>
                    <select id="flow-time-filter" class="csp-focus-input" style="padding: 4px 8px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; font-size: 11px; cursor: pointer;">
                        <option value="all" data-i18n="flow_all_time">All time</option>
                        <option value="60000">Last 1 min</option>
                        <option value="300000">Last 5 min</option>
                        <option value="900000">Last 15 min</option>
                        <option value="3600000">Last 1 hour</option>
                    </select>
                </label>
                <label style="font-size: 11px; color: var(--text); display: flex; align-items: center; gap: 6px; margin: 0; cursor: pointer;">
                    <span>Status:</span>
                    <select id="flow-status-filter" class="csp-focus-input" style="padding: 4px 8px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px;; font-size: 11px; cursor: pointer;">
                        <option value="all">All status</option>
                        <option value="2xx">2xx</option>
                        <option value="3xx">3xx</option>
                        <option value="4xx">4xx</option>
                        <option value="5xx">5xx</option>
                    </select>
                </label>
            </div>
            <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap; margin-bottom: 6px;">
                <span style="font-size: 11px; color: var(--text); font-weight: 500;">Methods:</span>
                <div id="flow-methods-filter" style="display: flex; gap: 4px;">
                    <button class="flow-method-btn" data-method="GET" style="padding: 4px 8px; background: #3b82f6; border: none; color: white; cursor: pointer; border-radius: 4px;; font-size: 11px; font-weight: 600; opacity: 1;">GET</button>
                    <button class="flow-method-btn" data-method="POST" style="padding: 4px 8px; background: #10b981; border: none; color: white; cursor: pointer; border-radius: 4px;; font-size: 11px; font-weight: 600; opacity: 1;">POST</button>
                    <button class="flow-method-btn" data-method="PUT" style="padding: 4px 8px; background: #f59e0b; border: none; color: white; cursor: pointer; border-radius: 4px;; font-size: 11px; font-weight: 600; opacity: 1;">PUT</button>
                    <button class="flow-method-btn" data-method="DELETE" style="padding: 4px 8px; background: #ef4444; border: none; color: white; cursor: pointer; border-radius: 4px;; font-size: 11px; font-weight: 600; opacity: 1;">DELETE</button>
                    <button class="flow-method-btn" data-method="PATCH" style="padding: 4px 8px; background: #8b5cf6; border: none; color: white; cursor: pointer; border-radius: 4px;; font-size: 11px; font-weight: 600; opacity: 1;">PATCH</button>
                </div>
            </div>
            <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap; padding-top: 6px; border-top: 1px solid var(--border);">
                <label id="label-flow-show-auth" class="csp-hover-label" style="font-size: 11px; color: var(--text); display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 2px 6px; border-radius: 4px;;">
                    <input type="checkbox" id="flow-show-auth" checked style="cursor: pointer;">
                    <span style="color: #10b981; font-weight: 500;" data-i18n="flow_highlight_auth">Highlight auth flows</span>
                </label>
                <label id="label-flow-show-tokens" class="csp-hover-label" style="font-size: 11px; color: var(--text); display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 2px 6px; border-radius: 4px;;">
                    <input type="checkbox" id="flow-show-tokens" checked style="cursor: pointer;">
                    <span style="color: #f59e0b; font-weight: 500;" data-i18n="flow_show_tokens">Show token chains</span>
                </label>
                <label id="label-flow-show-data" class="csp-hover-label" style="font-size: 11px; color: var(--text); display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 2px 6px; border-radius: 4px;;">
                    <input type="checkbox" id="flow-show-data" checked style="cursor: pointer;">
                    <span style="color: #3b82f6; font-weight: 500;">Show data flow</span>
                </label>
                <label id="label-flow-show-temporal" class="csp-hover-label" style="font-size: 11px; color: var(--text); display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 2px 6px; border-radius: 4px;;">
                    <input type="checkbox" id="flow-show-temporal" checked style="cursor: pointer;">
                    <span style="color: var(--text-dim); font-weight: 500;">Show temporal links</span>
                </label>
            </div>
        </div>

        <div id="flow-splash-screen" style="display: flex; flex: 1; align-items: center; justify-content: center; padding: 24px; text-align: center; background: var(--bg-main); animation: fadeIn 0.3s ease-out;">
            <div style="max-width: 520px;">
                <h2 style="color: var(--text); margin: 0 0 8px 0; font-size: 18px; font-weight: 600;" data-i18n="flow_welcome_title">Request flow</h2>
                <p style="color: var(--text-dim); margin: 0 0 20px 0; font-size: 13px; line-height: 1.5;" data-i18n="flow_welcome_desc">
                    Visualize request relationships, auth sequences, and data flow. Click Analyze to detect connections between captured requests.
                </p>
                <div style="background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; padding: 16px; text-align: left; margin-bottom: 20px;">
                    <h3 style="color: var(--text); margin: 0 0 10px 0; font-size: 13px; font-weight: 600;" data-i18n="flow_welcome_features">Features</h3>
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <div style="width: 20px; height: 20px; border-radius: 4px;; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; flex-shrink: 0;">1</div>
                            <div>
                                <div style="color: var(--text); font-weight: 500; margin-bottom: 2px; font-size: 12px;" data-i18n="flow_feature_1">Authentication detection</div>
                                <div style="color: var(--text-dim); font-size: 11px; line-height: 1.5;" data-i18n="flow_feature_1_desc">Login flows, token exchanges, session management</div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <div style="width: 20px; height: 20px; border-radius: 4px;; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; flex-shrink: 0;">2</div>
                            <div>
                                <div style="color: var(--text); font-weight: 500; margin-bottom: 2px; font-size: 12px;" data-i18n="flow_feature_2">Data correlation</div>
                                <div style="color: var(--text-dim); font-size: 11px; line-height: 1.5;" data-i18n="flow_feature_2_desc">How data from one response is used in later requests</div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <div style="width: 20px; height: 20px; border-radius: 4px;; background: var(--accent); color: white; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; flex-shrink: 0;">3</div>
                            <div>
                                <div style="color: var(--text); font-weight: 500; margin-bottom: 2px; font-size: 12px;" data-i18n="flow_feature_3">Visual graph</div>
                                <div style="color: var(--text-dim); font-size: 11px; line-height: 1.5;" data-i18n="flow_feature_3_desc">Interactive diagram of request relationships</div>
                            </div>
                        </div>
                    </div>
                </div>
                <button id="btn-flow-start-analyzing" class="csp-hover-button" style="background: var(--accent); border: none; color: white; padding: 8px 20px; cursor: pointer; font-weight: 600; border-radius: 4px;; font-size: 12px; box-shadow: none;" data-i18n="flow_start_analysis">Start analysis</button>
            </div>
        </div>

        <div id="flow-canvas-container" style="display: none; flex: 1; position: relative; overflow: hidden; background: var(--bg-main);">
            <!-- Zoom Controls -->
            <div id="flow-zoom-controls" style="position: absolute; top: 12px; left: 12px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; padding: 6px; display: flex; flex-direction: column; gap: 4px; z-index: 100;">
                <button id="btn-flow-zoom-in" class="csp-hover-button" title="Zoom In" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; width: 32px; height: 28px; border-radius: 4px;; display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: bold;">+</button>
                <button id="btn-flow-zoom-reset" class="csp-hover-button" title="Reset Zoom" style="background: var(--accent); border: 1px solid var(--accent); color: white; cursor: pointer; width: 32px; height: 28px; border-radius: 4px;; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600;">100%</button>
                <button id="btn-flow-zoom-out" class="csp-hover-button" title="Zoom Out" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; width: 32px; height: 28px; border-radius: 4px;; display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: bold;">âˆ’</button>
                <div style="width: 100%; height: 1px; background: var(--border); margin: 2px 0;"></div>
                <button id="btn-flow-fit" class="csp-hover-button" title="Fit to Screen" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); cursor: pointer; width: 32px; height: 28px; border-radius: 4px;; display: flex; align-items: center; justify-content: center; font-size: 10px;">Fit</button>
            </div>
            
            <!-- Legend -->
            <div id="flow-legend" style="position: absolute; top: 12px; right: 12px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; padding: 8px 10px; z-index: 100; min-width: 160px; display: none; font-size: 11px;">
                <div style="font-weight: 600; margin-bottom: 8px; color: var(--text); font-size: 12px;">Legend</div>
                <div style="display: flex; flex-direction: column; gap: 6px;">
                    <div style="display: flex; align-items: center; gap: 6px;"><div style="width: 14px; height: 2px; background: #10b981; border-radius: 4px;;"></div><span style="color: var(--text);">Auth flow</span></div>
                    <div style="display: flex; align-items: center; gap: 6px;"><div style="width: 14px; height: 2px; background: #f59e0b; border-radius: 4px;;"></div><span style="color: var(--text);">Token chain</span></div>
                    <div style="display: flex; align-items: center; gap: 6px;"><div style="width: 14px; height: 2px; background: #3b82f6; border-radius: 4px;;"></div><span style="color: var(--text);">Data flow</span></div>
                    <div style="display: flex; align-items: center; gap: 6px;"><div style="width: 14px; height: 2px; background: var(--accent); border-radius: 4px;;"></div><span style="color: var(--text);">Standard link</span></div>
                </div>
            </div>
            <!-- Minimap -->
            <div id="flow-minimap" style="position: absolute; bottom: 12px; right: 12px; width: 160px; height: 100px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; overflow: hidden; z-index: 100; display: none;">
                <div style="padding: 4px 8px; background: var(--bg-ter); border-bottom: 1px solid var(--border); font-size: 11px; font-weight: 600; color: var(--text); display: flex; align-items: center; justify-content: space-between;">
                    <span>Minimap</span>
                    <button id="btn-toggle-minimap" style="background: transparent; border: none; color: var(--text-dim); cursor: pointer; font-size: 12px; padding: 2px 6px; border-radius: 4px;;" title="Toggle Minimap">âœ•</button>
                </div>
                <canvas id="flow-minimap-canvas" width="180" height="100" style="width: 100%; height: calc(100% - 24px); cursor: pointer; display: block;"></canvas>
            </div>
            <div id="flow-canvas-wrapper" style="width: 100%; height: 100%; overflow: auto; cursor: grab;">
                <svg id="flow-canvas" width="2000" height="2000" style="display: block;">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="var(--accent)" />
                        </marker>
                        <marker id="arrowhead-auth" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#10b981" />
                        </marker>
                        <marker id="arrowhead-token" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#f59e0b" />
                        </marker>
                        <marker id="arrowhead-data" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#3b82f6" />
                        </marker>
                    </defs>
                    <g id="flow-transform-group">
                        <g id="flow-edges"></g>
                        <g id="flow-nodes"></g>
                    </g>
                </svg>
            </div>
            <div id="flow-node-details" style="display: none; position: absolute; top: 12px; right: 12px; width: 320px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; padding: 0; z-index: 100; max-height: calc(100% - 100px); overflow: hidden; flex-direction: column;">
                <div style="padding: 8px 10px; background: var(--bg-ter); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; flex-shrink: 0;">
                    <h4 style="margin: 0; color: var(--text); font-size: 12px; font-weight: 600;" id="flow-detail-title">Request details</h4>
                    <button id="btn-close-flow-details" style="background: transparent; border: none; color: var(--text-dim); cursor: pointer; font-size: 18px; line-height: 1; padding: 2px 6px; border-radius: 4px;;" title="Close">&times;</button>
                </div>
                <div id="flow-detail-content" style="font-size: 11px; color: var(--text); padding: 10px; overflow-y: auto; flex: 1; min-height: 0;"></div>
            </div>
            
            <div id="flow-stats" style="position: absolute; bottom: 12px; left: 12px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 4px;; padding: 10px; font-size: 11px; color: var(--text); z-index: 100; min-width: 180px;">
                <div style="font-weight: 600; margin-bottom: 8px; color: var(--text); font-size: 12px; padding-bottom: 6px; border-bottom: 1px solid var(--border);">Statistics</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <div style="width: 8px; height: 8px; border-radius: 50%; background: var(--accent);"></div>
                        <span><strong data-i18n="flow_stats_nodes">Nodes:</strong> <span id="flow-stat-nodes" style="color: var(--accent); font-weight: 600;">0</span></span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <div style="width: 8px; height: 8px; border-radius: 50%; background: var(--accent);"></div>
                        <span><strong data-i18n="flow_stats_edges">Connections:</strong> <span id="flow-stat-edges" style="color: var(--accent); font-weight: 600;">0</span></span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #10b981;"></div>
                        <span><strong data-i18n="flow_stats_auth">Auth:</strong> <span id="flow-stat-auth" style="color: #10b981; font-weight: 600;">0</span></span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #f59e0b;"></div>
                        <span><strong>Tokens:</strong> <span id="flow-stat-tokens" style="color: #f59e0b; font-weight: 600;">0</span></span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #3b82f6;"></div>
                        <span><strong>Data:</strong> <span id="flow-stat-data" style="color: #3b82f6; font-weight: 600;">0</span></span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <div style="width: 8px; height: 8px; border-radius: 50%; background: var(--text-dim);"></div>
                        <span><strong>Zoom:</strong> <span id="flow-stat-zoom" style="color: var(--text-dim); font-weight: 600;">100%</span></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Aba Sobre -->
    <!-- Aba Extensions -->
    <div id="view-extensions" class="view-container" style="flex-direction: column; padding: 20px; box-sizing: border-box; overflow-y: auto;">
        <h3 style="margin-top: 0; border-bottom: 1px solid var(--border); padding-bottom: 10px;">Extensions & Advanced Features</h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; margin-top: 15px;">
            
            <!-- Mobile Proxy Extension -->
            <div style="background: var(--bg-sec); border: 1px solid var(--border); border-radius: 6px; padding: 20px; display: flex; flex-direction: column; gap: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2">
                        <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
                        <line x1="12" y1="18" x2="12.01" y2="18"></line>
                    </svg>
                    <h4 style="margin: 0; color: var(--text);">Mobile Proxy</h4>
                </div>
                <p style="margin: 0; font-size: 12px; color: var(--text-dim);">Intercept and analyze mobile app traffic (iOS/Android). Requires companion server.</p>
                <div style="margin-top: auto;">
                    <span style="display: inline-block; padding: 3px 8px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 3px; font-size: 11px; color: var(--text-dim);">Coming Soon</span>
                </div>
            </div>

            <!-- GraphQL Inspector -->
            <div style="background: var(--bg-sec); border: 1px solid var(--border); border-radius: 6px; padding: 20px; display: flex; flex-direction: column; gap: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2">
                        <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
                        <polyline points="2 17 12 22 22 17"></polyline>
                        <polyline points="2 12 12 17 22 12"></polyline>
                    </svg>
                    <h4 style="margin: 0; color: var(--text);">GraphQL Inspector</h4>
                </div>
                <p style="margin: 0; font-size: 12px; color: var(--text-dim);">Parse, validate and test GraphQL queries with introspection support.</p>
                <div style="margin-top: auto;">
                    <span style="display: inline-block; padding: 3px 8px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 3px; font-size: 11px; color: var(--text-dim);">Coming Soon</span>
                </div>
            </div>

            <!-- Active Scanner -->
            <div style="background: var(--bg-sec); border: 1px solid var(--border); border-radius: 6px; padding: 20px; display: flex; flex-direction: column; gap: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    <h4 style="margin: 0; color: var(--text);">Active Scanner</h4>
                </div>
                <p style="margin: 0; font-size: 12px; color: var(--text-dim);">Automated vulnerability scanner with crawling capabilities.</p>
                <div style="margin-top: auto;">
                    <span style="display: inline-block; padding: 3px 8px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 3px; font-size: 11px; color: var(--text-dim);">Coming Soon</span>
                </div>
            </div>

            <!-- Request Chaining -->
            <div style="background: var(--bg-sec); border: 1px solid var(--border); border-radius: 6px; padding: 20px; display: flex; flex-direction: column; gap: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2">
                        <line x1="8" y1="6" x2="21" y2="6"></line>
                        <line x1="8" y1="12" x2="21" y2="12"></line>
                        <line x1="8" y1="18" x2="21" y2="18"></line>
                        <line x1="3" y1="6" x2="3.01" y2="6"></line>
                        <line x1="3" y1="12" x2="3.01" y2="12"></line>
                        <line x1="3" y1="18" x2="3.01" y2="18"></line>
                    </svg>
                    <h4 style="margin: 0; color: var(--text);">Request Chaining</h4>
                </div>
                <p style="margin: 0; font-size: 12px; color: var(--text-dim);">Chain multiple requests with variable extraction and injection.</p>
                <div style="margin-top: auto;">
                    <span style="display: inline-block; padding: 3px 8px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 3px; font-size: 11px; color: var(--text-dim);">Coming Soon</span>
                </div>
            </div>

            <!-- JWT Attacker -->
            <div style="background: var(--bg-sec); border: 1px solid var(--border); border-radius: 6px; padding: 20px; display: flex; flex-direction: column; gap: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="12"></line>
                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                    </svg>
                    <h4 style="margin: 0; color: var(--text);">JWT Attacker</h4>
                </div>
                <p style="margin: 0; font-size: 12px; color: var(--text-dim);">Advanced JWT attacks: none algorithm, weak keys, claims manipulation.</p>
                <div style="margin-top: auto;">
                    <span style="display: inline-block; padding: 3px 8px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 3px; font-size: 11px; color: var(--text-dim);">Coming Soon</span>
                </div>
            </div>

            <!-- Visual Request Flow -->
            <div style="background: var(--bg-sec); border: 1px solid var(--border); border-radius: 6px; padding: 20px; display: flex; flex-direction: column; gap: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2">
                        <circle cx="18" cy="5" r="3"></circle>
                        <circle cx="6" cy="12" r="3"></circle>
                        <circle cx="18" cy="19" r="3"></circle>
                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                    </svg>
                    <h4 style="margin: 0; color: var(--text);">Request Flow Diagram</h4>
                </div>
                <p style="margin: 0; font-size: 12px; color: var(--text-dim);">Visual diagram of request flows and authentication sequences.</p>
                <div style="margin-top: auto;">
                    <span style="display: inline-block; padding: 3px 8px; background: var(--bg-ter); border: 1px solid var(--border); border-radius: 3px; font-size: 11px; color: var(--text-dim);">Coming Soon</span>
                </div>
            </div>

        </div>

        <div style="margin-top: 30px; padding: 20px; background: var(--bg-sec); border: 1px solid var(--border); border-radius: 6px;">
            <h4 style="margin-top: 0; color: var(--accent);">ðŸ“¦ Extension Development</h4>
            <p style="margin: 5px 0; font-size: 13px; color: var(--text);">New extensions are being developed to expand WebSentinel capabilities. Check back regularly for updates!</p>
            <p style="margin: 10px 0 0 0; font-size: 12px; color: var(--text-dim);">Have an idea for an extension? Contribute on <a href="https://github.com/k19x" target="_blank" style="color: var(--accent);">GitHub</a>!</p>
        </div>
    </div>

    <div id="view-about" class="view-container" style="flex-direction: column; padding: 20px; box-sizing: border-box; overflow-y: auto;">
        <div style="max-width: 700px; margin: 0 auto;">
            <div style="text-align: center; margin-bottom: 40px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 15px;">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
                <h2 style="color: var(--accent); margin: 0; font-size: 32px;">WebSentinel</h2>
                <p style="color: var(--text-dim); margin-top: 8px; font-size: 15px;" data-i18n="about_subtitle">An extensible web security testing toolkit.</p>
            </div>

            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 30px;">
                <div style="background: var(--bg-sec); padding: 20px; border-radius: 8px; border: 1px solid var(--border); text-align: center;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 10px;">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <h4 style="margin: 0 0 8px 0; color: var(--text); font-size: 14px;" data-i18n="about_author">Author</h4>
                    <p style="margin: 0; color: var(--text-dim); font-size: 15px;">Caique Pascoal</p>
                </div>
                
                <div style="background: var(--bg-sec); padding: 20px; border-radius: 8px; border: 1px solid var(--border); text-align: center;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 10px;">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <h4 style="margin: 0 0 8px 0; color: var(--text); font-size: 14px;" data-i18n="about_creation_date">Year</h4>
                    <p style="margin: 0; color: var(--text-dim); font-size: 15px;">2025</p>
                </div>
                
                <div id="about-version-display" style="background: var(--bg-sec); padding: 20px; border-radius: 8px; border: 1px solid var(--border); text-align: center; cursor: pointer; transition: all 0.2s;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 10px;">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    <h4 style="margin: 0 0 8px 0; color: var(--text); font-size: 14px;" data-i18n="about_version">Version</h4>
                    <p style="margin: 0; color: var(--text-dim); font-size: 15px;">1.0</p>
                </div>
                
                <a href="https://github.com/k19x" target="_blank" style="background: var(--bg-sec); padding: 20px; border-radius: 8px; border: 1px solid var(--border); text-align: center; text-decoration: none; transition: all 0.2s; display: block;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 10px;">
                        <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                    </svg>
                    <h4 style="margin: 0 0 8px 0; color: var(--text); font-size: 14px;" data-i18n="about_github">GitHub</h4>
                    <p style="margin: 0; color: var(--accent); font-size: 14px; font-weight: 500;">@k19x</p>
                </a>
            </div>

            <div style="background: var(--bg-sec); padding: 25px; border-radius: 8px; border: 1px solid var(--border); margin-bottom: 20px;">
                <h3 style="margin: 0 0 15px 0; color: var(--text); font-size: 18px; display: flex; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    <span data-i18n="about_description_title">About the Project</span>
                </h3>
                <p style="color: var(--text-dim); line-height: 1.7; margin: 0; text-align: justify;" data-i18n="about_description_text">
                    WebSentinel was created as a personal project to study and apply concepts of web security and software development. It is inspired by professional tools like Burp Suite, aiming to provide a simplified and extensible environment for security testing directly in the browser. The integration with Gemini AI for analysis demonstrates the potential of combining traditional techniques with artificial intelligence.
                </p>
            </div>

            <div style="background: var(--bg-sec); padding: 25px; border-radius: 8px; border: 1px solid var(--border);">
                <h3 style="margin: 0 0 15px 0; color: var(--text); font-size: 18px; display: flex; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    <span data-i18n="about_thanks_title">Special Thanks</span>
                </h3>
                <p style="color: var(--text-dim); line-height: 1.7; margin: 0;" data-i18n="about_thanks_text">
                    Special thanks to the open-source community and all the security researchers who share their knowledge, making projects like this possible.
                </p>
            </div>
        </div>
    </div>

    <!-- Bottom Bar -->
    <div class="bottom-bar">
        <div id="memory-usage">
            <span>JS Heap:</span>
            <span id="memory-value">-- MB</span>
        </div>
    </div>

    <!-- Startup Modal -->
    <div id="startup-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 3000; align-items: center; justify-content: center;">
        <div style="background: var(--bg-sec); padding: 25px; border: 1px solid var(--border); border-radius: 5px; width: 400px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); display: flex; flex-direction: column; gap: 15px;">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
                <h2 style="margin: 0; color: var(--text);">Welcome to WebSentinel</h2>
            </div>
            
            <div id="startup-new-project-form" style="display: none; flex-direction: column; gap: 10px;">
                 <label for="new-project-name">Project Name:</label>
                 <input type="text" id="new-project-name" placeholder="e.g., My Awesome Project" style="padding: 8px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text);">
                 <div style="display: flex; gap: 10px;">
                    <button id="btn-start-new-project" style="flex: 1; background: var(--accent); color: white;">Start Project</button>
                    <button id="btn-cancel-new-project" style="flex: 0; background: var(--bg-input); border: 1px solid var(--border); color: var(--text);">Cancel</button>
                 </div>
            </div>
    
            <div id="startup-options">
                <button id="btn-show-new-project" style="width: 100%; background: var(--accent); color: white; text-align: left; padding: 12px; margin-bottom: 10px;"><strong>New Project</strong><br><span style="font-size: 11px; opacity: 0.8;">Start a new session with auto-save.</span></button>
                <button id="btn-startup-load-project" style="width: 100%; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); text-align: left; padding: 12px;"><strong>Load Project</strong><br><span style="font-size: 11px; opacity: 0.8;">Load a previously saved project file.</span></button>
                <button id="btn-continue-temp" style="width: 100%; background: transparent; border: none; color: var(--text-dim); padding: 12px; text-align: center; font-size: 12px; margin-top: 10px;">Continue without saving (temporary session)</button>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="context-menu">
        
        <!-- Request Context -->
        <div id="ctx-send-repeater" data-context="request editor sitemap" class="ctx-item" data-action="send-repeater">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>
            Send to Repeater
        </div>
        <div id="ctx-send-intruder" data-context="request editor sitemap" class="ctx-item" data-action="send-intruder">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="22" y1="12" x2="18" y2="12"></line><line x1="6" y1="12" x2="2" y2="12"></line><line x1="12" y1="6" x2="12" y2="2"></line><line x1="12" y1="22" x2="12" y2="18"></line></svg>
            Send to Intruder
        </div>
        
        <!-- Sitemap Context -->
        <div id="ctx-expand-domain" data-context="sitemap" class="ctx-item" data-action="expand-domain">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"></polyline></svg>
            Expand All
        </div>
        
        <div class="ctx-separator" data-context="sitemap"></div>
        
        <!-- Request & Sitemap Context -->
        <div id="ctx-add-to-scope" data-context="request sitemap" class="ctx-item" data-action="add-to-scope">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg>
            Add to Scope
        </div>
        
        <!-- Request Context -->
        <div id="ctx-active-scan" data-context="request" class="ctx-item" data-action="active-scan">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
            Active Scan (Quick)
        </div>
        <div id="ctx-analyze-ai" data-context="request" class="ctx-item" style="font-weight: bold; color: #ff6633;" data-action="analyze-ai">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path></svg>
            Analyze with Gemini AI
        </div>
        <div id="ctx-generate-csrf" data-context="request" class="ctx-item" data-action="generate-csrf">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
            Generate CSRF PoC
        </div>
        
        <div class="ctx-separator" data-context="request"></div>

        <!-- Copy As... Submenu -->
        <div class="ctx-item ctx-item-with-submenu" data-context="request editor">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            <span>Copy as...</span>
            <span class="submenu-arrow">â–¶</span>
            <div class="ctx-submenu">
                <div class="ctx-item" data-action="copy-curl">cURL</div>
                <div class="ctx-item" data-action="copy-python">Python</div>
                <div class="ctx-item" data-action="copy-fetch">Fetch</div>
                <div class="ctx-item" data-action="copy-powershell">PowerShell</div>
                <div class="ctx-item" data-action="copy-xhr">JavaScript (XHR)</div>
                <div class="ctx-item" data-action="copy-markdown">Markdown (Request)</div>
                <div class="ctx-item" data-action="copy-markdown-full">Markdown (Request & Response)</div>
            </div>
        </div>
        <div class="ctx-item" data-context="request editor" data-action="copy-url">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
            Copy URL
        </div>

        <div class="ctx-separator" data-context="request selection editor"></div>
    
        <!-- Selection Context -->
        <div id="ctx-send-text-jwt" data-context="selection editor" class="ctx-item" data-action="send-text-jwt">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 9.9-1"></path></svg>
            Send to JWT Decoder
        </div>
        <div id="ctx-send-text-base64" data-context="selection editor" class="ctx-item" data-action="send-text-base64">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>
            Send to Base64 Decoder
        </div>
        <div id="ctx-send-text-url" data-context="selection editor" class="ctx-item" data-action="send-text-url">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 18 15.3 15.3 0 0 1-8 0 15.3 15.3 0 0 1 4-18z"></path></svg>
            Send to URL Decoder
        </div>
    
        <div class="ctx-separator" data-context="editor"></div>
    
        <!-- Editor Context -->
        <div id="ctx-change-method" data-context="editor" class="ctx-item" data-action="change-method">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="1 4 1 10 7 10"></polyline><polyline points="23 20 23 14 17 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path></svg>
            Change Request Method
        </div>
    
        <div class="ctx-separator" data-context="request"></div>
    
        <!-- Request Context -->
        <div id="ctx-send-comparer-left" data-context="request" class="ctx-item" data-action="send-comparer-left">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3v18"></path><rect x="4" y="6" width="16" height="12" rx="2"></rect></svg>
            Send to Comparer (Left)
        </div>
        <div id="ctx-send-comparer-right" data-context="request" class="ctx-item" data-action="send-comparer-right">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3v18"></path><rect x="4" y="6" width="16" height="12" rx="2"></rect></svg>
            Send to Comparer (Right)
        </div>
        <div id="ctx-send-jwt" data-context="request" class="ctx-item" data-action="send-jwt">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 9.9-1"></path></svg>
            Send to JWT Decoder
        </div>
    
        <div class="ctx-separator" data-context="request"></div>
    
        <!-- Request Context (Highlight) -->
        <div class="ctx-item ctx-item-with-submenu" data-context="request">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2.69l5.74 5.88-5.74 5.88-5.74-5.88z"></path><path d="M2 22h20"></path></svg>
            <span>Highlight</span>
            <span class="submenu-arrow">â–¶</span>
            <div class="ctx-submenu">
                <div class="ctx-item" data-action="highlight-red" style="display: flex; align-items: center; gap: 8px;">
                    <div class="ctx-color-box" style="background: #ff5252;"></div> Red
                </div>
                <div class="ctx-item" data-action="highlight-green" style="display: flex; align-items: center; gap: 8px;">
                    <div class="ctx-color-box" style="background: #4caf50;"></div> Green
                </div>
                <div class="ctx-item" data-action="highlight-blue" style="display: flex; align-items: center; gap: 8px;">
                    <div class="ctx-color-box" style="background: #2196f3;"></div> Blue
                </div>
                <div class="ctx-item" data-action="highlight-yellow" style="display: flex; align-items: center; gap: 8px;">
                    <div class="ctx-color-box" style="background: #ffeb3b;"></div> Yellow
                </div>
                <div class="ctx-item" data-action="highlight-purple" style="display: flex; align-items: center; gap: 8px;">
                    <div class="ctx-color-box" style="background: #9c27b0;"></div> Purple
                </div>
                <div class="ctx-item" data-action="highlight-orange" style="display: flex; align-items: center; gap: 8px;">
                    <div class="ctx-color-box" style="background: #ff9800;"></div> Orange
                </div>
                <div class="ctx-separator"></div>
                <div class="ctx-item" data-action="highlight-none">Clear Highlight</div>
            </div>
        </div>

        <div class="ctx-separator" data-context="request"></div>
        <div id="ctx-delete-item" data-context="request" class="ctx-item" data-action="delete-item" style="color: #ff5252;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
            Delete item
        </div>
        <div id="ctx-delete-host-items" data-context="request" class="ctx-item" data-action="delete-host-items" style="color: #ff5252;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
            Delete all items from host
        </div>
        <div class="ctx-separator" data-context="request"></div>
        <div id="ctx-clear-history" data-context="request" class="ctx-item" data-action="clear-history" style="color: #ff5252;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
            Clear history
        </div>
        <div id="ctx-clear-all-data" data-context="request" class="ctx-item" data-action="clear-all-data" style="color: #ff5252;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            Clear all data
        </div>
    </div>

    <!-- Search Bar Overlay -->
    <div id="search-bar">
        <input type="text" id="search-input" placeholder="Find...">
        <label style="display: flex; align-items: center; gap: 4px; font-size: 11px; color: var(--text-dim); cursor: pointer; user-select: none; white-space: nowrap;">
            <input type="checkbox" id="search-case-sensitive">
            Match Case
        </label>
        <span id="search-count"
            style="font-size: 11px; color: var(--text-dim); min-width: 40px; text-align: center;">0/0</span>
        <button id="btn-search-up" class="search-btn" title="Previous" style="display: flex; align-items: center;">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
        </button>
        <button id="btn-search-down" class="search-btn" title="Next" style="display: flex; align-items: center;">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </button>
        <button id="btn-search-close" class="search-btn" title="Close" style="display: flex; align-items: center;">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
    </div>
    
    <!-- Confirmation Modal -->
    <div id="confirm-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 20000; align-items: center; justify-content: center;">
        <div style="background: var(--bg-sec); padding: 24px; border: 1px solid var(--border); border-radius: 4px; width: 400px; max-width: 90vw; box-shadow: 0 4px 12px rgba(0,0,0,0.5); display: flex; flex-direction: column; gap: 16px;">
            <h3 style="margin: 0; color: var(--text); font-size: 16px; font-weight: 600;" id="confirm-modal-title">Confirm</h3>
            <p style="margin: 0; color: var(--text-dim); font-size: 14px; line-height: 1.5;" id="confirm-modal-message"></p>
            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 8px;">
                <button id="confirm-modal-cancel" style="padding: 8px 16px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px; cursor: pointer; font-size: 13px; font-weight: 500;">Cancel</button>
                <button id="confirm-modal-ok" style="padding: 8px 16px; background: var(--accent); border: none; color: white; border-radius: 4px; cursor: pointer; font-size: 13px; font-weight: 500;">OK</button>
            </div>
        </div>
    </div>

    <!-- Prompt Modal -->
    <div id="prompt-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 20000; align-items: center; justify-content: center;">
        <div style="background: var(--bg-sec); padding: 24px; border: 1px solid var(--border); border-radius: 4px; width: 400px; max-width: 90vw; box-shadow: 0 4px 12px rgba(0,0,0,0.5); display: flex; flex-direction: column; gap: 16px;">
            <h3 style="margin: 0; color: var(--text); font-size: 16px; font-weight: 600;" id="prompt-modal-title">Input</h3>
            <p style="margin: 0; color: var(--text-dim); font-size: 14px; line-height: 1.5;" id="prompt-modal-message"></p>
            <input type="text" id="prompt-modal-input" style="padding: 8px 12px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px; font-size: 14px; width: 100%; box-sizing: border-box;">
            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 8px;">
                <button id="prompt-modal-cancel" style="padding: 8px 16px; background: var(--bg-input); border: 1px solid var(--border); color: var(--text); border-radius: 4px; cursor: pointer; font-size: 13px; font-weight: 500;">Cancel</button>
                <button id="prompt-modal-ok" style="padding: 8px 16px; background: var(--accent); border: none; color: white; border-radius: 4px; cursor: pointer; font-size: 13px; font-weight: 500;">OK</button>
            </div>
        </div>
    </div>

    <!-- Export Options Modal -->
    <div id="export-options-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; align-items: center; justify-content: center;">
        <div style="background: var(--bg-sec); padding: 20px; border: 1px solid var(--border); border-radius: 4px; width: 300px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); display: flex; flex-direction: column;">
            <h3 style="margin-top: 0; color: var(--text); border-bottom: 1px solid var(--border); padding-bottom: 10px; margin-bottom: 15px;">Export HAR</h3>
            <p style="color: var(--text-dim); font-size: 13px; margin-bottom: 20px;">Do you want to export the entire history or only items within the scope?</p>
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <button id="btn-export-all" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text);">Entire History</button>
                <button id="btn-export-scope" style="background: var(--accent); border: none; color: white;">Scope Only</button>
                <button id="btn-export-cancel" style="background: transparent; border: 1px solid var(--border); color: var(--text-dim); margin-top: 5px;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Generic Modal (Card Style) -->
    <div id="generic-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 4000; align-items: center; justify-content: center;">
        <div style="background: var(--bg-sec); padding: 0; border: 1px solid var(--border); border-radius: 6px; width: 450px; max-width: 90%; box-shadow: 0 10px 25px rgba(0,0,0,0.5); display: flex; flex-direction: column; overflow: hidden;">
            <div style="padding: 15px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; background: var(--bg-ter);">
                <h3 id="generic-modal-title" style="margin: 0; color: var(--accent); font-size: 14px;">Title</h3>
                <button id="btn-close-generic-modal" style="background: transparent; border: none; color: var(--text-dim); cursor: pointer; font-size: 16px; line-height: 1;">âœ•</button>
            </div>
            <div id="generic-modal-content" style="padding: 20px; color: var(--text); font-family: 'Consolas', monospace; white-space: pre-wrap; word-break: break-all; max-height: 300px; overflow-y: auto; font-size: 12px; background: var(--bg-main);"></div>
            <div style="padding: 10px 15px; display: flex; justify-content: flex-end; gap: 10px; background: var(--bg-sec); border-top: 1px solid var(--border);">
                <button id="btn-copy-generic-modal" style="background: var(--bg-input); border: 1px solid var(--border); color: var(--text); padding: 6px 12px;">Copy</button>
                <button id="btn-ok-generic-modal" style="background: var(--accent); border: none; color: white; padding: 6px 12px;">OK</button>
            </div>
        </div>
    </div>

    <!-- BSOD Easter Egg -->
    <div id="bsod-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0000AA; color: white; z-index: 99999; font-family: 'Courier New', monospace; padding: 50px; box-sizing: border-box; font-size: 16px; cursor: none; overflow: hidden;">
        <p style="margin-top: 0;">A problem has been detected and WebSentinel has been shut down to prevent damage to your computer.</p>
        <p>DRIVER_IRQL_NOT_LESS_OR_EQUAL</p>
        <br>
        <p>If this is the first time you've seen this stop error screen, restart your computer. If this screen appears again, follow these steps:</p>
        <p>Check to make sure any new hardware or software is properly installed. If this is a new installation, ask your hardware or software manufacturer for any Windows updates you might need.</p>
        <p>If problems continue, disable or remove any newly installed hardware or software. Disable BIOS memory options such as caching or shadowing. If you need to use Safe Mode to remove or disable components, restart your computer, press F8 to select Advanced Startup Options, and then select Safe Mode.</p>
        <br>
        <p>Technical information:</p>
        <p>*** STOP: 0x000000D1 (0x0000000C, 0x00000002, 0x00000000, 0xF86B5A89)</p>
        <br>
        <p>***  gv3.sys - Address F86B5A89 base at F86B5000, DateStamp 3dd9919eb</p>
        <br>
        <p>Beginning dump of physical memory</p>
        <p>Physical memory dump complete.</p>
        <p>Contact your system administrator or technical support group for further assistance.</p>
    </div>

    <!-- Snake Game Easter Egg -->
    <div id="snake-game-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); z-index: 5000; align-items: center; justify-content: center; flex-direction: column;">
        <div style="color: var(--accent); font-family: 'Courier New', monospace; font-size: 24px; margin-bottom: 10px; text-shadow: 0 0 5px var(--accent);">SNAKE - Score: <span id="snake-score">0</span></div>
        <canvas id="snake-canvas" width="400" height="400" style="border: 2px solid var(--accent); background: var(--bg-main); box-shadow: 0 0 20px rgba(0,0,0,0.5);"></canvas>
        <div style="color: var(--text-dim); margin-top: 10px; font-family: sans-serif; font-size: 12px;">Use Arrow Keys to Move | Press ESC to Quit</div>
    </div>

    <!-- <script src="highlight.min.js"></script> -->
    
    <!-- Module Imports (Core Dependencies) -->
    <script src="modules/core/constants.obf.js"></script>
    <script src="modules/core/utils.obf.js"></script>
    <script src="modules/core/themes.obf.js"></script>
    
    <!-- Feature Modules -->
    <script src="modules/features/request-parser.obf.js"></script>
    <script src="modules/features/validators.obf.js"></script>
    <script src="modules/features/encoders.obf.js"></script>
    
    <!-- UI Modules -->
    <script src="modules/ui/editor-utils.obf.js"></script>
    <script src="modules/ui/syntax-highlighter.obf.js"></script>
    <script src="modules/ui/response-renderer.obf.js"></script>
    <script src="modules/ui/request-builder.obf.js"></script>
    <script src="modules/ui/websocket-controller.obf.js"></script>
    
    <!-- Service Modules -->
    <script src="modules/services/storage-manager.obf.js"></script>
    <script src="modules/services/sync-manager.obf.js"></script>
    
    <!-- Main Application Script -->
    <script src="sidepanel.obf.js"></script>
    <script src="sidepanel-fixes.js"></script>
</body>
</html>
